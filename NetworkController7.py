import math
import ast
from math import e
from decimal import *
getcontext().prec = 28



#first we have defined funcyions to access signals and vehicles data
def permutation(lst):
    if len(lst) == 0:
        return []
    if len(lst) == 1:
        return [lst]

    l = []

    for i in range(len(lst)):
        m = lst[i]
        remLst = lst[:i] + lst[i + 1:]
        for p in permutation(remLst):
            l.append([m] + p)
    return l
def factorial(f):
    if f == 0:
        return 1
    else:
        return f * factorial(f-1)

def toList(NestedTuple):
    return list(map(toList, NestedTuple)) if isinstance(NestedTuple, (list, tuple)) else NestedTuple


def Init():
    global vehTypesEquipped
    global vehTypesSpecial
    global vehsAttributes
    global vehsAttNames
    
    vehsAttributes = []
    vehsAttNames = []
    vehTypesAttributes = Vissim.Net.VehicleTypes.GetMultipleAttributes(['No', 'IsConnected', 'IsSpecial'])
    vehTypesEquipped = [x[0] for x in vehTypesAttributes if x[1] == True]
    vehTypesSpecial = [x[0] for x in vehTypesAttributes if x[2] == True]


    global SigCritical11    
    Sig11Atributes =  Vissim.Net.SignalControllers.ItemByKey(11).SGs.GetMultipleAttributes(['No', 'CriticalPhase'])
    SigCritical11 = [x[0] for x in Sig11Atributes if x[1] == True]

    global SigCritical10    
    Sig10Atributes =  Vissim.Net.SignalControllers.ItemByKey(10).SGs.GetMultipleAttributes(['No', 'CriticalPhase'])
    SigCritical10 = [x[0] for x in Sig10Atributes if x[1] == True]

    global SigCritical9    
    Sig9Atributes =  Vissim.Net.SignalControllers.ItemByKey(9).SGs.GetMultipleAttributes(['No', 'CriticalPhase'])
    SigCritical9 = [x[0] for x in Sig9Atributes if x[1] == True]

    global SigCritical8    
    Sig8Atributes =  Vissim.Net.SignalControllers.ItemByKey(8).SGs.GetMultipleAttributes(['No', 'CriticalPhase'])
    SigCritical8 = [x[0] for x in Sig8Atributes if x[1] == True]

    global SigCritical7    
    Sig7Atributes =  Vissim.Net.SignalControllers.ItemByKey(7).SGs.GetMultipleAttributes(['No', 'CriticalPhase'])
    SigCritical7 = [x[0] for x in Sig7Atributes if x[1] == True]


    global SigCritical6    
    Sig6Atributes =  Vissim.Net.SignalControllers.ItemByKey(6).SGs.GetMultipleAttributes(['No', 'CriticalPhase'])
    SigCritical6 = [x[0] for x in Sig6Atributes if x[1] == True]

    global SigCritical4    
    Sig4Atributes =  Vissim.Net.SignalControllers.ItemByKey(4).SGs.GetMultipleAttributes(['No', 'CriticalPhase'])
    SigCritical4 = [x[0] for x in Sig4Atributes if x[1] == True]

    global SigCritical3    
    Sig3Atributes =  Vissim.Net.SignalControllers.ItemByKey(3).SGs.GetMultipleAttributes(['No', 'CriticalPhase'])
    SigCritical3 = [x[0] for x in Sig3Atributes if x[1] == True]


    global SigCritical2    
    Sig2Atributes =  Vissim.Net.SignalControllers.ItemByKey(2).SGs.GetMultipleAttributes(['No', 'CriticalPhase'])
    SigCritical2 = [x[0] for x in Sig2Atributes if x[1] == True]


    global SigCritical12    
    Sig12Atributes =  Vissim.Net.SignalControllers.ItemByKey(12).SGs.GetMultipleAttributes(['No', 'CriticalPhase'])
    SigCritical12 = [x[0] for x in Sig12Atributes if x[1] == True]


    global SigCritical13    
    Sig13Atributes =  Vissim.Net.SignalControllers.ItemByKey(13).SGs.GetMultipleAttributes(['No', 'CriticalPhase'])
    SigCritical13 = [x[0] for x in Sig13Atributes if x[1] == True]

    global SigCritical5    
    Sig5Atributes =  Vissim.Net.SignalControllers.ItemByKey(5).SGs.GetMultipleAttributes(['No', 'CriticalPhase'])
    SigCritical5 = [x[0] for x in Sig5Atributes if x[1] == True]

    global SigCritical1    
    Sig1Atributes =  Vissim.Net.SignalControllers.ItemByKey(1).SGs.GetMultipleAttributes(['No', 'CriticalPhase'])
    SigCritical1 = [x[0] for x in Sig1Atributes if x[1] == True]







def GetVissimDataVehicles():
    global vehsAttributes
    global vehsAttNames
    vehsAttributesNames = ['No', 'VehType\No', 'Pos', 'VehType\No', 'Lane\Link', 'Speed', 'DistanceToSigHead','InQueue']
    vehsAttributes = toList(Vissim.Net.Vehicles.GetMultipleAttributes(vehsAttributesNames))
    vehsAttNames = {}
    cnt = 0
    for att in vehsAttributesNames:
        vehsAttNames.update({att: cnt})
        cnt += 1




def GetSignalsData1():
    global SignalAttributes1
    global SigAttNames1
    SignalAttributes1 = []
    SigAttNames1 = []
    SignalAttributesNames1 = ['No','GreenStart', 'GreenEnd', 'IGT', 'SigState', 'GreenTimeDuration']
    SignalAttributes1 = toList(Vissim.Net.SignalControllers.ItemByKey(1).SGs.GetMultipleAttributes(SignalAttributesNames1))
    SigAttNames1 = {}
    ctt = 0
    for ftt in SignalAttributesNames1:
        SigAttNames1.update({ftt: ctt})
        ctt+=1

def GetSignalsData5():
    global SignalAttributes5
    global SigAttNames5
    SignalAttributes5 = []
    SigAttNames5 = []
    SignalAttributesNames5 = ['No','GreenStart', 'GreenEnd', 'IGT', 'SigState', 'GreenTimeDuration']
    SignalAttributes5 = toList(Vissim.Net.SignalControllers.ItemByKey(5).SGs.GetMultipleAttributes(SignalAttributesNames5))
    SigAttNames5 = {}
    ctt = 0
    for ftt in SignalAttributesNames5:
        SigAttNames5.update({ftt: ctt})
        ctt+=5


def GetSignalsData12():
    global SignalAttributes12
    global SigAttNames12
    SignalAttributes12 = []
    SigAttNames12 = []
    SignalAttributesNames12 = ['No','GreenStart', 'GreenEnd', 'IGT', 'SigState', 'GreenTimeDuration']
    SignalAttributes12 = toList(Vissim.Net.SignalControllers.ItemByKey(12).SGs.GetMultipleAttributes(SignalAttributesNames12))
    SigAttNames12 = {}
    ctt = 0
    for ftt in SignalAttributesNames12:
        SigAttNames12.update({ftt: ctt})
        ctt+=12

def GetSignalsData13():
    global SignalAttributes13
    global SigAttNames13
    SignalAttributes13 = []
    SigAttNames13 = []
    SignalAttributesNames13 = ['No','GreenStart', 'GreenEnd', 'IGT', 'SigState', 'GreenTimeDuration']
    SignalAttributes13 = toList(Vissim.Net.SignalControllers.ItemByKey(13).SGs.GetMultipleAttributes(SignalAttributesNames13))
    SigAttNames13 = {}
    ctt = 0
    for ftt in SignalAttributesNames13:
        SigAttNames13.update({ftt: ctt})
        ctt+=13




def GetSignalsData2():
    global SignalAttributes2
    global SigAttNames2
    SignalAttributes2 = []
    SigAttNames2 = []
    SignalAttributesNames2 = ['No','GreenStart', 'GreenEnd', 'IGT', 'SigState', 'GreenTimeDuration']
    SignalAttributes2 = toList(Vissim.Net.SignalControllers.ItemByKey(2).SGs.GetMultipleAttributes(SignalAttributesNames2))
    SigAttNames2 = {}
    ctt = 0
    for ftt in SignalAttributesNames2:
        SigAttNames2.update({ftt: ctt})
        ctt+=1


def GetSignalsData3():
    global SignalAttributes3
    global SigAttNames3
    SignalAttributes3 = []
    SigAttNames3 = []
    SignalAttributesNames3 = ['No','GreenStart', 'GreenEnd', 'IGT', 'SigState', 'GreenTimeDuration']
    SignalAttributes3 = toList(Vissim.Net.SignalControllers.ItemByKey(3).SGs.GetMultipleAttributes(SignalAttributesNames3))
    SigAttNames3 = {}
    ctt = 0
    for ftt in SignalAttributesNames3:
        SigAttNames3.update({ftt: ctt})
        ctt+=1



def GetSignalsData4():
    global SignalAttributes4
    global SigAttNames4
    SignalAttributes4 = []
    SigAttNames4 = []
    SignalAttributesNames4 = ['No','GreenStart', 'GreenEnd', 'IGT', 'SigState', 'GreenTimeDuration']
    SignalAttributes4 = toList(Vissim.Net.SignalControllers.ItemByKey(4).SGs.GetMultipleAttributes(SignalAttributesNames4))
    SigAttNames4 = {}
    ctt = 0
    for ftt in SignalAttributesNames4:
        SigAttNames4.update({ftt: ctt})
        ctt+=1


def GetSignalsData6():
    global SignalAttributes6
    global SigAttNames6
    SignalAttributes6 = []
    SigAttNames6 = []
    SignalAttributesNames6 = ['No','GreenStart', 'GreenEnd', 'IGT', 'SigState', 'GreenTimeDuration']
    SignalAttributes6 = toList(Vissim.Net.SignalControllers.ItemByKey(6).SGs.GetMultipleAttributes(SignalAttributesNames6))
    SigAttNames6 = {}
    ctt = 0
    for ftt in SignalAttributesNames6:
        SigAttNames6.update({ftt: ctt})
        ctt+=1


def GetSignalsData7():
    global SignalAttributes7
    global SigAttNames7
    SignalAttributes7 = []
    SigAttNames7 = []
    SignalAttributesNames7 = ['No','GreenStart', 'GreenEnd', 'IGT', 'SigState', 'GreenTimeDuration']
    SignalAttributes7 = toList(Vissim.Net.SignalControllers.ItemByKey(7).SGs.GetMultipleAttributes(SignalAttributesNames7))
    SigAttNames7 = {}
    ctt = 0
    for ftt in SignalAttributesNames7:
        SigAttNames7.update({ftt: ctt})
        ctt+=1


def GetSignalsData8():
    global SignalAttributes8
    global SigAttNames8
    SignalAttributes8 = []
    SigAttNames8 = []
    SignalAttributesNames8 = ['No','GreenStart', 'GreenEnd', 'IGT', 'SigState', 'GreenTimeDuration']
    SignalAttributes8 = toList(Vissim.Net.SignalControllers.ItemByKey(8).SGs.GetMultipleAttributes(SignalAttributesNames8))
    SigAttNames8 = {}
    ctt = 0
    for ftt in SignalAttributesNames8:
        SigAttNames8.update({ftt: ctt})
        ctt+=1

def GetSignalsData9():
    global SignalAttributes9
    global SigAttNames9
    SignalAttributes9 = []
    SigAttNames9 = []
    SignalAttributesNames9 = ['No','GreenStart', 'GreenEnd', 'IGT', 'SigState', 'GreenTimeDuration']
    SignalAttributes9 = toList(Vissim.Net.SignalControllers.ItemByKey(9).SGs.GetMultipleAttributes(SignalAttributesNames9))
    SigAttNames9 = {}
    ctt = 0
    for ftt in SignalAttributesNames9:
        SigAttNames9.update({ftt: ctt})
        ctt+=1

def GetSignalsData10():
    global SignalAttributes10
    global SigAttNames10
    SignalAttributes10 = []
    SigAttNames10 = []
    SignalAttributesNames10 = ['No','GreenStart', 'GreenEnd', 'IGT', 'SigState', 'GreenTimeDuration']
    SignalAttributes10 = toList(Vissim.Net.SignalControllers.ItemByKey(10).SGs.GetMultipleAttributes(SignalAttributesNames10))
    SigAttNames10 = {}
    ctt = 0
    for ftt in SignalAttributesNames10:
        SigAttNames10.update({ftt: ctt})
        ctt+=1

def GetSignalsData11():
    global SignalAttributes11
    global SigAttNames11
    SignalAttributes11 = []
    SigAttNames11 = []
    SignalAttributesNames11 = ['No','GreenStart', 'GreenEnd', 'IGT', 'SigState', 'GreenTimeDuration', 'ContrByCOM']
    SignalAttributes11 = toList(Vissim.Net.SignalControllers.ItemByKey(11).SGs.GetMultipleAttributes(SignalAttributesNames11))
    SigAttNames11 = {}
    ctt = 0
    for ftt in SignalAttributesNames11:
        SigAttNames11.update({ftt: ctt})
        ctt+=1


def GetLinksData():
    global LinkAttributes
    global LinAttNames
    LinkAttributes = []
    LinAttNames = []
    LinkAttributesNames = ['No','Count:Vehs']
    LinkAttributes = toList(Vissim.Net.Links.GetMultipleAttributes(LinkAttributesNames))
    LinAttNames = {}
    ppc = 0
    for ftt in LinkAttributesNames:
        LinAttNames.update({ftt: ppc})
        ppc+=1





def Density():
    GetLinksData()
    GetVissimDataVehicles()
    global density
    if Vissim.Net.SignalControllers.ItemByKey(1).AttValue ('CycSec')>3 and Vissim.Net.SignalControllers.ItemByKey(1).AttValue ('CycSec')<=4:
        kk=0
        for x in LinkAttributes:
            kk= kk + x[LinAttNames['Count:Vehs']]
        density = kk  - Vissim.Net.Links.ItemByKey(107).AttValue ('Count:Vehs') - Vissim.Net.Links.ItemByKey(108).AttValue ('Count:Vehs') - Vissim.Net.Links.ItemByKey(109).AttValue ('Count:Vehs')- Vissim.Net.Links.ItemByKey(110).AttValue ('Count:Vehs')- Vissim.Net.Links.ItemByKey(111).AttValue ('Count:Vehs')- Vissim.Net.Links.ItemByKey(112).AttValue ('Count:Vehs')- Vissim.Net.Links.ItemByKey(113).AttValue ('Count:Vehs')-- Vissim.Net.Links.ItemByKey(114).AttValue ('Count:Vehs')
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('Density', density)
        f= open("2.txt","a")
        f.write(","+str(density))
        f.write("\n")


def lambdaRate():
    GetVissimDataVehicles()
    KalmanGain = 0.05
    proportion_of_CAVs=0.25
    CLength=80
    Seconds = Vissim.Net.SignalControllers.ItemByKey(1).AttValue ('CycSec')
    InitialArrival=50
    InitialArrival2=140
    

    Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue('Seconds',Vissim.Net.Simulation.SimulationSecond)
    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue('Seconds')<=1: 
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue('ArrivalRate',100)      
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue('ArrivalRate',0)
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue('ArrivalRate',0)
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue('ArrivalRate',0)
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue('ArrivalRate',100)      
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue('ArrivalRate',0)
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue('ArrivalRate',0)
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue('ArrivalRate',0)
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue('ArrivalRate',100)      
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue('ArrivalRate',0)
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue('ArrivalRate',0)
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue('ArrivalRate',0)
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue('ArrivalRate',100)      
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue('ArrivalRate',0)
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue('ArrivalRate',0)
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue('ArrivalRate',0)

        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue('ArrivalRate',0)      
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue('ArrivalRate',0)
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue('ArrivalRate',0)
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue('ArrivalRate',0)

        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue('ArrivalRate',0)      
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue('ArrivalRate',0)
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue('ArrivalRate',0)
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue('ArrivalRate',0)

        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue('ArrivalRate',0)      
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue('ArrivalRate',0)
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue('ArrivalRate',0)
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue('ArrivalRate',0)

        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue('ArrivalRate',0)      
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue('ArrivalRate',0)
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue('ArrivalRate',0)
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue('ArrivalRate',0)

        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue('ArrivalRate',0)      
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue('ArrivalRate',0)
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue('ArrivalRate',0)
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue('ArrivalRate',0)

        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue('ArrivalRate',0)      
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue('ArrivalRate',0)
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue('ArrivalRate',0)
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue('ArrivalRate',0)

        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue('ArrivalRate',0)      
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue('ArrivalRate',0)
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue('ArrivalRate',0)
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue('ArrivalRate',0)

        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue('ArrivalRate',0)      
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue('ArrivalRate',0)
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue('ArrivalRate',0)
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue('ArrivalRate',0)

        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue('ArrivalRate',0)      
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue('ArrivalRate',0)
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue('ArrivalRate',0)
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue('ArrivalRate',0)


        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue('GreenTimeDuration',37)      
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue('GreenTimeDuration',37)
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue('GreenTimeDuration',37)
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue('GreenTimeDuration',37)

        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue('GreenTimeDuration',37)      
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue('GreenTimeDuration',37)
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue('GreenTimeDuration',37)
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue('GreenTimeDuration',37)

        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue('GreenTimeDuration',37)      
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue('GreenTimeDuration',37)
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue('GreenTimeDuration',37)
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue('GreenTimeDuration',37)

        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue('GreenTimeDuration',37)      
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue('GreenTimeDuration',37)
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue('GreenTimeDuration',37)
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue('GreenTimeDuration',37)

        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue('GreenTimeDuration',17)      
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue('GreenTimeDuration',17)
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue('GreenTimeDuration',17)
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue('GreenTimeDuration',17)

        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue('GreenTimeDuration',17)      
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue('GreenTimeDuration',17)
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue('GreenTimeDuration',17)
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue('GreenTimeDuration',17)


        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue('GreenTimeDuration',17)      
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue('GreenTimeDuration',17)
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue('GreenTimeDuration',17)
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue('GreenTimeDuration',17)

        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue('GreenTimeDuration',17)      
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue('GreenTimeDuration',17)
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue('GreenTimeDuration',17)
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue('GreenTimeDuration',17)


        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue('GreenTimeDuration',17)      
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue('GreenTimeDuration',17)
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue('GreenTimeDuration',17)
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue('GreenTimeDuration',17)


        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue('GreenTimeDuration',17)      
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue('GreenTimeDuration',17)
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue('GreenTimeDuration',17)
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue('GreenTimeDuration',17)



        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue('GreenTimeDuration',17)      
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue('GreenTimeDuration',17)
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue('GreenTimeDuration',17)
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue('GreenTimeDuration',17)


        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue('GreenTimeDuration',17)      
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue('GreenTimeDuration',17)
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue('GreenTimeDuration',17)
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue('GreenTimeDuration',17)


        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue('GreenTimeDuration',17)      
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue('GreenTimeDuration',17)
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue('GreenTimeDuration',17)
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue('GreenTimeDuration',17)


    if Seconds>=0:
        A1=0
        A2=0
        A3=0
        A4=0
        A5=0
        A6=0
        A7=0
        A8=0
        A9=0
        A10=0
        A11=0
        A12=0
        A13=0
        A14=0
        A15=0
        A16=0
        A17=0
        A18=0
        A19=0
        A20=0
        A21=0
        A22=0
        A23=0
        A24=0
        A25=0
        A26=0
        A27=0
        A28=0
        A29=0
        A30=0
        A31=0
        A32=0
        A33=0
        A34=0
        A35=0
        A36=0
        A37=0
        A38=0
        A39=0
        A40=0
        A41=0
        A42=0
        A43=0
        A44=0
        A45=0
        A46=0
        A47=0
        A48=0
        A49=0
        A50=0
        A51=0
        A52=0
        A53=0
        A54=0
        A55=0
        A56=0
        B1=0
        B2=0
        B3=0
        B4=0
        B5=0
        B6=0
        B7=0
        B8=0
        B9=0
        B10=0
        B11=0
        B12=0
        B13=0
        B14=0
        B15=0
        B16=0

        if Seconds <=1:
            A1=0
            A2=0
            A3=0
            A4=0
            A5=0
            A6=0
            A7=0
            A8=0
            A9=0
            A10=0
            A11=0
            A12=0
            A13=0
            A14=0
            A15=0
            A16=0
            A17=0
            A18=0
            A19=0
            A20=0
            A21=0
            A22=0
            A23=0
            A24=0
            A25=0
            A26=0
            A27=0
            A28=0
            A29=0
            A30=0
            A31=0
            A32=0
            A33=0
            A34=0
            A35=0
            A36=0
            A37=0
            A38=0
            A39=0
            A40=0
            A41=0
            A42=0
            A43=0
            A44=0
            A45=0
            A46=0
            A47=0
            A48=0
            A49=0
            A50=0
            A51=0
            A52=0
            A53=0
            A54=0
            A55=0
            A56=0
            B1=0
            B2=0
            B3=0
            B4=0
            B5=0
            B6=0
            B7=0
            B8=0
            B9=0
            B10=0
            B11=0
            B12=0
            B13=0
            B14=0
            B15=0
            B16=0                     
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('len9',0)
       
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('len9',0)
       
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('len9',0)
         
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('len9',0)                                                                                     
       
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('len9',0)

            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('len9',0)
         
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('len9',0)
         
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('len9',0)
       
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('len9',0)
         
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('len9',0)
            
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('len9',0)
         
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('len9',0)
          
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('len9',0)
          
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('len9',0)
     
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('len9',0)
         
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('len9',0)
       
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('len9',0)
     
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('len9',0)
        
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('len9',0)
         
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('len9',0)
      
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('len9',0)
        
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('len9',0)
       
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('len9',0)
        
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('len9',0)
         
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('len9',0)

            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('len9',0)
             
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('len9',0)
            
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('len9',0)

            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('len9',0)
        
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('len9',0)
        
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('len9',0)
      
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('len9',0)
            
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('len9',0)
                
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('len9',0)
              
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('len9',0)
          
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('len9',0)

            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('len9',0)       
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('len9',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('len9',0)       
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('len9',0)

            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('len9',0)       
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('len9',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('len9',0)       
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('len9',0)


            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('len9',0)       
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('len9',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('len9',0)       
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('len9',0)

            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('len9',0)       
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('len9',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('len9',0)       
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('len9',0)


        if Seconds >1:
            for vehAttributes in vehsAttributes:
                if vehAttributes[vehsAttNames['VehType\No']] in vehTypesEquipped:       
                    if vehAttributes[vehsAttNames['Pos']] != None:
                            Dist = vehAttributes[vehsAttNames['DistanceToSigHead']]
                            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('LinkNo3',Dist)
                            if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo3') <= 42 and Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo3') >= 40:
                                Speed = vehAttributes[vehsAttNames['Speed']]
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('LinkNo4',Speed)
                                if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo4') != 0:
                                    Link = vehAttributes[vehsAttNames['Lane\Link']]
                                    Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('LinkNo2',Link)
                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 99:
                                        A6 = Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('len9', A6)

                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 65:
                                        A7=Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('len9', A7)
                                        

                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 75:
                                        A8 = Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('len9', A8)

                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 102:
                                        A9 =  Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('len9', A9)


                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 76:
                                        A15 =  Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('len9', A15)

                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 86:
                                        A16 = Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('len9', A16)

                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 77:
                                        A17 = Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('len9', A17)


                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 67:
                                        A18 = Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('len9', A18)


                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 78:
                                        A19 = Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('len9', A19)


                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 96:
                                        A20 = Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('len9', A20)

                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 69:
                                        A21 = Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('len9', A21)

                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 97:
                                        A22 = Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('len9', A22)


                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 70 :
                                        A28 = Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('len9', A28)

                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 87:
                                        A29 = Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('len9', A29)

                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 63 :
                                        A30 = Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('len9', A30)


                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 82:
                                        A31 = Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('len9', A31)


                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 81:
                                        A32 =  Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('len9', A32)


                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 61:
                                        A33 =  Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('len9', A33)

                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 80:
                                        A34 = Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('len9', A34)

                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 68:
                                        A35 =  Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('len9', A35)


                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 79:
                                        A36 =  Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('len9', A36)
                                       

                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 59:
                                        A37 =  Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('len9', A37)

                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 90:
                                        A38 =  Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('len9', A38)


                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 66:
                                        A39 =  Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('len9', A39)


                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 60:
                                        A40 = Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('len9', A40)

                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 92:
                                        A41 =  Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('len9', A41)

                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 71:
                                        A42 = Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('len9', A42)

                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 93:
                                        A43 = Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('len9', A43)


                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 72:
                                        A44 = Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('len9', A44)

                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 62:
                                        A45 = Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('len9', A45)

                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 73:
                                        A46 = Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('len9', A46)

                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 83:
                                        A47 = Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('len9', A47)


                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 74:
                                        A48 = Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('len9', A48)

                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 64:
                                        A49 = Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('len9', A49)


                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 104:
                                        A50 = Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('len9', A50)

                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 105:
                                        A51 = Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).AttValue ('len9') +1
                                        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('len9', A51)



                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 109:
                                        B1 = Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('len9', B1)



                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 91:
                                        B2 = Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('len9', B2)


                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 89:
                                        B3 = Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('len9', B3)


                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 100:
                                        B4 = Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('len9', B4)




                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 108:
                                        B5 = Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('len9', B5)



                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 98:
                                        B6 = Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('len9', B6)


                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 88:
                                        B7 = Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('len9', B7)


                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 103:
                                        B8 = Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('len9', B8)





                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 112:
                                        B9 = Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('len9', B9)



                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 101:
                                        B10 = Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('len9', B10)


                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 85:
                                        B11 = Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('len9', B11)


                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 95:
                                        B12 = Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('len9', B12)




                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 113:
                                        B13 = Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('len9', B13)



                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 106:
                                        B14 = Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('len9', B14)


                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 84:
                                        B15 = Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('len9', B15)


                                    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo2') == 94:
                                        B16 = Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('len9')+1
                                        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('len9', B16)


                continue
                
        if Seconds>=72 and Seconds<=76:
            if Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).AttValue ('len9') == 0:
                arrival912= InitialArrival
            else:
                arrival912=(Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival911= Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).AttValue ('ArrivalRate')
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('Arrival1', arrival911)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('Arrival2', arrival912)


            if Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).AttValue ('len9')==0:
                arrival932= InitialArrival
            else:
                arrival932=(Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival931= Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).AttValue ('ArrivalRate')

            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('Arrival1', arrival931)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('Arrival2', arrival932)



            if Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).AttValue ('len9')==0:
                arrival922= InitialArrival
            else:
                arrival922=(Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival921= Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).AttValue ('ArrivalRate')

            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('Arrival1', arrival921)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('Arrival2', arrival922)




            if Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).AttValue ('len9')==0:
                arrival942= InitialArrival
            else:
                arrival942=(Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival941= Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).AttValue ('ArrivalRate')

            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('Arrival1', arrival941)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('Arrival2', arrival942)

                                                                                           


            if Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).AttValue ('len9')==0:
                arrival1012= InitialArrival
            else:
                arrival1012=(Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival1011= Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).AttValue ('ArrivalRate')
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('Arrival1', arrival1011)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('Arrival2', arrival1012)



            if Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).AttValue ('len9')==0:
                arrival1042= InitialArrival
            else:
                arrival1042=(Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival1041= Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).AttValue ('ArrivalRate')
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('Arrival1', arrival1041)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('Arrival2', arrival1042)





            if Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).AttValue ('len9')==0:
                arrival1022= InitialArrival
            else:
                arrival1022=(Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival1021= Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).AttValue ('ArrivalRate')

            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('Arrival1', arrival1021)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('Arrival2', arrival1022)


            if Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).AttValue ('len9')==0:
                arrival1032= InitialArrival
            else:
                arrival1032=(Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival1031= Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).AttValue ('ArrivalRate')

            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('Arrival1', arrival1031)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('Arrival2', arrival1032)


            if  Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).AttValue ('len9')==0:
                arrival1112= InitialArrival
            else:
                arrival1112=( Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival1111= Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).AttValue ('ArrivalRate')

            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('Arrival1', arrival1111)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('Arrival2', arrival1112)



            if Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).AttValue ('len9')==0:
                arrival1142= InitialArrival
            else:
                arrival1142=(Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival1141= Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).AttValue ('ArrivalRate')

            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('Arrival1', arrival1141)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('Arrival2', arrival1142)




            if Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).AttValue ('len9')==0:
                arrival1132= InitialArrival
            else:
                arrival1132=(Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival1131= Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).AttValue ('ArrivalRate')


            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('Arrival1', arrival1131)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('Arrival2', arrival1132)

            
            if Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).AttValue ('len9')==0:
                arrival1122= InitialArrival
            else:
                arrival1122=(Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival1121= Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).AttValue ('ArrivalRate')


            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('Arrival1', arrival1121)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('Arrival2', arrival1122)



            if Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).AttValue ('len9')==0:
                arrival422= InitialArrival
            else:
                arrival422=(Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival421= Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).AttValue ('ArrivalRate')


            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('Arrival1', arrival421)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('Arrival2', arrival422)




            if Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).AttValue ('len9')==0:
                arrival432= InitialArrival
            else:
                arrival432=(Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival431= Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).AttValue ('ArrivalRate')
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('Arrival1', arrival431)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('Arrival2', arrival432)






            if Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).AttValue ('len9')==0:
                arrival442= InitialArrival
            else:
                arrival442=(Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival441= Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).AttValue ('ArrivalRate')
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('Arrival1', arrival441)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('Arrival2', arrival442)







            if Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).AttValue ('len9')==0:
                arrival412= InitialArrival
            else:
                arrival412=(Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival411= Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).AttValue ('ArrivalRate')

            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('Arrival1', arrival411)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('Arrival2', arrival412)







            if Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).AttValue ('len9') ==0:
                arrival332= InitialArrival
            else:
                arrival332=(Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival331= Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).AttValue ('ArrivalRate')


            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('Arrival1', arrival331)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('Arrival2', arrival332)





            if Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).AttValue ('len9')==0:
                arrival342= InitialArrival
            else:
                arrival342=(Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival341= Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).AttValue ('ArrivalRate')


            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('Arrival1', arrival341)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('Arrival2', arrival342)



            if Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).AttValue ('len9')==0:
                arrival312= InitialArrival
            else:
                arrival312=(Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival311= Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).AttValue ('ArrivalRate')


            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('Arrival1', arrival311)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('Arrival2', arrival312)




            if Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).AttValue ('len9')==0:
                arrival322= InitialArrival
            else:
                arrival322=(Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival321= Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).AttValue ('ArrivalRate')

            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('Arrival1', arrival321)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('Arrival2', arrival322)




            if Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).AttValue ('len9')==0:
                arrival232= InitialArrival
            else:
                arrival232=(Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival231= Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).AttValue ('ArrivalRate')


            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('Arrival1', arrival231)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('Arrival2', arrival232)



            if Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).AttValue ('len9')==0:
                arrival242= InitialArrival
            else:
                arrival242=(Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival241= Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).AttValue ('ArrivalRate')


            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('Arrival1', arrival241)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('Arrival2', arrival242)





            if Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).AttValue ('len9')==0:
                arrival212= InitialArrival
            else:
                arrival212=(Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival211= Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).AttValue ('ArrivalRate')
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('Arrival1', arrival211)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('Arrival2', arrival212)




            if Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).AttValue ('len9')==0:
                arrival222= InitialArrival
            else:
                arrival222=(Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival221= Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).AttValue ('ArrivalRate')
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('Arrival1', arrival221)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('Arrival2', arrival222)
            
                 



            if Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).AttValue ('len9')==0:
                arrival622= InitialArrival
            else:
                arrival622=(Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival621= Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).AttValue ('ArrivalRate')


            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('Arrival1', arrival621)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('Arrival2', arrival622)





            if Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).AttValue ('len9')==0:
                arrival612= InitialArrival
            else:
                arrival612=(Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival611= Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).AttValue ('ArrivalRate')

            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('Arrival1', arrival611)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('Arrival2', arrival612)        


            if  Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).AttValue ('len9')==0:
                arrival632= InitialArrival
            else:
                arrival632=( Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival631= Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).AttValue ('ArrivalRate')


            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('Arrival1', arrival631)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('Arrival2', arrival632)


            if Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).AttValue ('len9')==0:
                arrival642= InitialArrival
            else:
                arrival642=(Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival641= Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).AttValue ('ArrivalRate')

            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('Arrival1', arrival641)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('Arrival2', arrival642)


            if Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).AttValue ('len9')==0:
                arrival712= InitialArrival
            else:
                arrival712=(Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival711= Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).AttValue ('ArrivalRate')


            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('Arrival1', arrival711)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('Arrival2', arrival712)


            if Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).AttValue ('len9')==0:
                arrival722= InitialArrival
            else:
                arrival722=(Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival721= Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).AttValue ('ArrivalRate')

            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('Arrival1', arrival721)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('Arrival2', arrival722)



            if Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).AttValue ('len9')==0:
                arrival732= InitialArrival
            else:
                arrival732=(Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
                
            arrival731= Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).AttValue ('ArrivalRate')

            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('Arrival1', arrival731)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('Arrival2', arrival732)



            if Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).AttValue ('len9')==0:
                arrival742= InitialArrival
            else:
                arrival742=(Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
                
            arrival741= Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).AttValue ('ArrivalRate')

            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('Arrival1', arrival741)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('Arrival2', arrival742)



            if  Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).AttValue ('len9')==0:
                arrival812= InitialArrival
            else:
                arrival812=( Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
                
            arrival811= Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).AttValue ('ArrivalRate')

            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('Arrival1', arrival811)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('Arrival2', arrival812)        


            if Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).AttValue ('len9')==0:
                arrival822= InitialArrival
            else:
                arrival822=(Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
                
            arrival821= Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).AttValue ('ArrivalRate')
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('Arrival1', arrival821)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('Arrival2', arrival822) 
            

            if Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).AttValue ('len9')==0:
                arrival832= InitialArrival
            else:
                arrival832=(Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
                
            arrival831= Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).AttValue ('ArrivalRate')

            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('Arrival1', arrival831)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('Arrival2', arrival832) 
            



            if Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).AttValue ('len9')==0:
                arrival842= InitialArrival
            else:
                arrival842=( Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
                
            arrival841= Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).AttValue ('ArrivalRate')

            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('Arrival1', arrival821)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('Arrival2', arrival822) 



            if Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('len9') == 0:
                arrival1312= InitialArrival2
            else:
                arrival1312=(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival1311= Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('ArrivalRate')
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('Arrival1', arrival1311)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('Arrival2', arrival1312)

            if Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('len9') == 0:
                arrival1322= InitialArrival
            else:
                arrival1322=(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival1321= Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('ArrivalRate')
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('Arrival1', arrival1321)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('Arrival2', arrival1322)

            if Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('len9') == 0:
                arrival1332= InitialArrival
            else:
                arrival1332=(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival1331= Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('ArrivalRate')
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('Arrival1', arrival1331)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('Arrival2', arrival1332)

            if Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('len9') == 0:
                arrival1342= InitialArrival
            else:
                arrival1342=(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival1341= Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('ArrivalRate')
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('Arrival1', arrival1341)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('Arrival2', arrival1342)



            if Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('len9') == 0:
                arrival1212= InitialArrival2
            else:
                arrival1212=(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival1211= Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('ArrivalRate')
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('Arrival1', arrival1211)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('Arrival2', arrival1212)

            if Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('len9') == 0:
                arrival1222= InitialArrival
            else:
                arrival1222=(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival1221= Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('ArrivalRate')
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('Arrival1', arrival1221)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('Arrival2', arrival1222)

            if Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('len9') == 0:
                arrival1232= InitialArrival
            else:
                arrival1232=(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival1231= Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('ArrivalRate')
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('Arrival1', arrival1231)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('Arrival2', arrival1232)

            if Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('len9') == 0:
                arrival1242= InitialArrival
            else:
                arrival1242=(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival1241= Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('ArrivalRate')
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('Arrival1', arrival1241)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('Arrival2', arrival1242)


            if Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('len9') == 0:
                arrival55= InitialArrival2
            else:
                arrival55=(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival511= Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('ArrivalRate')
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('Arrival1', arrival511)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('Arrival2', arrival55)

            if Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('len9') == 0:
                arrival522= InitialArrival
            else:
                arrival522=(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival521= Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('ArrivalRate')
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('Arrival1', arrival521)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('Arrival2', arrival522)

            if Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('len9') == 0:
                arrival532= InitialArrival
            else:
                arrival532=(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival531= Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('ArrivalRate')
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('Arrival1', arrival531)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('Arrival2', arrival532)

            if Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('len9') == 0:
                arrival542= InitialArrival
            else:
                arrival542=(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival541= Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('ArrivalRate')
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('Arrival1', arrival541)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('Arrival2', arrival542)


            if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('len9') == 0:
                arrival11= InitialArrival2
            else:
                arrival11=(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival111= Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('ArrivalRate')
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('Arrival1', arrival111)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('Arrival2', arrival11)

            if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('len9') == 0:
                arrival122= InitialArrival
            else:
                arrival122=(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival121= Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('ArrivalRate')
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('Arrival1', arrival121)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('Arrival2', arrival122)

            if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('len9') == 0:
                arrival132= InitialArrival
            else:
                arrival132=(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival131= Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('ArrivalRate')
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('Arrival1', arrival131)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('Arrival2', arrival132)

            if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('len9') == 0:
                arrival142= InitialArrival
            else:
                arrival142=(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('len9')/(proportion_of_CAVs*CLength))*3600
            arrival141= Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('ArrivalRate')
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('Arrival1', arrival141)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('Arrival2', arrival142)
            

        if Seconds >= 77:                     
            ArrivalUpdate91 = Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('ArrivalRate',ArrivalUpdate91)

            ArrivalUpdate92 = Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('ArrivalRate',ArrivalUpdate92)

            ArrivalUpdate93 = Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('ArrivalRate',ArrivalUpdate93)


            ArrivalUpdate94 = Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('ArrivalRate',ArrivalUpdate94)

            ArrivalUpdate101 = Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('ArrivalRate',ArrivalUpdate101)

            ArrivalUpdate102 = Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('ArrivalRate',ArrivalUpdate102)

            ArrivalUpdate103 = Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('ArrivalRate',ArrivalUpdate103)


            ArrivalUpdate104 = Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('ArrivalRate',ArrivalUpdate104)

            ArrivalUpdate111 = Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('ArrivalRate',ArrivalUpdate111)

            ArrivalUpdate112 = Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('ArrivalRate',ArrivalUpdate112)

            ArrivalUpdate113 = Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('ArrivalRate',ArrivalUpdate113)


            ArrivalUpdate114 = Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('ArrivalRate',ArrivalUpdate114)

            ArrivalUpdate61 = Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('ArrivalRate',ArrivalUpdate61)

            ArrivalUpdate62 = Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('ArrivalRate',ArrivalUpdate62)

            ArrivalUpdate63 = Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('ArrivalRate',ArrivalUpdate63)


            ArrivalUpdate64 = Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('ArrivalRate',ArrivalUpdate64)


            ArrivalUpdate71 = Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('ArrivalRate',ArrivalUpdate71)

            ArrivalUpdate72 = Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('ArrivalRate',ArrivalUpdate72)

            ArrivalUpdate73 = Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('ArrivalRate',ArrivalUpdate73)


            ArrivalUpdate74 = Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('ArrivalRate',ArrivalUpdate74)

            ArrivalUpdate81 = Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('ArrivalRate',ArrivalUpdate81)

            ArrivalUpdate82 = Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('ArrivalRate',ArrivalUpdate82)

            ArrivalUpdate83 = Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('ArrivalRate',ArrivalUpdate83)


            ArrivalUpdate84 = Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('ArrivalRate',ArrivalUpdate84)



            ArrivalUpdate21 = Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('ArrivalRate',ArrivalUpdate21)

            ArrivalUpdate22 = Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('ArrivalRate',ArrivalUpdate22)

            ArrivalUpdate23 = Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('ArrivalRate',ArrivalUpdate23)


            ArrivalUpdate24 = Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('ArrivalRate',ArrivalUpdate24)


            ArrivalUpdate31 = Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('ArrivalRate',ArrivalUpdate31)

            ArrivalUpdate32 = Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('ArrivalRate',ArrivalUpdate32)

            ArrivalUpdate33 = Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('ArrivalRate',ArrivalUpdate33)


            ArrivalUpdate34 = Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('ArrivalRate',ArrivalUpdate34)



            ArrivalUpdate41 = Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('ArrivalRate',ArrivalUpdate41)

            ArrivalUpdate42 = Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('ArrivalRate',ArrivalUpdate42)

            ArrivalUpdate43 = Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('ArrivalRate',ArrivalUpdate43)


            ArrivalUpdate44 = Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('ArrivalRate',ArrivalUpdate44)



            ArrivalUpdate131 = Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('ArrivalRate',ArrivalUpdate131)

            ArrivalUpdate132 = Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('ArrivalRate',ArrivalUpdate132)

            ArrivalUpdate133 = Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('ArrivalRate',ArrivalUpdate133)


            ArrivalUpdate134 = Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('ArrivalRate',ArrivalUpdate134)


            ArrivalUpdate121 = Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('ArrivalRate',ArrivalUpdate121)

            ArrivalUpdate122 = Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('ArrivalRate',ArrivalUpdate122)

            ArrivalUpdate123 = Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('ArrivalRate',ArrivalUpdate123)


            ArrivalUpdate124 = Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('ArrivalRate',ArrivalUpdate124)


            ArrivalUpdate51 = Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('ArrivalRate',ArrivalUpdate51)

            ArrivalUpdate52 = Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('ArrivalRate',ArrivalUpdate52)

            ArrivalUpdate53 = Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('ArrivalRate',ArrivalUpdate53)


            ArrivalUpdate54 = Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('ArrivalRate',ArrivalUpdate54)


            ArrivalUpdate11 = Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('ArrivalRate',ArrivalUpdate11)

            ArrivalUpdate12 = Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('ArrivalRate',ArrivalUpdate12)

            ArrivalUpdate13 = Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('ArrivalRate',ArrivalUpdate13)


            ArrivalUpdate14 = Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('Arrival1') + KalmanGain*(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('Arrival2')-Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('Arrival1'))                       
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('ArrivalRate',ArrivalUpdate14)


def NetworkController():
    Init()
    lambdaRate()
    GetLinksData()
    GetVissimDataVehicles()
    proportion_of_CAVs=0.25
    LostTime = 0
    greenExtension = 5
    Tt = 6
    St = 0.4
    CLength= 80
    Seconds = Vissim.Net.SignalControllers.ItemByKey(1).AttValue ('CycSec')
    MaxGreen=49
    MinGreen=25
    GreenMinI2=25
    GreenMaxI2=49
    St2= 0.8
    KalmanGain = 0.05
    proportion_of_CAVs=0.25
    InitialArrival=10
    InitialArrival2=140
    Kq=160
    Seconds = Vissim.Net.SignalControllers.ItemByKey(1).AttValue ('CycSec')
    Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue('Seconds',Vissim.Net.Simulation.SimulationSecond)
    if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue('Seconds')<=3: 
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue('SystemContent',0)  

#first time step
    if Seconds <2:
        L1=[]
        L2=[]
        L3=[]
        L4=[]
        L5=[]
        L6=[]
        L7=[]
        L8=[]
        L9=[]
        L10=[]
        L11=[]
        L12=[]
        L13=[]
        L14=[]
        L15=[]
        L16=[]
        L17=[]
        L18=[]
        L19=[]
        L20=[]
        L21=[]
        L22=[]
        L23=[]
        L24=[]
        L25=[]
        L26=[]
        L27=[]
        L28=[]
        L29=[]
        L30=[]
        L31=[]
        L32=[]
        L33=[]
        L34=[]
        L35=[]
        L36=[]
        L37=[]
        L38=[]
        L39=[]
        L40=[]
        L41=[]
        L42=[]
        L43=[]
        L44=[]
        L45=[]
        L46=[]
        L47=[]
        L48=[]
        L49=[]
        L50=[]
        L51=[]
        L52=[]
        L53=[]
        L54=[]
        L55=[]
        L56=[]
        LL1=[]
        LL2=[]
        LL3=[]
        LL4=[]
        LL5=[]
        LL6=[]
        LL7=[]
        LL8=[]
        LL9=[]
        LL10=[]
        LL11=[]
        LL12=[]
        LL13=[]
        LL14=[]
        LL15=[]
        LL16=[]
        S1=[]
        S2=[]
        S3=[]
        S4=[]
        S5=[]
        S6=[]
        S7=[]
        S8=[]
        S9=[]
        S10=[]
        S11=[]
        S12=[]
        S13=[]
        S14=[]
        S15=[]
        S16=[]
        S17=[]
        S18=[]
        S19=[]
        S20=[]
        S21=[]
        S22=[]
        S23=[]
        S24=[]
        S25=[]
        S26=[]
        S27=[]
        S28=[]
        S29=[]
        S30=[]
        S31=[]
        S32=[]
        S33=[]
        S34=[]
        S35=[]
        S36=[]
        S37=[]
        S38=[]
        S39=[]
        S40=[]
        S41=[]
        S42=[]
        S43=[]
        S44=[]
        S45=[]
        S46=[]
        S47=[]
        S48=[]
        S49=[]
        S50=[]
        S51=[]
        S52=[]
        S53=[]
        S54=[]
        S55=[]
        S56=[]

        for vehAttributes in vehsAttributes:
            if vehAttributes[vehsAttNames['VehType\No']] in vehTypesEquipped:       
                if vehAttributes[vehsAttNames['Pos']] != None:
                    InQueue = vehAttributes[vehsAttNames['InQueue']]               
                    if InQueue == True:
                        DistanceToSigHead = vehAttributes[vehsAttNames['DistanceToSigHead']]
                        Link = vehAttributes[vehsAttNames['Lane\Link']]
                        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('LinkNo',Link)
                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 99:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            L6.append(DistanceToSigHead)
                            D6 = max (L6)
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('len1',len(L6))

                            if len(L6) > 0:
                                k= max(min(round(D6/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D6/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('Joining',mm)
                                

                                    
                            

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 65:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            L7.append(DistanceToSigHead)
                            D7 = max (L7)
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('len1',len(L7))

                            if len(L7) > 0:
                                k= max(min(round(D7/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D7/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('Joining',mm)
                                


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 75:
                            
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            L8.append(DistanceToSigHead)
                            D8 = max(L8)
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('len1',len(L8))

                            if len(L8) > 0:
                                k= max(min(round(D8/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D8/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('Joining',mm)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 102:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            L9.append(DistanceToSigHead)
                            D9 = max (L9)
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('len1',len(L9))


                            if len(L9) > 0:
                                k= max(min(round(D9/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D9/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('Joining',mm)







                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 76:
                            L15.append(DistanceToSigHead)
                            D15 = max (L15)
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('len1',len(L15))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1


                            if len(L15) > 0:
                                k= max(min(round(D15/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D15/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('Joining',mm)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 86:
                            L16.append(DistanceToSigHead)
                            D16 = max (L16)
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('len1',len(L16))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            if len(L16) > 0:
                                k= max(min(round(D16/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D16/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 77:
                            L17.append(DistanceToSigHead)
                            D17 = max (L17)
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('len1',len(L17))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            if len(L17) > 0:
                                k= max(min(round(D17/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D17/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 67:
                            L18.append(DistanceToSigHead)
                            D18 = max (L18)
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('len1',len(L18))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            if len(L18) > 0:
                                k= max(min(round(D18/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D18/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('Joining',mm)








                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 78:
                            L19.append(DistanceToSigHead)
                            D19 = max (L19)
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('len1',len(L19))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            if len(L19) > 0:
                                k= max(min(round(D19/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D19/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 96:
                            L20.append(DistanceToSigHead)
                            D20 = max (L20)
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('len1',len(L20))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1

                            if len(L20) > 0:
                                k= max(min(round(D20/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D20/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 69:
                            L21.append(DistanceToSigHead)
                            D21 = max (L21)
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('len1',len(L21))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            if len(L21) > 0:
                                k= max(min(round(D21/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D21/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 97:
                            L22.append(DistanceToSigHead)
                            D22 = max (L22)
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('len1',len(L22))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1

                            if len(L22) > 0:
                                k= max(min(round(D22/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D22/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('Joining',mm)








                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 70:
                            L28.append(DistanceToSigHead)
                            D28 = max (L28)
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('len1',len(L28))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            if len(L28) > 0:
                                k= max(min(round(D28/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D28/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 87:
                            L29.append(DistanceToSigHead)
                            D29 = max (L29)
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('len1',len(L29))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            if len(L29) > 0:
                                k= max(min(round(D29/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D29/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 63:
                            L30.append(DistanceToSigHead)
                            D30 = max (L30)
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('len1',len(L30))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            if len(L30) > 0:
                                k= max(min(round(D30/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D30/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('Joining',mm)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 82:
                            L31.append(DistanceToSigHead)
                            D31 = max (L31)
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('len1',len(L31))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            if len(L31) > 0:
                                k= max(min(round(D31/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D31/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('Joining',mm)





                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 81:
                            L32.append(DistanceToSigHead)
                            D32 = max (L32)
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('len1',len(L32))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1

                            if len(L32) > 0:
                                k= max(min(round(D32/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D32/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 61:
                            L33.append(DistanceToSigHead)
                            D33 = max (L33)
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('len1',len(L33))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1

                            if len(L33) > 0:
                                k= max(min(round(D33/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D33/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 80:
                            L34.append(DistanceToSigHead)
                            D34 = max (L34)
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('len1',len(L34))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1

                            if len(L34) > 0:
                                k= max(min(round(D34/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D34/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 68:
                            L35.append(DistanceToSigHead)
                            D35 = max (L35)
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('len1',len(L35))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1

                            if len(L35) > 0:
                                k= max(min(round(D35/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D35/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('Joining',mm)







                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 79:
                            L36.append(DistanceToSigHead)
                            D36 = max (L36)
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('len1',len(L36))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1

                            if len(L36) > 0:
                                k= max(min(round(D36/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D36/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('Joining',mm)
                            

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 59:
                            L37.append(DistanceToSigHead)
                            D37 = max (L37)
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('len1',len(L37))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1

                            if len(L37) > 0:
                                k= max(min(round(D37/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D37/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 90:
                            L38.append(DistanceToSigHead)
                            D38 = max (L38)
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('len1',len(L38))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            

                            if len(L38) > 0:
                                k= max(min(round(D38/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D38/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('Joining',mm)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 66:
                            L39.append(DistanceToSigHead)
                            D39 = max (L39)
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('len1',len(L39))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1

                            if len(L39) > 0:
                                k= max(min(round(D39/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D39/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('Joining',mm)









                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 60:
                            L40.append(DistanceToSigHead)
                            D40 = max (L40)
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('len1',len(L40))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1

                            if len(L40) > 0:
                                k= max(min(round(D40/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D40/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 92:
                            L41.append(DistanceToSigHead)
                            D41 = max (L41)
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('len1',len(L41))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1

                            if len(L41) > 0:
                                k= max(min(round(D41/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D41/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 71:
                            L42.append(DistanceToSigHead)
                            D42 = max (L42)
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('len1',len(L42))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1

                            if len(L42) > 0:
                                k= max(min(round(D42/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D42/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 93:
                            L43.append(DistanceToSigHead)
                            D43 = max (L43)
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('len1',len(L43))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1

                            if len(L43) > 0:
                                k= max(min(round(D43/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D43/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('Joining',mm)







                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 72:
                            L44.append(DistanceToSigHead)
                            D44 = max (L44)
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('len1',len(L44))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1

                            if len(L44) > 0:
                                k= max(min(round(D44/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D44/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 62:
                            L45.append(DistanceToSigHead)
                            D45 = max (L45)
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('len1',len(L45))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1

                            if len(L45) > 0:
                                k= max(min(round(D45/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D45/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 73:
                            L46.append(DistanceToSigHead)
                            D46 = max (L46)
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('len1',len(L46))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1

                            if len(L46) > 0:
                                k= max(min(round(D46/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D46/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 83:
                            L47.append(DistanceToSigHead)
                            D47 = max (L47)
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('len1',len(L47))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1

                            if len(L47) > 0:
                                k= max(min(round(D47/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D47/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('Joining',mm)






                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 74:
                            L48.append(DistanceToSigHead)
                            D48 = max (L48)
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('len1',len(L48))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1

                            if len(L48) > 0:
                                k= max(min(round(D48/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D48/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 64:
                            L49.append(DistanceToSigHead)
                            D49 = max (L49)
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('len1',len(L49))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            if len(L49) > 0:
                                k= max(min(round(D49/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D49/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 104:
                            L50.append(DistanceToSigHead)
                            D50 = max (L50)
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('len1',len(L50))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1

                            if len(L50) > 0:
                                k= max(min(round(D50/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D50/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 105:
                            L51.append(DistanceToSigHead)
                            D51 = max (L51)
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('len1',len(L51))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1


                            if len(L51) > 0:
                                k= max(min(round(D51/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D51/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('Joining',mm)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 109:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            LL1.append(DistanceToSigHead)
                            D1 = max (LL1)
                            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('len1',len(LL1))
                            if len(LL1) > 0:
                                k= max(min(round(D1/5),50),1)                                
                                sum1 = 0
                                while k <= 50:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.02)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D1/5),50),1)
                                sum2=0
                                while n <= 50:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.02)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('Joining',mm)
                                

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 91:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            LL2.append(DistanceToSigHead)
                            D2 = max (LL2)
                            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('len1',len(LL2))
                            if len(LL2) > 0:
                                k= max(min(round(D2/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D2/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('Joining',mm)
                                



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 89:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            LL3.append(DistanceToSigHead)
                            D3 = max (LL3)
                            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('len1',len(LL3))
                            if len(LL3) > 0:
                                k= max(min(round(D3/5),10),1)                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D3/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 100:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            LL4.append(DistanceToSigHead)
                            D4 = max (LL4)
                            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('len1',len(LL4))
                            if len(LL4) > 0:
                                k= max(min(round(D4/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D4/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('Joining',mm)












                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 108:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            LL5.append(DistanceToSigHead)
                            D5 = max (LL5)
                            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('len1',len(LL5))
                            if len(LL5) > 0:
                                k= max(min(round(D5/5),50),1)                                
                                sum1 = 0
                                while k <= 50:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.02)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D5/5),50),1)
                                sum2=0
                                while n <= 50:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.02)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('Joining',mm)
                                

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 98:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            LL6.append(DistanceToSigHead)
                            D6 = max (LL6)
                            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('len1',len(LL6))
                            if len(LL6) > 0:
                                k= max(min(round(D6/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D6/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('Joining',mm)
                                



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 88:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            LL7.append(DistanceToSigHead)
                            D7 = max (LL7)
                            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('len1',len(LL7))
                            if len(LL7) > 0:
                                k= max(min(round(D7/5),10),1)                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D7/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 103:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            LL8.append(DistanceToSigHead)
                            D8 = max (LL8)
                            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('len1',len(LL8))
                            if len(LL8) > 0:
                                k= max(min(round(D8/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D8/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('Joining',mm)





                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 112:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            LL9.append(DistanceToSigHead)
                            D9 = max (LL9)
                            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('len1',len(LL9))
                            if len(LL9) > 0:
                                k= max(min(round(D9/5),50),1)                                
                                sum1 = 0
                                while k <= 50:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.02)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D9/5),50),1)
                                sum2=0
                                while n <= 50:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.02)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('Joining',mm)


                                

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 101:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            LL10.append(DistanceToSigHead)
                            D10 = max (LL10)
                            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('len1',len(LL10))
                            if len(LL10) > 0:
                                k= max(min(round(D10/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D10/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('Joining',mm)
                                



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 85:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            LL11.append(DistanceToSigHead)
                            D11 = max (LL11)
                            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('len1',len(LL11))
                            if len(LL11) > 0:
                                k= max(min(round(D11/5),10),1)                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D11/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 95:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            LL12.append(DistanceToSigHead)
                            D12 = max (LL12)
                            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('len1',len(LL12))
                            if len(LL12) > 0:
                                k= max(min(round(D12/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D12/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('Joining',mm)





                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 113:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            LL13.append(DistanceToSigHead)
                            D13 = max (LL13)
                            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('len1',len(LL13))
                            if len(LL13) > 0:
                                k= max(min(round(D13/5),50),1)                                
                                sum1 = 0
                                while k <= 50:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.02)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D13/5),50),1)
                                sum2=0
                                while n <= 50:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.02)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('Joining',mm)


                                

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 106:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            LL14.append(DistanceToSigHead)
                            D14 = max (LL14)
                            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('len1',len(LL14))
                            if len(LL14) > 0:
                                k= max(min(round(D14/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D14/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('Joining',mm)
                                



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 84:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            LL15.append(DistanceToSigHead)
                            D15 = max (LL15)
                            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('len1',len(LL15))
                            if len(LL15) > 0:
                                k= max(min(round(D15/5),10),1)                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D15/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 94:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            LL16.append(DistanceToSigHead)
                            D16 = max (LL16)
                            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('len1',len(LL16))
                            if len(LL16) > 0:
                                k= max(min(round(D16/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D16/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('Joining',mm)




                    else:
                        continue




                    if vehAttributes[vehsAttNames['VehType\No']] in vehTypesSpecial:
                        Link = vehAttributes[vehsAttNames['Lane\Link']]
                        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('LinkNo1',Link)
                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 99:
                            S6.append(1)
                            if len(S6)>0:
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 65:
                            S7.append(1)
                            if len(S7) >0:
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)
                     

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 75:
                            S8.append(1)
                            if len(S8) >0:
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)
                            

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 102:
                            S9.append(1)
                            if len(S9) >0:
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 76:
                            S15.append(1)
                            if len(S15) >0:
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 86:
                            S16.append(1)
                            if len(S16) >0:
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 77:
                            S17.append(1)
                            if len(S17) >0:
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 67:
                            S18.append(1)
                            if len(S18) >0:
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 78:
                            S19.append(1)
                            if len(S19) >0:
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 96:
                            S20.append(1)
                            if len(S20) >0:
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 69:
                            S21.append(1)
                            if len(S21) >0:
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 97:
                            S22.append(1)
                            if len(S22) >0:
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 70:
                            S28.append(1)
                            if len(S28) >0:
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 87:
                            S29.append(1)
                            if len(S29) >0:
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 63:
                            S30.append(1)
                            if len(S30) >0:
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 82:
                            S31.append(1)
                            if len(S31) >0:
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 81:
                            S32.append(1)
                            if len(S32) >0:
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 61:
                            S33.append(1)
                            if len(S33) >0:
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 80:
                            S34.append(1)
                            if len(S34) >0:
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 68:
                            S35.append(1)
                            if len(S35) >0:
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 79:
                            S36.append(1)
                            if len(S36) >0:
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 59:
                            S37.append(1)
                            if len(S37) >0:
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 90:
                            S38.append(1)
                            if len(S38) >0:
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 66:
                            S39.append(1)
                            if len(S39) >0:
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 60:
                            S40.append(1)
                            if len(S40) >0:
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)
 
                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 92:
                            S41.append(1)
                            if len(S41) >0:
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 71:
                            S42.append(1)
                            if len(S42) >0:
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 93:
                            S43.append(1)
                            if len(S43) >0:
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 72:
                            S44.append(1)
                            if len(S44) >0:
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 62:
                            S45.append(1)
                            if len(S45) >0:
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 73:
                            S46.append(1)
                            if len(S46) >0:
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 83:
                            S47.append(1)
                            if len(S47) >0:
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 74:
                            S48.append(1)
                            if len(S48) >0:
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 64:
                            S49.append(1)
                            if len(S49) >0:
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 104:
                            S50.append(1)
                            if len(S50) >0:
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 105:
                            S51.append(1)
                            if len(S51) >0:
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)





        if len(LL1) == 0:
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',2)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('len1',0)
            

        if len(LL2) == 0:
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('len1',0)



        if len(LL3) == 0:
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('len1',0)


        if len(LL4) == 0:
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('len1',0)



        if len(LL5) == 0:
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',2)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('len1',0)

        if len(LL6) == 0:
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('len1',0)


        if len(LL7) == 0:
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('len1',0)



        if len(LL8) == 0:
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('len1',0)


        if len(LL9) == 0:
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',2)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('len1',0)


        if len(LL10) == 0:
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('len1',0)


        if len(LL11) == 0:
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('len1',0)


        if len(LL12) == 0:
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('len1',0)


        if len(LL13) == 0:
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',2)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('len1',0)


        if len(LL14) == 0:
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('len1',0)


        if len(LL15) == 0:
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('len1',0)



        if len(LL16) == 0:
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('len1',0)




        if len(L6)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L7)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('Joining',0)



        if len(L8)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('Joining',0)

        if len(L9)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('Joining',0)


        if len(L15)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('Joining',0)


        if len(L16)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('Joining',0)


        if len(L17)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('Joining',0)


        if len(L18)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('Joining',0)





        if len(L19)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L20)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('Joining',0)

        if len(L21)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('Joining',0)


        if len(L22)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('Joining',0)


        if len(L28)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('Joining',0)




        if len(L29)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('Joining',0)



        if len(L30)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('Joining',0)



        if len(L31)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('Joining',0)




        if len(L32)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('Joining',0)


        if len(L33)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('Joining',0)



        if len(L34)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('Joining',0)


        if len(L35)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('Joining',0)



        if len(L36)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('Joining',0)


        if len(L37)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('Joining',0)



        if len(L38)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L39)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('Joining',0)


        if len(L40)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('Joining',0)



        if len(L41)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L42)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('Joining',0)



        if len(L43)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('Joining',0)


        if len(L44)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L45)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('Joining',0)





        if len(L46)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('Joining',0)


        if len(L47)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('Joining',0)



        if len(L48)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L49)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('Joining',0)



        if len(L50)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('Joining',0)


        if len(L51)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('Joining',0)





        if len(S6)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)




        if len(S7)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)




        if len(S8)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)


        if len(S9)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)



        if len(S15)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)



        if len(S16)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)



        if len(S17)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)



        if len(S18)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)






        if len(S19)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)




        if len(S20)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)


        if len(S21)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)



        if len(S22)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)



        if len(S28)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)





        if len(S29)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)




        if len(S30)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)




        if len(S31)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)





        if len(S32)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)



        if len(S33)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)




        if len(S34)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)



        if len(S35)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)




        if len(S36)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)



        if len(S37)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)




        if len(S38)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)




        if len(S39)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)



        if len(S40)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)




        if len(S41)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)




        if len(S42)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)




        if len(S43)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)



        if len(S44)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)




        if len(S45)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)






        if len(S46)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)



        if len(S47)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)




        if len(S48)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)



        if len(S49)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)



        if len(S49)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)




        if len(S50)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)



        if len(S51)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)




        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('SigState') == 'RED':           
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('Joining')))
            kss1= 14-(Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).AttValue('Queuedup'))
            kss2= 17- (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).AttValue('Queuedup'))
            kss3 = 17- (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).AttValue('Queuedup'))
            kss4= min(kss1,kss2,kss3)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('CurrentSupply',3 * kss4)

            
        else:
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('Joining')))





        if Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('SigState') == 'RED':           
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('Joining')))
            kss11= 14-(Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).AttValue('Queuedup'))
            kss22= 17- (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).AttValue('Queuedup'))
            kss33 = 17- (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).AttValue('Queuedup'))
            kss44= min(kss11,kss22,kss33)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('CurrentSupply',3 * kss44)

        else:
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('Joining')))






        if Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('SigState') == 'RED':           
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('Joining')))
            kss111= 14-(Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss222= 17- (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss333 = 17- (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss444= min(kss111,kss222,kss333)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('CurrentSupply',3 * kss444)

        else:
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('Joining')))




        if Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('SigState') == 'RED':           
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('Joining')))
            kss1111= 14-(Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss2222= 17- (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss3333 = 17- (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss4444= min(kss1111,kss2222,kss3333)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('CurrentSupply',3 * kss4444)

        else:
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('Joining')))



        GreenTimes = []
        i= GreenMinI2
        while i <= GreenMaxI2:
            GreenTimes.append(i)
            i=i+5


        GreenTimes1 = []
        GreenDemand1 = []
        for i in range(len(GreenTimes)):
            if GreenTimes[i] <= (Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('CurrentSupply')/St2):
                GreenTimes1.append(GreenTimes[i])
                GreenDemand1.append(round(GreenTimes[i]*(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue('ArrivalRate'))))
        if len(GreenTimes1)==0:
            GreenTimes1.append(GreenMinI2)
            GreenDemand1.append(round(GreenMinI2*(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue('ArrivalRate'))))

        GreenTimes11 = []
        GreenDemand11 = []        
        for i in range(len(GreenTimes1)):
            GreenTimes11.append(CLength-GreenTimes1[i])
            GreenDemand11.append(round((CLength-GreenTimes1[i]-6)*(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue('ArrivalRate')+ Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue('ArrivalRate')+Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue('ArrivalRate'))))
                
        GreenTimes5 = []
        GreenDemand5 = []  
        for i in range(len(GreenTimes)):
            if GreenTimes[i] <= (Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('CurrentSupply')/St):
                GreenTimes5.append(GreenTimes[i])
                GreenDemand5.append(round(GreenTimes[i]*(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue('ArrivalRate'))))

        if len(GreenTimes5)==0:
            GreenTimes5.append(GreenMinI2)
            GreenDemand5.append(round(GreenMinI2*(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue('ArrivalRate'))))

        GreenDemand51 = []  
        GreenTimes51 = []
        for i in range(len(GreenTimes5)):
            GreenTimes51.append(CLength-GreenTimes5[i])
            GreenDemand51.append(round((CLength-GreenTimes5[i]-6)*(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue('ArrivalRate')+ Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue('ArrivalRate')+Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue('ArrivalRate'))))


        GreenTimes12 = []
        GreenDemand12 = [] 
        for i in range(len(GreenTimes)):
            if GreenTimes[i] <= (Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('CurrentSupply')/St):
                GreenTimes12.append(GreenTimes[i])
                GreenDemand12.append(round(GreenTimes[i]*(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue('ArrivalRate'))))

        if len(GreenTimes12)==0:
            GreenTimes12.append(GreenMinI2)
            GreenDemand12.append(round(GreenMinI2*(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue('ArrivalRate'))))


        GreenTimes121 = []
        GreenDemand121 = []
        for i in range(len(GreenTimes12)): 
            GreenTimes121.append(CLength-GreenTimes12[i])
            GreenDemand121.append(round((CLength-GreenTimes12[i]-6)*(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue('ArrivalRate')+ Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue('ArrivalRate')+Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue('ArrivalRate'))))





        GreenTimes13 = []
        GreenDemand13 = [] 
        for i in range(len(GreenTimes)):
            if GreenTimes[i] <= (Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('CurrentSupply')/St):
                GreenTimes13.append(GreenTimes[i])
                GreenDemand13.append(round(GreenTimes[i]*(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue('ArrivalRate'))))

        if len(GreenTimes13)==0:
            GreenTimes13.append(GreenMinI2)
            GreenDemand13.append(round(GreenMinI2*(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue('ArrivalRate'))))



        GreenTimes131 = []
        GreenDemand131 = []
        for i in range(len(GreenTimes13)):
            GreenTimes131.append(CLength-GreenTimes13[i])
            GreenDemand131.append(round((CLength-GreenTimes13[i]-6)*(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue('ArrivalRate')+ Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue('ArrivalRate')+Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue('ArrivalRate'))))






        incoming1=[]
        outgoing1=[]
        content1=[]
        for i in range(len(GreenTimes1)):
            in1 = Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('CurrentDemand')+ GreenDemand1[i]
            in2 = GreenTimes1[i] * St2
            in3 = min(in1,in2)
            incoming1.append(in3)
            out1 = Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('CurrentDemand')+ Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('CurrentDemand')+ Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('CurrentDemand')+ GreenDemand11[i]
            out2 = GreenTimes11[i] * St2
            out3 = min(out1,out2)
            outgoing1.append(out3)
            content1.append(in3-out3)



        incoming5=[]
        outgoing5=[]
        content5=[]
        for i in range(len(GreenTimes5)):
            in1 = Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('CurrentDemand')+ GreenDemand5[i]
            in2 = GreenTimes5[i] * St2
            in3 = min(in1,in2)
            incoming5.append(in3)
            out1 = Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('CurrentDemand')+ GreenDemand51[i]
            out2 = GreenTimes51[i] * St2
            out3 = min(out1,out2)
            outgoing5.append(out3)
            content5.append(in3-out3)


        incoming12=[]
        outgoing12=[]
        content12=[]
        for i in range(len(GreenTimes12)):
            in1 = Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('CurrentDemand')+ GreenDemand12[i]
            in2 = GreenTimes12[i] * St2
            in3 = min(in1,in2)
            incoming12.append(in3)
            out1 = Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('CurrentDemand')+ GreenDemand121[i]
            out2 = GreenTimes121[i] * St2
            out3 = min(out1,out2)
            outgoing12.append(out3)
            content12.append(in3-out3)



        incoming13=[]
        outgoing13=[]
        content13=[]
        for i in range(len(GreenTimes13)):
            in1 = Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('CurrentDemand')+ GreenDemand13[i]
            in2 = GreenTimes13[i] * St2
            in3 = min(in1,in2)
            incoming13.append(in3)
            out1 = Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('CurrentDemand')+ GreenDemand131[i]
            out2 = GreenTimes131[i] * St2
            out3 = min(out1,out2)
            outgoing13.append(out3)
            content13.append(in3-out3)

        kk=0
        for x in LinkAttributes:
            kk= kk + x[LinAttNames['Count:Vehs']]
        density = kk  - Vissim.Net.Links.ItemByKey(107).AttValue ('Count:Vehs') - Vissim.Net.Links.ItemByKey(108).AttValue ('Count:Vehs') - Vissim.Net.Links.ItemByKey(109).AttValue ('Count:Vehs')- Vissim.Net.Links.ItemByKey(110).AttValue ('Count:Vehs')- Vissim.Net.Links.ItemByKey(111).AttValue ('Count:Vehs')- Vissim.Net.Links.ItemByKey(112).AttValue ('Count:Vehs')- Vissim.Net.Links.ItemByKey(113).AttValue ('Count:Vehs')-- Vissim.Net.Links.ItemByKey(114).AttValue ('Count:Vehs')

        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue('SystemContent',density)

        scc=[]
        scc2=[]        
        indexes=[]
        mmmm = Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue('SystemContent')
        for i in range(len(content1)):
            for j in range(len(content5)):
                for k in range(len(content12)):
                    for m in range(len(content13)):
                        scc1 = abs(Kq - (mmmm + content1[i] + content5[j] + content12[k] + content13[m]))
                        scc2.append(scc1)
                        indexes.append([i,j,k,m])



        minimals=[]
        indexes2=[]
        for i in range(len(scc2)):
            if scc2[i]== min(scc2):
                minimals.append(scc2[i])
                indexes2.append(indexes[i])

        mor=[]
        for i in range(len(minimals)):
            mo1 = abs(GreenTimes1[indexes2[i][0]]*St-Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('CurrentDemand'))+ abs((CLength-GreenTimes1[indexes2[i][0]])*St-Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('CurrentDemand')) + abs((CLength-GreenTimes1[indexes2[i][0]])*St-Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('CurrentDemand'))+ abs((CLength-GreenTimes1[indexes2[i][0]])*St-Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('CurrentDemand')) + abs(GreenTimes5[indexes2[i][1]]*St-Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('CurrentDemand'))+ abs((CLength - GreenTimes5[indexes2[i][1]])*St-Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('CurrentDemand')) + abs((CLength - GreenTimes5[indexes2[i][1]])*St-Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('CurrentDemand'))+ abs((CLength - GreenTimes5[indexes2[i][1]])*St-Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('CurrentDemand')) +abs(GreenTimes12[indexes2[i][2]]*St-Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('CurrentDemand'))+ abs((CLength - GreenTimes12[indexes2[i][2]])*St-Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('CurrentDemand')) + abs((CLength - GreenTimes12[indexes2[i][2]])*St-Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('CurrentDemand'))+ abs((CLength - GreenTimes12[indexes2[i][2]])*St-Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('CurrentDemand'))+abs(GreenTimes13[indexes2[i][3]]*St-Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('CurrentDemand')) + abs((CLength - GreenTimes13[indexes2[i][3]])*St-Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('CurrentDemand')) + abs((CLength - GreenTimes13[indexes2[i][3]])*St-Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('CurrentDemand'))+ abs((CLength - GreenTimes13[indexes2[i][3]])*St-Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('CurrentDemand'))
            mor.append(mo1)




        finding=[]
        indexes3=[]
        for i in range(len(mor)): 
            if mor[i] == min(mor):
                finding.append(mor[i])
                MG1=GreenTimes1[indexes2[i][0]]
                MG2=GreenTimes5[indexes2[i][1]]
                MG3=GreenTimes12[indexes2[i][2]]
                MG4=GreenTimes13[indexes2[i][3]]
                indexes3.append([indexes2[i][0], indexes2[i][1], indexes2[i][2], indexes2[i][3]])






    
        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+2 > 2:
            koo=max(MG1,2) 
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('GreenTimeDuration',koo)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('GreenTimeDuration',CLength-koo-6)



            
        if Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+2 > 2:
            koo=max(MG2,2)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('GreenTimeDuration',koo)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            kk=0




        if Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+2 > 2:
            koo=max(MG3,2)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('GreenTimeDuration',koo)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('GreenTimeDuration',CLength-koo-6)






        if Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+2 > 2:
            koo=max(MG4,2)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('GreenTimeDuration',koo)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('GreenTimeDuration',CLength-koo-6)        







        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('GreenStart',2)
        ko = Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenStart')
        ko2 = max(ko,2)
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('GreenEnd',ko)
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('GreenEnd',CLength-1)



        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('GreenStart',2)
        ko = Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenStart')
        ko2 = max(ko,2)
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('GreenEnd',ko)
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('GreenEnd',CLength-1)



        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('GreenStart',2)
        ko = Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenStart')
        ko2 = max(ko,2)
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('GreenEnd',ko)
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('GreenEnd',CLength-1)


        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('GreenStart',2)
        ko = Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenStart')
        ko2 = max(ko,2)
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('GreenEnd',ko)
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('GreenEnd',CLength-1)










 




        Aseq=[[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4]]

        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][3]).SetAttValue ('GreenEnd', CLength-1)


        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][3]).SetAttValue ('GreenEnd', CLength-1)


        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][3]).SetAttValue ('GreenEnd', CLength-1)





        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][3]).SetAttValue ('GreenEnd', CLength-1)




        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][3]).SetAttValue ('GreenEnd', CLength-1)



        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][3]).SetAttValue ('GreenEnd', CLength-1)




        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][3]).SetAttValue ('GreenEnd', CLength-1)



        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][3]).SetAttValue ('GreenEnd', CLength-1)





        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][3]).SetAttValue ('GreenEnd', CLength-1)






















#second time step
    if Seconds>=9 and Seconds<=10:



        L1=[]
        L2=[]
        L3=[]
        L4=[]
        L5=[]
        L6=[]
        L7=[]
        L8=[]
        L9=[]
        L10=[]
        L11=[]
        L12=[]
        L13=[]
        L14=[]
        L15=[]
        L16=[]
        L17=[]
        L18=[]
        L19=[]
        L20=[]
        L21=[]
        L22=[]
        L23=[]
        L24=[]
        L25=[]
        L26=[]
        L27=[]
        L28=[]
        L29=[]
        L30=[]
        L31=[]
        L32=[]
        L33=[]
        L34=[]
        L35=[]
        L36=[]
        L37=[]
        L38=[]
        L39=[]
        L40=[]
        L41=[]
        L42=[]
        L43=[]
        L44=[]
        L45=[]
        L46=[]
        L47=[]
        L48=[]
        L49=[]
        L50=[]
        L51=[]
        L52=[]
        L53=[]
        L54=[]
        L55=[]
        L56=[]
        LL1=[]
        LL2=[]
        LL3=[]
        LL4=[]
        LL5=[]
        LL6=[]
        LL7=[]
        LL8=[]
        LL9=[]
        LL10=[]
        LL11=[]
        LL12=[]
        LL13=[]
        LL14=[]
        LL15=[]
        LL16=[]
        S1=[]
        S2=[]
        S3=[]
        S4=[]
        S5=[]
        S6=[]
        S7=[]
        S8=[]
        S9=[]
        S10=[]
        S11=[]
        S12=[]
        S13=[]
        S14=[]
        S15=[]
        S16=[]
        S17=[]
        S18=[]
        S19=[]
        S20=[]
        S21=[]
        S22=[]
        S23=[]
        S24=[]
        S25=[]
        S26=[]
        S27=[]
        S28=[]
        S29=[]
        S30=[]
        S31=[]
        S32=[]
        S33=[]
        S34=[]
        S35=[]
        S36=[]
        S37=[]
        S38=[]
        S39=[]
        S40=[]
        S41=[]
        S42=[]
        S43=[]
        S44=[]
        S45=[]
        S46=[]
        S47=[]
        S48=[]
        S49=[]
        S50=[]
        S51=[]
        S52=[]
        S53=[]
        S54=[]
        S55=[]
        S56=[]

        for vehAttributes in vehsAttributes:
            if vehAttributes[vehsAttNames['VehType\No']] in vehTypesEquipped:       
                if vehAttributes[vehsAttNames['Pos']] != None:
                    InQueue = vehAttributes[vehsAttNames['InQueue']]               
                    if InQueue == True:
                        DistanceToSigHead = vehAttributes[vehsAttNames['DistanceToSigHead']]
                        Link = vehAttributes[vehsAttNames['Lane\Link']]
                        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('LinkNo',Link)
                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 99:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            L6.append(DistanceToSigHead)
                            D6 = max (L6)
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('len1',len(L6))

                            if len(L6) > 0:
                                k= max(min(round(D6/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D6/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('Joining',mm)
                                

                                    
                            

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 65:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            L7.append(DistanceToSigHead)
                            D7 = max (L7)
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('len1',len(L7))

                            if len(L7) > 0:
                                k= max(min(round(D7/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D7/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('Joining',mm)
                                


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 75:
                            
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            L8.append(DistanceToSigHead)
                            D8 = max(L8)
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('len1',len(L8))

                            if len(L8) > 0:
                                k= max(min(round(D8/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D8/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('Joining',mm)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 102:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            L9.append(DistanceToSigHead)
                            D9 = max (L9)
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('len1',len(L9))


                            if len(L9) > 0:
                                k= max(min(round(D9/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D9/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('Joining',mm)







                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 76:
                            L15.append(DistanceToSigHead)
                            D15 = max (L15)
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('len1',len(L15))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1


                            if len(L15) > 0:
                                k= max(min(round(D15/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D15/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('Joining',mm)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 86:
                            L16.append(DistanceToSigHead)
                            D16 = max (L16)
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('len1',len(L16))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            if len(L16) > 0:
                                k= max(min(round(D16/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D16/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 77:
                            L17.append(DistanceToSigHead)
                            D17 = max (L17)
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('len1',len(L17))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            if len(L17) > 0:
                                k= max(min(round(D17/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D17/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 67:
                            L18.append(DistanceToSigHead)
                            D18 = max (L18)
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('len1',len(L18))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            if len(L18) > 0:
                                k= max(min(round(D18/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D18/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('Joining',mm)








                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 78:
                            L19.append(DistanceToSigHead)
                            D19 = max (L19)
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('len1',len(L19))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            if len(L19) > 0:
                                k= max(min(round(D19/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D19/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 96:
                            L20.append(DistanceToSigHead)
                            D20 = max (L20)
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('len1',len(L20))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1

                            if len(L20) > 0:
                                k= max(min(round(D20/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D20/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 69:
                            L21.append(DistanceToSigHead)
                            D21 = max (L21)
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('len1',len(L21))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            if len(L21) > 0:
                                k= max(min(round(D21/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D21/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 97:
                            L22.append(DistanceToSigHead)
                            D22 = max (L22)
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('len1',len(L22))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1

                            if len(L22) > 0:
                                k= max(min(round(D22/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D22/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('Joining',mm)








                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 70:
                            L28.append(DistanceToSigHead)
                            D28 = max (L28)
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('len1',len(L28))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            if len(L28) > 0:
                                k= max(min(round(D28/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D28/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 87:
                            L29.append(DistanceToSigHead)
                            D29 = max (L29)
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('len1',len(L29))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            if len(L29) > 0:
                                k= max(min(round(D29/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D29/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 63:
                            L30.append(DistanceToSigHead)
                            D30 = max (L30)
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('len1',len(L30))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            if len(L30) > 0:
                                k= max(min(round(D30/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D30/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('Joining',mm)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 82:
                            L31.append(DistanceToSigHead)
                            D31 = max (L31)
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('len1',len(L31))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            if len(L31) > 0:
                                k= max(min(round(D31/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D31/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('Joining',mm)





                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 81:
                            L32.append(DistanceToSigHead)
                            D32 = max (L32)
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('len1',len(L32))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1

                            if len(L32) > 0:
                                k= max(min(round(D32/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D32/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 61:
                            L33.append(DistanceToSigHead)
                            D33 = max (L33)
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('len1',len(L33))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1

                            if len(L33) > 0:
                                k= max(min(round(D33/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D33/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 80:
                            L34.append(DistanceToSigHead)
                            D34 = max (L34)
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('len1',len(L34))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1

                            if len(L34) > 0:
                                k= max(min(round(D34/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D34/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 68:
                            L35.append(DistanceToSigHead)
                            D35 = max (L35)
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('len1',len(L35))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1

                            if len(L35) > 0:
                                k= max(min(round(D35/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D35/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('Joining',mm)







                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 79:
                            L36.append(DistanceToSigHead)
                            D36 = max (L36)
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('len1',len(L36))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1

                            if len(L36) > 0:
                                k= max(min(round(D36/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D36/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('Joining',mm)
                            

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 59:
                            L37.append(DistanceToSigHead)
                            D37 = max (L37)
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('len1',len(L37))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1

                            if len(L37) > 0:
                                k= max(min(round(D37/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D37/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 90:
                            L38.append(DistanceToSigHead)
                            D38 = max (L38)
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('len1',len(L38))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            

                            if len(L38) > 0:
                                k= max(min(round(D38/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D38/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('Joining',mm)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 66:
                            L39.append(DistanceToSigHead)
                            D39 = max (L39)
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('len1',len(L39))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1

                            if len(L39) > 0:
                                k= max(min(round(D39/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D39/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('Joining',mm)









                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 60:
                            L40.append(DistanceToSigHead)
                            D40 = max (L40)
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('len1',len(L40))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1

                            if len(L40) > 0:
                                k= max(min(round(D40/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D40/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 92:
                            L41.append(DistanceToSigHead)
                            D41 = max (L41)
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('len1',len(L41))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1

                            if len(L41) > 0:
                                k= max(min(round(D41/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D41/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 71:
                            L42.append(DistanceToSigHead)
                            D42 = max (L42)
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('len1',len(L42))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1

                            if len(L42) > 0:
                                k= max(min(round(D42/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D42/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 93:
                            L43.append(DistanceToSigHead)
                            D43 = max (L43)
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('len1',len(L43))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1

                            if len(L43) > 0:
                                k= max(min(round(D43/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D43/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('Joining',mm)







                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 72:
                            L44.append(DistanceToSigHead)
                            D44 = max (L44)
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('len1',len(L44))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1

                            if len(L44) > 0:
                                k= max(min(round(D44/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D44/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 62:
                            L45.append(DistanceToSigHead)
                            D45 = max (L45)
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('len1',len(L45))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1

                            if len(L45) > 0:
                                k= max(min(round(D45/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D45/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 73:
                            L46.append(DistanceToSigHead)
                            D46 = max (L46)
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('len1',len(L46))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1

                            if len(L46) > 0:
                                k= max(min(round(D46/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D46/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 83:
                            L47.append(DistanceToSigHead)
                            D47 = max (L47)
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('len1',len(L47))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1

                            if len(L47) > 0:
                                k= max(min(round(D47/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D47/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('Joining',mm)






                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 74:
                            L48.append(DistanceToSigHead)
                            D48 = max (L48)
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('len1',len(L48))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1

                            if len(L48) > 0:
                                k= max(min(round(D48/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D48/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 64:
                            L49.append(DistanceToSigHead)
                            D49 = max (L49)
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('len1',len(L49))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            if len(L49) > 0:
                                k= max(min(round(D49/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D49/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 104:
                            L50.append(DistanceToSigHead)
                            D50 = max (L50)
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('len1',len(L50))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1

                            if len(L50) > 0:
                                k= max(min(round(D50/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D50/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 105:
                            L51.append(DistanceToSigHead)
                            D51 = max (L51)
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('len1',len(L51))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1


                            if len(L51) > 0:
                                k= max(min(round(D51/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D51/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('Joining',mm)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 109:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            LL1.append(DistanceToSigHead)
                            D1 = max (LL1)
                            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('len1',len(LL1))
                            if len(LL1) > 0:
                                k= max(min(round(D1/5),50),1)                                
                                sum1 = 0
                                while k <= 50:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.02)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D1/5),50),1)
                                sum2=0
                                while n <= 50:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.02)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('Joining',mm)
                                

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 91:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            LL2.append(DistanceToSigHead)
                            D2 = max (LL2)
                            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('len1',len(LL2))
                            if len(LL2) > 0:
                                k= max(min(round(D2/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D2/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('Joining',mm)
                                



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 89:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            LL3.append(DistanceToSigHead)
                            D3 = max (LL3)
                            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('len1',len(LL3))
                            if len(LL3) > 0:
                                k= max(min(round(D3/5),10),1)                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D3/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 100:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            LL4.append(DistanceToSigHead)
                            D4 = max (LL4)
                            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('len1',len(LL4))
                            if len(LL4) > 0:
                                k= max(min(round(D4/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D4/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('Joining',mm)












                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 108:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            LL5.append(DistanceToSigHead)
                            D5 = max (LL5)
                            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('len1',len(LL5))
                            if len(LL5) > 0:
                                k= max(min(round(D5/5),50),1)                                
                                sum1 = 0
                                while k <= 50:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.02)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D5/5),50),1)
                                sum2=0
                                while n <= 50:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.02)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('Joining',mm)
                                

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 98:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            LL6.append(DistanceToSigHead)
                            D6 = max (LL6)
                            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('len1',len(LL6))
                            if len(LL6) > 0:
                                k= max(min(round(D6/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D6/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('Joining',mm)
                                



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 88:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            LL7.append(DistanceToSigHead)
                            D7 = max (LL7)
                            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('len1',len(LL7))
                            if len(LL7) > 0:
                                k= max(min(round(D7/5),10),1)                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D7/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 103:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            LL8.append(DistanceToSigHead)
                            D8 = max (LL8)
                            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('len1',len(LL8))
                            if len(LL8) > 0:
                                k= max(min(round(D8/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D8/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('Joining',mm)





                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 112:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            LL9.append(DistanceToSigHead)
                            D9 = max (LL9)
                            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('len1',len(LL9))
                            if len(LL9) > 0:
                                k= max(min(round(D9/5),50),1)                                
                                sum1 = 0
                                while k <= 50:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.02)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D9/5),50),1)
                                sum2=0
                                while n <= 50:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.02)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('Joining',mm)


                                

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 101:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            LL10.append(DistanceToSigHead)
                            D10 = max (LL10)
                            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('len1',len(LL10))
                            if len(LL10) > 0:
                                k= max(min(round(D10/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D10/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('Joining',mm)
                                



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 85:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            LL11.append(DistanceToSigHead)
                            D11 = max (LL11)
                            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('len1',len(LL11))
                            if len(LL11) > 0:
                                k= max(min(round(D11/5),10),1)                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D11/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 95:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            LL12.append(DistanceToSigHead)
                            D12 = max (LL12)
                            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('len1',len(LL12))
                            if len(LL12) > 0:
                                k= max(min(round(D12/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D12/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('Joining',mm)





                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 113:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            LL13.append(DistanceToSigHead)
                            D13 = max (LL13)
                            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('len1',len(LL13))
                            if len(LL13) > 0:
                                k= max(min(round(D13/5),50),1)                                
                                sum1 = 0
                                while k <= 50:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.02)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D13/5),50),1)
                                sum2=0
                                while n <= 50:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.02)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('Joining',mm)


                                

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 106:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            LL14.append(DistanceToSigHead)
                            D14 = max (LL14)
                            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('len1',len(LL14))
                            if len(LL14) > 0:
                                k= max(min(round(D14/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D14/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('Joining',mm)
                                



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 84:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            LL15.append(DistanceToSigHead)
                            D15 = max (LL15)
                            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('len1',len(LL15))
                            if len(LL15) > 0:
                                k= max(min(round(D15/5),10),1)                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D15/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 94:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            LL16.append(DistanceToSigHead)
                            D16 = max (LL16)
                            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('len1',len(LL16))
                            if len(LL16) > 0:
                                k= max(min(round(D16/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D16/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('Joining',mm)




                    else:
                        continue




                    if vehAttributes[vehsAttNames['VehType\No']] in vehTypesSpecial:
                        Link = vehAttributes[vehsAttNames['Lane\Link']]
                        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('LinkNo1',Link)
                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 99:
                            S6.append(1)
                            if len(S6)>0:
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 65:
                            S7.append(1)
                            if len(S7) >0:
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)
                     

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 75:
                            S8.append(1)
                            if len(S8) >0:
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)
                            

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 102:
                            S9.append(1)
                            if len(S9) >0:
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 76:
                            S15.append(1)
                            if len(S15) >0:
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 86:
                            S16.append(1)
                            if len(S16) >0:
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 77:
                            S17.append(1)
                            if len(S17) >0:
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 67:
                            S18.append(1)
                            if len(S18) >0:
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 78:
                            S19.append(1)
                            if len(S19) >0:
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 96:
                            S20.append(1)
                            if len(S20) >0:
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 69:
                            S21.append(1)
                            if len(S21) >0:
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 97:
                            S22.append(1)
                            if len(S22) >0:
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 70:
                            S28.append(1)
                            if len(S28) >0:
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 87:
                            S29.append(1)
                            if len(S29) >0:
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 63:
                            S30.append(1)
                            if len(S30) >0:
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 82:
                            S31.append(1)
                            if len(S31) >0:
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 81:
                            S32.append(1)
                            if len(S32) >0:
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 61:
                            S33.append(1)
                            if len(S33) >0:
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 80:
                            S34.append(1)
                            if len(S34) >0:
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 68:
                            S35.append(1)
                            if len(S35) >0:
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 79:
                            S36.append(1)
                            if len(S36) >0:
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 59:
                            S37.append(1)
                            if len(S37) >0:
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 90:
                            S38.append(1)
                            if len(S38) >0:
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 66:
                            S39.append(1)
                            if len(S39) >0:
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 60:
                            S40.append(1)
                            if len(S40) >0:
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)
 
                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 92:
                            S41.append(1)
                            if len(S41) >0:
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 71:
                            S42.append(1)
                            if len(S42) >0:
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 93:
                            S43.append(1)
                            if len(S43) >0:
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 72:
                            S44.append(1)
                            if len(S44) >0:
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 62:
                            S45.append(1)
                            if len(S45) >0:
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 73:
                            S46.append(1)
                            if len(S46) >0:
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 83:
                            S47.append(1)
                            if len(S47) >0:
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 74:
                            S48.append(1)
                            if len(S48) >0:
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 64:
                            S49.append(1)
                            if len(S49) >0:
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 104:
                            S50.append(1)
                            if len(S50) >0:
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 105:
                            S51.append(1)
                            if len(S51) >0:
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)





        if len(LL1) == 0:
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',2)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('len1',0)
            

        if len(LL2) == 0:
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('len1',0)



        if len(LL3) == 0:
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('len1',0)


        if len(LL4) == 0:
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('len1',0)



        if len(LL5) == 0:
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',2)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('len1',0)

        if len(LL6) == 0:
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('len1',0)


        if len(LL7) == 0:
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('len1',0)



        if len(LL8) == 0:
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('len1',0)


        if len(LL9) == 0:
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',2)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('len1',0)


        if len(LL10) == 0:
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('len1',0)


        if len(LL11) == 0:
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('len1',0)


        if len(LL12) == 0:
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('len1',0)


        if len(LL13) == 0:
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',2)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('len1',0)


        if len(LL14) == 0:
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('len1',0)


        if len(LL15) == 0:
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('len1',0)



        if len(LL16) == 0:
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('len1',0)




        if len(L6)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L7)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('Joining',0)



        if len(L8)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('Joining',0)

        if len(L9)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('Joining',0)


        if len(L15)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('Joining',0)


        if len(L16)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('Joining',0)


        if len(L17)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('Joining',0)


        if len(L18)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('Joining',0)





        if len(L19)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L20)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('Joining',0)

        if len(L21)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('Joining',0)


        if len(L22)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('Joining',0)


        if len(L28)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('Joining',0)




        if len(L29)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('Joining',0)



        if len(L30)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('Joining',0)



        if len(L31)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('Joining',0)




        if len(L32)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('Joining',0)


        if len(L33)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('Joining',0)



        if len(L34)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('Joining',0)


        if len(L35)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('Joining',0)



        if len(L36)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('Joining',0)


        if len(L37)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('Joining',0)



        if len(L38)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L39)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('Joining',0)


        if len(L40)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('Joining',0)



        if len(L41)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L42)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('Joining',0)



        if len(L43)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('Joining',0)


        if len(L44)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L45)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('Joining',0)





        if len(L46)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('Joining',0)


        if len(L47)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('Joining',0)



        if len(L48)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L49)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('Joining',0)



        if len(L50)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('Joining',0)


        if len(L51)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('Joining',0)





        if len(S6)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)




        if len(S7)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)




        if len(S8)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)


        if len(S9)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)



        if len(S15)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)



        if len(S16)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)



        if len(S17)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)



        if len(S18)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)






        if len(S19)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)




        if len(S20)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)


        if len(S21)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)



        if len(S22)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)



        if len(S28)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)





        if len(S29)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)




        if len(S30)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)




        if len(S31)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)





        if len(S32)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)



        if len(S33)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)




        if len(S34)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)



        if len(S35)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)




        if len(S36)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)



        if len(S37)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)




        if len(S38)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)




        if len(S39)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)



        if len(S40)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)




        if len(S41)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)




        if len(S42)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)




        if len(S43)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)



        if len(S44)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)




        if len(S45)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)






        if len(S46)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)



        if len(S47)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)




        if len(S48)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)



        if len(S49)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)



        if len(S49)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)




        if len(S50)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)



        if len(S51)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)




        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('SigState') == 'RED':           
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('Joining')))
            kss1= 14-(Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).AttValue('Queuedup'))
            kss2= 17- (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).AttValue('Queuedup'))
            kss3 = 17- (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).AttValue('Queuedup'))
            kss4= min(kss1,kss2,kss3)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('CurrentSupply',3 * kss4)

            
        else:
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('Joining')))





        if Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('SigState') == 'RED':           
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('Joining')))
            kss11= 14-(Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).AttValue('Queuedup'))
            kss22= 17- (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).AttValue('Queuedup'))
            kss33 = 17- (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).AttValue('Queuedup'))
            kss44= min(kss11,kss22,kss33)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('CurrentSupply',3 * kss44)

        else:
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('Joining')))






        if Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('SigState') == 'RED':           
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('Joining')))
            kss111= 14-(Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss222= 17- (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss333 = 17- (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss444= min(kss111,kss222,kss333)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('CurrentSupply',3 * kss444)

        else:
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('Joining')))




        if Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('SigState') == 'RED':           
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('Joining')))
            kss1111= 14-(Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss2222= 17- (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss3333 = 17- (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss4444= min(kss1111,kss2222,kss3333)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('CurrentSupply',3 * kss4444)

        else:
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('Joining')))

        Aseq=[[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4]]





        GreenTimes = []
        i= GreenMinI2
        while i <= GreenMaxI2:
            GreenTimes.append(i)
            i=i+5


        GreenTimes1 = []
        GreenDemand1 = []
        for i in range(len(GreenTimes)):
            if GreenTimes[i] <= (Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('CurrentSupply')/St2):
                GreenTimes1.append(GreenTimes[i])
                GreenDemand1.append(round(GreenTimes[i]*(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue('ArrivalRate'))))
        if len(GreenTimes1)==0:
            GreenTimes1.append(GreenMinI2)
            GreenDemand1.append(round(GreenMinI2*(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue('ArrivalRate'))))

        GreenTimes11 = []
        GreenDemand11 = []        
        for i in range(len(GreenTimes1)):
            GreenTimes11.append(CLength-GreenTimes1[i])
            GreenDemand11.append(round((CLength-GreenTimes1[i]-6)*(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue('ArrivalRate')+ Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue('ArrivalRate')+Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue('ArrivalRate'))))
                
        GreenTimes5 = []
        GreenDemand5 = []  
        for i in range(len(GreenTimes)):
            if GreenTimes[i] <= (Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('CurrentSupply')/St):
                GreenTimes5.append(GreenTimes[i])
                GreenDemand5.append(round(GreenTimes[i]*(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue('ArrivalRate'))))

        if len(GreenTimes5)==0:
            GreenTimes5.append(GreenMinI2)
            GreenDemand5.append(round(GreenMinI2*(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue('ArrivalRate'))))

        GreenDemand51 = []  
        GreenTimes51 = []
        for i in range(len(GreenTimes5)):
            GreenTimes51.append(CLength-GreenTimes5[i])
            GreenDemand51.append(round((CLength-GreenTimes5[i]-6)*(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue('ArrivalRate')+ Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue('ArrivalRate')+Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue('ArrivalRate'))))


        GreenTimes12 = []
        GreenDemand12 = [] 
        for i in range(len(GreenTimes)):
            if GreenTimes[i] <= (Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('CurrentSupply')/St):
                GreenTimes12.append(GreenTimes[i])
                GreenDemand12.append(round(GreenTimes[i]*(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue('ArrivalRate'))))

        if len(GreenTimes12)==0:
            GreenTimes12.append(GreenMinI2)
            GreenDemand12.append(round(GreenMinI2*(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue('ArrivalRate'))))


        GreenTimes121 = []
        GreenDemand121 = []
        for i in range(len(GreenTimes12)): 
            GreenTimes121.append(CLength-GreenTimes12[i])
            GreenDemand121.append(round((CLength-GreenTimes12[i]-6)*(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue('ArrivalRate')+ Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue('ArrivalRate')+Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue('ArrivalRate'))))





        GreenTimes13 = []
        GreenDemand13 = [] 
        for i in range(len(GreenTimes)):
            if GreenTimes[i] <= (Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('CurrentSupply')/St):
                GreenTimes13.append(GreenTimes[i])
                GreenDemand13.append(round(GreenTimes[i]*(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue('ArrivalRate'))))

        if len(GreenTimes13)==0:
            GreenTimes13.append(GreenMinI2)
            GreenDemand13.append(round(GreenMinI2*(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue('ArrivalRate'))))



        GreenTimes131 = []
        GreenDemand131 = []
        for i in range(len(GreenTimes13)):
            GreenTimes131.append(CLength-GreenTimes13[i])
            GreenDemand131.append(round((CLength-GreenTimes13[i]-6)*(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue('ArrivalRate')+ Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue('ArrivalRate')+Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue('ArrivalRate'))))






        incoming1=[]
        outgoing1=[]
        content1=[]
        for i in range(len(GreenTimes1)):
            in1 = Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('CurrentDemand')+ GreenDemand1[i]
            in2 = GreenTimes1[i] * St2
            in3 = min(in1,in2)
            incoming1.append(in3)
            out1 = Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('CurrentDemand')+ Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('CurrentDemand')+ Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('CurrentDemand')+ GreenDemand11[i]
            out2 = GreenTimes11[i] * St2
            out3 = min(out1,out2)
            outgoing1.append(out3)
            content1.append(in3-out3)



        incoming5=[]
        outgoing5=[]
        content5=[]
        for i in range(len(GreenTimes5)):
            in1 = Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('CurrentDemand')+ GreenDemand5[i]
            in2 = GreenTimes5[i] * St2
            in3 = min(in1,in2)
            incoming5.append(in3)
            out1 = Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('CurrentDemand')+ GreenDemand51[i]
            out2 = GreenTimes51[i] * St2
            out3 = min(out1,out2)
            outgoing5.append(out3)
            content5.append(in3-out3)


        incoming12=[]
        outgoing12=[]
        content12=[]
        for i in range(len(GreenTimes12)):
            in1 = Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('CurrentDemand')+ GreenDemand12[i]
            in2 = GreenTimes12[i] * St2
            in3 = min(in1,in2)
            incoming12.append(in3)
            out1 = Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('CurrentDemand')+ GreenDemand121[i]
            out2 = GreenTimes121[i] * St2
            out3 = min(out1,out2)
            outgoing12.append(out3)
            content12.append(in3-out3)



        incoming13=[]
        outgoing13=[]
        content13=[]
        for i in range(len(GreenTimes13)):
            in1 = Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('CurrentDemand')+ GreenDemand13[i]
            in2 = GreenTimes13[i] * St2
            in3 = min(in1,in2)
            incoming13.append(in3)
            out1 = Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('CurrentDemand')+ GreenDemand131[i]
            out2 = GreenTimes131[i] * St2
            out3 = min(out1,out2)
            outgoing13.append(out3)
            content13.append(in3-out3)

        kk=0
        for x in LinkAttributes:
            kk= kk + x[LinAttNames['Count:Vehs']]
        density = kk  - Vissim.Net.Links.ItemByKey(107).AttValue ('Count:Vehs') - Vissim.Net.Links.ItemByKey(108).AttValue ('Count:Vehs') - Vissim.Net.Links.ItemByKey(109).AttValue ('Count:Vehs')- Vissim.Net.Links.ItemByKey(110).AttValue ('Count:Vehs')- Vissim.Net.Links.ItemByKey(111).AttValue ('Count:Vehs')- Vissim.Net.Links.ItemByKey(112).AttValue ('Count:Vehs')- Vissim.Net.Links.ItemByKey(113).AttValue ('Count:Vehs')-- Vissim.Net.Links.ItemByKey(114).AttValue ('Count:Vehs')

        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue('SystemContent',density)

        scc=[]
        scc2=[]        
        indexes=[]
        mmmm = Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue('SystemContent')
        for i in range(len(content1)):
            for j in range(len(content5)):
                for k in range(len(content12)):
                    for m in range(len(content13)):
                        scc1 = abs(Kq - (mmmm + content1[i] + content5[j] + content12[k] + content13[m]))
                        scc2.append(scc1)
                        indexes.append([i,j,k,m])



        minimals=[]
        indexes2=[]
        for i in range(len(scc2)):
            if scc2[i]== min(scc2):
                minimals.append(scc2[i])
                indexes2.append(indexes[i])

        mor=[]
        for i in range(len(minimals)):
            mo1 = abs(GreenTimes1[indexes2[i][0]]*St-Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('CurrentDemand'))+ abs((CLength-GreenTimes1[indexes2[i][0]])*St-Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('CurrentDemand')) + abs((CLength-GreenTimes1[indexes2[i][0]])*St-Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('CurrentDemand'))+ abs((CLength-GreenTimes1[indexes2[i][0]])*St-Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('CurrentDemand')) + abs(GreenTimes5[indexes2[i][1]]*St-Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('CurrentDemand'))+ abs((CLength - GreenTimes5[indexes2[i][1]])*St-Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('CurrentDemand')) + abs((CLength - GreenTimes5[indexes2[i][1]])*St-Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('CurrentDemand'))+ abs((CLength - GreenTimes5[indexes2[i][1]])*St-Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('CurrentDemand')) +abs(GreenTimes12[indexes2[i][2]]*St-Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('CurrentDemand'))+ abs((CLength - GreenTimes12[indexes2[i][2]])*St-Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('CurrentDemand')) + abs((CLength - GreenTimes12[indexes2[i][2]])*St-Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('CurrentDemand'))+ abs((CLength - GreenTimes12[indexes2[i][2]])*St-Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('CurrentDemand'))+abs(GreenTimes13[indexes2[i][3]]*St-Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('CurrentDemand')) + abs((CLength - GreenTimes13[indexes2[i][3]])*St-Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('CurrentDemand')) + abs((CLength - GreenTimes13[indexes2[i][3]])*St-Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('CurrentDemand'))+ abs((CLength - GreenTimes13[indexes2[i][3]])*St-Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('CurrentDemand'))
            mor.append(mo1)




        finding=[]
        indexes3=[]
        for i in range(len(mor)): 
            if mor[i] == min(mor):
                finding.append(mor[i])
                MG1=GreenTimes1[indexes2[i][0]]
                MG2=GreenTimes5[indexes2[i][1]]
                MG3=GreenTimes12[indexes2[i][2]]
                MG4=GreenTimes13[indexes2[i][3]]
                indexes3.append([indexes2[i][0], indexes2[i][1], indexes2[i][2], indexes2[i][3]])






    
        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+2 > 12:
            koo=max(MG1,12) 
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('GreenTimeDuration',koo)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('GreenTimeDuration',CLength-koo-6)



            
        if Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+2 > 12:
            koo=max(MG2,12)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('GreenTimeDuration',koo)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            kk=0




        if Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+2 > 12:
            koo=max(MG3,12)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('GreenTimeDuration',koo)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('GreenTimeDuration',CLength-koo-6)






        if Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+2 > 12:
            koo=max(MG4,12)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('GreenTimeDuration',koo)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('GreenTimeDuration',CLength-koo-6)        







        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('GreenStart',2)
        ko = Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenStart')
        ko2 = max(ko,12)
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('GreenEnd',ko)
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('GreenEnd',CLength-1)



        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('GreenStart',2)
        ko = Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenStart')
        ko2 = max(ko,12)
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('GreenEnd',ko)
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('GreenEnd',CLength-1)



        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('GreenStart',2)
        ko = Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenStart')
        ko2 = max(ko,12)
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('GreenEnd',ko)
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('GreenEnd',CLength-1)


        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('GreenStart',2)
        ko = Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenStart')
        ko2 = max(ko,12)
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('GreenEnd',ko)
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('GreenEnd',CLength-1)










        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][3]).SetAttValue ('GreenEnd', CLength-1)


        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][3]).SetAttValue ('GreenEnd', CLength-1)


        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][3]).SetAttValue ('GreenEnd', CLength-1)





        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][3]).SetAttValue ('GreenEnd', CLength-1)




        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][3]).SetAttValue ('GreenEnd', CLength-1)



        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][3]).SetAttValue ('GreenEnd', CLength-1)




        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][3]).SetAttValue ('GreenEnd', CLength-1)



        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][3]).SetAttValue ('GreenEnd', CLength-1)





        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][3]).SetAttValue ('GreenEnd', CLength-1)
























#third time step
    if Seconds>=19 and Seconds<=20:

        L1=[]
        L2=[]
        L3=[]
        L4=[]
        L5=[]
        L6=[]
        L7=[]
        L8=[]
        L9=[]
        L10=[]
        L11=[]
        L12=[]
        L13=[]
        L14=[]
        L15=[]
        L16=[]
        L17=[]
        L18=[]
        L19=[]
        L20=[]
        L21=[]
        L22=[]
        L23=[]
        L24=[]
        L25=[]
        L26=[]
        L27=[]
        L28=[]
        L29=[]
        L30=[]
        L31=[]
        L32=[]
        L33=[]
        L34=[]
        L35=[]
        L36=[]
        L37=[]
        L38=[]
        L39=[]
        L40=[]
        L41=[]
        L42=[]
        L43=[]
        L44=[]
        L45=[]
        L46=[]
        L47=[]
        L48=[]
        L49=[]
        L50=[]
        L51=[]
        L52=[]
        L53=[]
        L54=[]
        L55=[]
        L56=[]
        LL1=[]
        LL2=[]
        LL3=[]
        LL4=[]
        LL5=[]
        LL6=[]
        LL7=[]
        LL8=[]
        LL9=[]
        LL10=[]
        LL11=[]
        LL12=[]
        LL13=[]
        LL14=[]
        LL15=[]
        LL16=[]
        S1=[]
        S2=[]
        S3=[]
        S4=[]
        S5=[]
        S6=[]
        S7=[]
        S8=[]
        S9=[]
        S10=[]
        S11=[]
        S12=[]
        S13=[]
        S14=[]
        S15=[]
        S16=[]
        S17=[]
        S18=[]
        S19=[]
        S20=[]
        S21=[]
        S22=[]
        S23=[]
        S24=[]
        S25=[]
        S26=[]
        S27=[]
        S28=[]
        S29=[]
        S30=[]
        S31=[]
        S32=[]
        S33=[]
        S34=[]
        S35=[]
        S36=[]
        S37=[]
        S38=[]
        S39=[]
        S40=[]
        S41=[]
        S42=[]
        S43=[]
        S44=[]
        S45=[]
        S46=[]
        S47=[]
        S48=[]
        S49=[]
        S50=[]
        S51=[]
        S52=[]
        S53=[]
        S54=[]
        S55=[]
        S56=[]

        for vehAttributes in vehsAttributes:
            if vehAttributes[vehsAttNames['VehType\No']] in vehTypesEquipped:       
                if vehAttributes[vehsAttNames['Pos']] != None:
                    InQueue = vehAttributes[vehsAttNames['InQueue']]               
                    if InQueue == True:
                        DistanceToSigHead = vehAttributes[vehsAttNames['DistanceToSigHead']]
                        Link = vehAttributes[vehsAttNames['Lane\Link']]
                        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('LinkNo',Link)
                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 99:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            L6.append(DistanceToSigHead)
                            D6 = max (L6)
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('len1',len(L6))

                            if len(L6) > 0:
                                k= max(min(round(D6/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D6/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('Joining',mm)
                                

                                    
                            

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 65:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            L7.append(DistanceToSigHead)
                            D7 = max (L7)
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('len1',len(L7))

                            if len(L7) > 0:
                                k= max(min(round(D7/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D7/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('Joining',mm)
                                


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 75:
                            
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            L8.append(DistanceToSigHead)
                            D8 = max(L8)
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('len1',len(L8))

                            if len(L8) > 0:
                                k= max(min(round(D8/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D8/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('Joining',mm)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 102:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            L9.append(DistanceToSigHead)
                            D9 = max (L9)
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('len1',len(L9))


                            if len(L9) > 0:
                                k= max(min(round(D9/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D9/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('Joining',mm)







                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 76:
                            L15.append(DistanceToSigHead)
                            D15 = max (L15)
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('len1',len(L15))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1


                            if len(L15) > 0:
                                k= max(min(round(D15/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D15/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('Joining',mm)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 86:
                            L16.append(DistanceToSigHead)
                            D16 = max (L16)
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('len1',len(L16))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            if len(L16) > 0:
                                k= max(min(round(D16/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D16/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 77:
                            L17.append(DistanceToSigHead)
                            D17 = max (L17)
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('len1',len(L17))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            if len(L17) > 0:
                                k= max(min(round(D17/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D17/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 67:
                            L18.append(DistanceToSigHead)
                            D18 = max (L18)
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('len1',len(L18))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            if len(L18) > 0:
                                k= max(min(round(D18/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D18/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('Joining',mm)








                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 78:
                            L19.append(DistanceToSigHead)
                            D19 = max (L19)
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('len1',len(L19))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            if len(L19) > 0:
                                k= max(min(round(D19/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D19/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 96:
                            L20.append(DistanceToSigHead)
                            D20 = max (L20)
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('len1',len(L20))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1

                            if len(L20) > 0:
                                k= max(min(round(D20/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D20/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 69:
                            L21.append(DistanceToSigHead)
                            D21 = max (L21)
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('len1',len(L21))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            if len(L21) > 0:
                                k= max(min(round(D21/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D21/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 97:
                            L22.append(DistanceToSigHead)
                            D22 = max (L22)
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('len1',len(L22))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1

                            if len(L22) > 0:
                                k= max(min(round(D22/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D22/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('Joining',mm)








                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 70:
                            L28.append(DistanceToSigHead)
                            D28 = max (L28)
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('len1',len(L28))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            if len(L28) > 0:
                                k= max(min(round(D28/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D28/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 87:
                            L29.append(DistanceToSigHead)
                            D29 = max (L29)
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('len1',len(L29))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            if len(L29) > 0:
                                k= max(min(round(D29/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D29/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 63:
                            L30.append(DistanceToSigHead)
                            D30 = max (L30)
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('len1',len(L30))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            if len(L30) > 0:
                                k= max(min(round(D30/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D30/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('Joining',mm)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 82:
                            L31.append(DistanceToSigHead)
                            D31 = max (L31)
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('len1',len(L31))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            if len(L31) > 0:
                                k= max(min(round(D31/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D31/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('Joining',mm)





                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 81:
                            L32.append(DistanceToSigHead)
                            D32 = max (L32)
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('len1',len(L32))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1

                            if len(L32) > 0:
                                k= max(min(round(D32/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D32/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 61:
                            L33.append(DistanceToSigHead)
                            D33 = max (L33)
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('len1',len(L33))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1

                            if len(L33) > 0:
                                k= max(min(round(D33/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D33/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 80:
                            L34.append(DistanceToSigHead)
                            D34 = max (L34)
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('len1',len(L34))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1

                            if len(L34) > 0:
                                k= max(min(round(D34/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D34/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 68:
                            L35.append(DistanceToSigHead)
                            D35 = max (L35)
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('len1',len(L35))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1

                            if len(L35) > 0:
                                k= max(min(round(D35/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D35/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('Joining',mm)







                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 79:
                            L36.append(DistanceToSigHead)
                            D36 = max (L36)
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('len1',len(L36))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1

                            if len(L36) > 0:
                                k= max(min(round(D36/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D36/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('Joining',mm)
                            

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 59:
                            L37.append(DistanceToSigHead)
                            D37 = max (L37)
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('len1',len(L37))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1

                            if len(L37) > 0:
                                k= max(min(round(D37/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D37/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 90:
                            L38.append(DistanceToSigHead)
                            D38 = max (L38)
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('len1',len(L38))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            

                            if len(L38) > 0:
                                k= max(min(round(D38/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D38/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('Joining',mm)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 66:
                            L39.append(DistanceToSigHead)
                            D39 = max (L39)
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('len1',len(L39))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1

                            if len(L39) > 0:
                                k= max(min(round(D39/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D39/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('Joining',mm)









                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 60:
                            L40.append(DistanceToSigHead)
                            D40 = max (L40)
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('len1',len(L40))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1

                            if len(L40) > 0:
                                k= max(min(round(D40/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D40/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 92:
                            L41.append(DistanceToSigHead)
                            D41 = max (L41)
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('len1',len(L41))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1

                            if len(L41) > 0:
                                k= max(min(round(D41/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D41/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 71:
                            L42.append(DistanceToSigHead)
                            D42 = max (L42)
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('len1',len(L42))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1

                            if len(L42) > 0:
                                k= max(min(round(D42/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D42/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 93:
                            L43.append(DistanceToSigHead)
                            D43 = max (L43)
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('len1',len(L43))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1

                            if len(L43) > 0:
                                k= max(min(round(D43/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D43/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('Joining',mm)







                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 72:
                            L44.append(DistanceToSigHead)
                            D44 = max (L44)
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('len1',len(L44))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1

                            if len(L44) > 0:
                                k= max(min(round(D44/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D44/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 62:
                            L45.append(DistanceToSigHead)
                            D45 = max (L45)
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('len1',len(L45))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1

                            if len(L45) > 0:
                                k= max(min(round(D45/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D45/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 73:
                            L46.append(DistanceToSigHead)
                            D46 = max (L46)
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('len1',len(L46))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1

                            if len(L46) > 0:
                                k= max(min(round(D46/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D46/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 83:
                            L47.append(DistanceToSigHead)
                            D47 = max (L47)
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('len1',len(L47))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1

                            if len(L47) > 0:
                                k= max(min(round(D47/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D47/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('Joining',mm)






                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 74:
                            L48.append(DistanceToSigHead)
                            D48 = max (L48)
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('len1',len(L48))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1

                            if len(L48) > 0:
                                k= max(min(round(D48/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D48/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 64:
                            L49.append(DistanceToSigHead)
                            D49 = max (L49)
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('len1',len(L49))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            if len(L49) > 0:
                                k= max(min(round(D49/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D49/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 104:
                            L50.append(DistanceToSigHead)
                            D50 = max (L50)
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('len1',len(L50))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1

                            if len(L50) > 0:
                                k= max(min(round(D50/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D50/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 105:
                            L51.append(DistanceToSigHead)
                            D51 = max (L51)
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('len1',len(L51))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1


                            if len(L51) > 0:
                                k= max(min(round(D51/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D51/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('Joining',mm)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 109:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            LL1.append(DistanceToSigHead)
                            D1 = max (LL1)
                            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('len1',len(LL1))
                            if len(LL1) > 0:
                                k= max(min(round(D1/5),50),1)                                
                                sum1 = 0
                                while k <= 50:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.02)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D1/5),50),1)
                                sum2=0
                                while n <= 50:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.02)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('Joining',mm)
                                

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 91:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            LL2.append(DistanceToSigHead)
                            D2 = max (LL2)
                            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('len1',len(LL2))
                            if len(LL2) > 0:
                                k= max(min(round(D2/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D2/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('Joining',mm)
                                



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 89:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            LL3.append(DistanceToSigHead)
                            D3 = max (LL3)
                            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('len1',len(LL3))
                            if len(LL3) > 0:
                                k= max(min(round(D3/5),10),1)                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D3/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 100:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            LL4.append(DistanceToSigHead)
                            D4 = max (LL4)
                            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('len1',len(LL4))
                            if len(LL4) > 0:
                                k= max(min(round(D4/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D4/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('Joining',mm)












                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 108:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            LL5.append(DistanceToSigHead)
                            D5 = max (LL5)
                            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('len1',len(LL5))
                            if len(LL5) > 0:
                                k= max(min(round(D5/5),50),1)                                
                                sum1 = 0
                                while k <= 50:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.02)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D5/5),50),1)
                                sum2=0
                                while n <= 50:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.02)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('Joining',mm)
                                

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 98:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            LL6.append(DistanceToSigHead)
                            D6 = max (LL6)
                            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('len1',len(LL6))
                            if len(LL6) > 0:
                                k= max(min(round(D6/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D6/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('Joining',mm)
                                



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 88:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            LL7.append(DistanceToSigHead)
                            D7 = max (LL7)
                            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('len1',len(LL7))
                            if len(LL7) > 0:
                                k= max(min(round(D7/5),10),1)                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D7/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 103:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            LL8.append(DistanceToSigHead)
                            D8 = max (LL8)
                            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('len1',len(LL8))
                            if len(LL8) > 0:
                                k= max(min(round(D8/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D8/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('Joining',mm)





                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 112:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            LL9.append(DistanceToSigHead)
                            D9 = max (LL9)
                            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('len1',len(LL9))
                            if len(LL9) > 0:
                                k= max(min(round(D9/5),50),1)                                
                                sum1 = 0
                                while k <= 50:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.02)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D9/5),50),1)
                                sum2=0
                                while n <= 50:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.02)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('Joining',mm)


                                

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 101:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            LL10.append(DistanceToSigHead)
                            D10 = max (LL10)
                            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('len1',len(LL10))
                            if len(LL10) > 0:
                                k= max(min(round(D10/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D10/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('Joining',mm)
                                



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 85:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            LL11.append(DistanceToSigHead)
                            D11 = max (LL11)
                            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('len1',len(LL11))
                            if len(LL11) > 0:
                                k= max(min(round(D11/5),10),1)                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D11/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 95:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            LL12.append(DistanceToSigHead)
                            D12 = max (LL12)
                            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('len1',len(LL12))
                            if len(LL12) > 0:
                                k= max(min(round(D12/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D12/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('Joining',mm)





                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 113:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            LL13.append(DistanceToSigHead)
                            D13 = max (LL13)
                            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('len1',len(LL13))
                            if len(LL13) > 0:
                                k= max(min(round(D13/5),50),1)                                
                                sum1 = 0
                                while k <= 50:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.02)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D13/5),50),1)
                                sum2=0
                                while n <= 50:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.02)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('Joining',mm)


                                

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 106:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            LL14.append(DistanceToSigHead)
                            D14 = max (LL14)
                            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('len1',len(LL14))
                            if len(LL14) > 0:
                                k= max(min(round(D14/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D14/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('Joining',mm)
                                



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 84:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            LL15.append(DistanceToSigHead)
                            D15 = max (LL15)
                            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('len1',len(LL15))
                            if len(LL15) > 0:
                                k= max(min(round(D15/5),10),1)                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D15/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 94:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            LL16.append(DistanceToSigHead)
                            D16 = max (LL16)
                            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('len1',len(LL16))
                            if len(LL16) > 0:
                                k= max(min(round(D16/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D16/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('Joining',mm)




                    else:
                        continue




                    if vehAttributes[vehsAttNames['VehType\No']] in vehTypesSpecial:
                        Link = vehAttributes[vehsAttNames['Lane\Link']]
                        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('LinkNo1',Link)
                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 99:
                            S6.append(1)
                            if len(S6)>0:
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 65:
                            S7.append(1)
                            if len(S7) >0:
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)
                     

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 75:
                            S8.append(1)
                            if len(S8) >0:
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)
                            

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 102:
                            S9.append(1)
                            if len(S9) >0:
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 76:
                            S15.append(1)
                            if len(S15) >0:
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 86:
                            S16.append(1)
                            if len(S16) >0:
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 77:
                            S17.append(1)
                            if len(S17) >0:
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 67:
                            S18.append(1)
                            if len(S18) >0:
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 78:
                            S19.append(1)
                            if len(S19) >0:
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 96:
                            S20.append(1)
                            if len(S20) >0:
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 69:
                            S21.append(1)
                            if len(S21) >0:
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 97:
                            S22.append(1)
                            if len(S22) >0:
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 70:
                            S28.append(1)
                            if len(S28) >0:
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 87:
                            S29.append(1)
                            if len(S29) >0:
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 63:
                            S30.append(1)
                            if len(S30) >0:
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 82:
                            S31.append(1)
                            if len(S31) >0:
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 81:
                            S32.append(1)
                            if len(S32) >0:
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 61:
                            S33.append(1)
                            if len(S33) >0:
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 80:
                            S34.append(1)
                            if len(S34) >0:
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 68:
                            S35.append(1)
                            if len(S35) >0:
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 79:
                            S36.append(1)
                            if len(S36) >0:
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 59:
                            S37.append(1)
                            if len(S37) >0:
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 90:
                            S38.append(1)
                            if len(S38) >0:
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 66:
                            S39.append(1)
                            if len(S39) >0:
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 60:
                            S40.append(1)
                            if len(S40) >0:
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)
 
                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 92:
                            S41.append(1)
                            if len(S41) >0:
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 71:
                            S42.append(1)
                            if len(S42) >0:
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 93:
                            S43.append(1)
                            if len(S43) >0:
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 72:
                            S44.append(1)
                            if len(S44) >0:
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 62:
                            S45.append(1)
                            if len(S45) >0:
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 73:
                            S46.append(1)
                            if len(S46) >0:
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 83:
                            S47.append(1)
                            if len(S47) >0:
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 74:
                            S48.append(1)
                            if len(S48) >0:
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 64:
                            S49.append(1)
                            if len(S49) >0:
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 104:
                            S50.append(1)
                            if len(S50) >0:
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 105:
                            S51.append(1)
                            if len(S51) >0:
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)





        if len(LL1) == 0:
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',2)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('len1',0)
            

        if len(LL2) == 0:
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('len1',0)



        if len(LL3) == 0:
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('len1',0)


        if len(LL4) == 0:
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('len1',0)



        if len(LL5) == 0:
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',2)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('len1',0)

        if len(LL6) == 0:
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('len1',0)


        if len(LL7) == 0:
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('len1',0)



        if len(LL8) == 0:
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('len1',0)


        if len(LL9) == 0:
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',2)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('len1',0)


        if len(LL10) == 0:
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('len1',0)


        if len(LL11) == 0:
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('len1',0)


        if len(LL12) == 0:
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('len1',0)


        if len(LL13) == 0:
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',2)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('len1',0)


        if len(LL14) == 0:
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('len1',0)


        if len(LL15) == 0:
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('len1',0)



        if len(LL16) == 0:
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('len1',0)




        if len(L6)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L7)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('Joining',0)



        if len(L8)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('Joining',0)

        if len(L9)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('Joining',0)


        if len(L15)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('Joining',0)


        if len(L16)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('Joining',0)


        if len(L17)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('Joining',0)


        if len(L18)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('Joining',0)





        if len(L19)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L20)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('Joining',0)

        if len(L21)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('Joining',0)


        if len(L22)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('Joining',0)


        if len(L28)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('Joining',0)




        if len(L29)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('Joining',0)



        if len(L30)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('Joining',0)



        if len(L31)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('Joining',0)




        if len(L32)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('Joining',0)


        if len(L33)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('Joining',0)



        if len(L34)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('Joining',0)


        if len(L35)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('Joining',0)



        if len(L36)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('Joining',0)


        if len(L37)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('Joining',0)



        if len(L38)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L39)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('Joining',0)


        if len(L40)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('Joining',0)



        if len(L41)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L42)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('Joining',0)



        if len(L43)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('Joining',0)


        if len(L44)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L45)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('Joining',0)





        if len(L46)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('Joining',0)


        if len(L47)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('Joining',0)



        if len(L48)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L49)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('Joining',0)



        if len(L50)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('Joining',0)


        if len(L51)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('Joining',0)





        if len(S6)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)




        if len(S7)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)




        if len(S8)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)


        if len(S9)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)



        if len(S15)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)



        if len(S16)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)



        if len(S17)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)



        if len(S18)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)






        if len(S19)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)




        if len(S20)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)


        if len(S21)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)



        if len(S22)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)



        if len(S28)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)





        if len(S29)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)




        if len(S30)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)




        if len(S31)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)





        if len(S32)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)



        if len(S33)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)




        if len(S34)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)



        if len(S35)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)




        if len(S36)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)



        if len(S37)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)




        if len(S38)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)




        if len(S39)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)



        if len(S40)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)




        if len(S41)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)




        if len(S42)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)




        if len(S43)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)



        if len(S44)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)




        if len(S45)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)






        if len(S46)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)



        if len(S47)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)




        if len(S48)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)



        if len(S49)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)



        if len(S49)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)




        if len(S50)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)



        if len(S51)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)




        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('SigState') == 'RED':           
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('Joining')))
            kss1= 14-(Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).AttValue('Queuedup'))
            kss2= 17- (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).AttValue('Queuedup'))
            kss3 = 17- (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).AttValue('Queuedup'))
            kss4= min(kss1,kss2,kss3)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('CurrentSupply',3 * kss4)

            
        else:
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('Joining')))





        if Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('SigState') == 'RED':           
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('Joining')))
            kss11= 14-(Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).AttValue('Queuedup'))
            kss22= 17- (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).AttValue('Queuedup'))
            kss33 = 17- (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).AttValue('Queuedup'))
            kss44= min(kss11,kss22,kss33)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('CurrentSupply',3 * kss44)

        else:
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('Joining')))






        if Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('SigState') == 'RED':           
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('Joining')))
            kss111= 14-(Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss222= 17- (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss333 = 17- (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss444= min(kss111,kss222,kss333)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('CurrentSupply',3 * kss444)

        else:
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('Joining')))




        if Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('SigState') == 'RED':           
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('Joining')))
            kss1111= 14-(Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss2222= 17- (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss3333 = 17- (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss4444= min(kss1111,kss2222,kss3333)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('CurrentSupply',3 * kss4444)

        else:
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('Joining')))

        Aseq=[[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4]]






        GreenTimes = []
        i= GreenMinI2
        while i <= GreenMaxI2:
            GreenTimes.append(i)
            i=i+5


        GreenTimes1 = []
        GreenDemand1 = []
        for i in range(len(GreenTimes)):
            if GreenTimes[i] <= (Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('CurrentSupply')/St2):
                GreenTimes1.append(GreenTimes[i])
                GreenDemand1.append(round(GreenTimes[i]*(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue('ArrivalRate'))))
        if len(GreenTimes1)==0:
            GreenTimes1.append(GreenMinI2)
            GreenDemand1.append(round(GreenMinI2*(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue('ArrivalRate'))))

        GreenTimes11 = []
        GreenDemand11 = []        
        for i in range(len(GreenTimes1)):
            GreenTimes11.append(CLength-GreenTimes1[i])
            GreenDemand11.append(round((CLength-GreenTimes1[i]-6)*(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue('ArrivalRate')+ Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue('ArrivalRate')+Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue('ArrivalRate'))))
                
        GreenTimes5 = []
        GreenDemand5 = []  
        for i in range(len(GreenTimes)):
            if GreenTimes[i] <= (Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('CurrentSupply')/St):
                GreenTimes5.append(GreenTimes[i])
                GreenDemand5.append(round(GreenTimes[i]*(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue('ArrivalRate'))))

        if len(GreenTimes5)==0:
            GreenTimes5.append(GreenMinI2)
            GreenDemand5.append(round(GreenMinI2*(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue('ArrivalRate'))))

        GreenDemand51 = []  
        GreenTimes51 = []
        for i in range(len(GreenTimes5)):
            GreenTimes51.append(CLength-GreenTimes5[i])
            GreenDemand51.append(round((CLength-GreenTimes5[i]-6)*(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue('ArrivalRate')+ Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue('ArrivalRate')+Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue('ArrivalRate'))))


        GreenTimes12 = []
        GreenDemand12 = [] 
        for i in range(len(GreenTimes)):
            if GreenTimes[i] <= (Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('CurrentSupply')/St):
                GreenTimes12.append(GreenTimes[i])
                GreenDemand12.append(round(GreenTimes[i]*(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue('ArrivalRate'))))

        if len(GreenTimes12)==0:
            GreenTimes12.append(GreenMinI2)
            GreenDemand12.append(round(GreenMinI2*(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue('ArrivalRate'))))


        GreenTimes121 = []
        GreenDemand121 = []
        for i in range(len(GreenTimes12)): 
            GreenTimes121.append(CLength-GreenTimes12[i])
            GreenDemand121.append(round((CLength-GreenTimes12[i]-6)*(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue('ArrivalRate')+ Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue('ArrivalRate')+Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue('ArrivalRate'))))





        GreenTimes13 = []
        GreenDemand13 = [] 
        for i in range(len(GreenTimes)):
            if GreenTimes[i] <= (Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('CurrentSupply')/St):
                GreenTimes13.append(GreenTimes[i])
                GreenDemand13.append(round(GreenTimes[i]*(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue('ArrivalRate'))))

        if len(GreenTimes13)==0:
            GreenTimes13.append(GreenMinI2)
            GreenDemand13.append(round(GreenMinI2*(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue('ArrivalRate'))))



        GreenTimes131 = []
        GreenDemand131 = []
        for i in range(len(GreenTimes13)):
            GreenTimes131.append(CLength-GreenTimes13[i])
            GreenDemand131.append(round((CLength-GreenTimes13[i]-6)*(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue('ArrivalRate')+ Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue('ArrivalRate')+Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue('ArrivalRate'))))






        incoming1=[]
        outgoing1=[]
        content1=[]
        for i in range(len(GreenTimes1)):
            in1 = Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('CurrentDemand')+ GreenDemand1[i]
            in2 = GreenTimes1[i] * St2
            in3 = min(in1,in2)
            incoming1.append(in3)
            out1 = Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('CurrentDemand')+ Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('CurrentDemand')+ Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('CurrentDemand')+ GreenDemand11[i]
            out2 = GreenTimes11[i] * St2
            out3 = min(out1,out2)
            outgoing1.append(out3)
            content1.append(in3-out3)



        incoming5=[]
        outgoing5=[]
        content5=[]
        for i in range(len(GreenTimes5)):
            in1 = Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('CurrentDemand')+ GreenDemand5[i]
            in2 = GreenTimes5[i] * St2
            in3 = min(in1,in2)
            incoming5.append(in3)
            out1 = Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('CurrentDemand')+ GreenDemand51[i]
            out2 = GreenTimes51[i] * St2
            out3 = min(out1,out2)
            outgoing5.append(out3)
            content5.append(in3-out3)


        incoming12=[]
        outgoing12=[]
        content12=[]
        for i in range(len(GreenTimes12)):
            in1 = Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('CurrentDemand')+ GreenDemand12[i]
            in2 = GreenTimes12[i] * St2
            in3 = min(in1,in2)
            incoming12.append(in3)
            out1 = Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('CurrentDemand')+ GreenDemand121[i]
            out2 = GreenTimes121[i] * St2
            out3 = min(out1,out2)
            outgoing12.append(out3)
            content12.append(in3-out3)



        incoming13=[]
        outgoing13=[]
        content13=[]
        for i in range(len(GreenTimes13)):
            in1 = Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('CurrentDemand')+ GreenDemand13[i]
            in2 = GreenTimes13[i] * St2
            in3 = min(in1,in2)
            incoming13.append(in3)
            out1 = Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('CurrentDemand')+ GreenDemand131[i]
            out2 = GreenTimes131[i] * St2
            out3 = min(out1,out2)
            outgoing13.append(out3)
            content13.append(in3-out3)

        kk=0
        for x in LinkAttributes:
            kk= kk + x[LinAttNames['Count:Vehs']]
        density = kk  - Vissim.Net.Links.ItemByKey(107).AttValue ('Count:Vehs') - Vissim.Net.Links.ItemByKey(108).AttValue ('Count:Vehs') - Vissim.Net.Links.ItemByKey(109).AttValue ('Count:Vehs')- Vissim.Net.Links.ItemByKey(110).AttValue ('Count:Vehs')- Vissim.Net.Links.ItemByKey(111).AttValue ('Count:Vehs')- Vissim.Net.Links.ItemByKey(112).AttValue ('Count:Vehs')- Vissim.Net.Links.ItemByKey(113).AttValue ('Count:Vehs')-- Vissim.Net.Links.ItemByKey(114).AttValue ('Count:Vehs')

        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue('SystemContent',density)

        scc=[]
        scc2=[]        
        indexes=[]
        mmmm = Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue('SystemContent')
        for i in range(len(content1)):
            for j in range(len(content5)):
                for k in range(len(content12)):
                    for m in range(len(content13)):
                        scc1 = abs(Kq - (mmmm + content1[i] + content5[j] + content12[k] + content13[m]))
                        scc2.append(scc1)
                        indexes.append([i,j,k,m])



        minimals=[]
        indexes2=[]
        for i in range(len(scc2)):
            if scc2[i]== min(scc2):
                minimals.append(scc2[i])
                indexes2.append(indexes[i])

        mor=[]
        for i in range(len(minimals)):
            mo1 = abs(GreenTimes1[indexes2[i][0]]*St-Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('CurrentDemand'))+ abs((CLength-GreenTimes1[indexes2[i][0]])*St-Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('CurrentDemand')) + abs((CLength-GreenTimes1[indexes2[i][0]])*St-Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('CurrentDemand'))+ abs((CLength-GreenTimes1[indexes2[i][0]])*St-Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('CurrentDemand')) + abs(GreenTimes5[indexes2[i][1]]*St-Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('CurrentDemand'))+ abs((CLength - GreenTimes5[indexes2[i][1]])*St-Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('CurrentDemand')) + abs((CLength - GreenTimes5[indexes2[i][1]])*St-Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('CurrentDemand'))+ abs((CLength - GreenTimes5[indexes2[i][1]])*St-Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('CurrentDemand')) +abs(GreenTimes12[indexes2[i][2]]*St-Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('CurrentDemand'))+ abs((CLength - GreenTimes12[indexes2[i][2]])*St-Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('CurrentDemand')) + abs((CLength - GreenTimes12[indexes2[i][2]])*St-Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('CurrentDemand'))+ abs((CLength - GreenTimes12[indexes2[i][2]])*St-Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('CurrentDemand'))+abs(GreenTimes13[indexes2[i][3]]*St-Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('CurrentDemand')) + abs((CLength - GreenTimes13[indexes2[i][3]])*St-Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('CurrentDemand')) + abs((CLength - GreenTimes13[indexes2[i][3]])*St-Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('CurrentDemand'))+ abs((CLength - GreenTimes13[indexes2[i][3]])*St-Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('CurrentDemand'))
            mor.append(mo1)




        finding=[]
        indexes3=[]
        for i in range(len(mor)): 
            if mor[i] == min(mor):
                finding.append(mor[i])
                MG1=GreenTimes1[indexes2[i][0]]
                MG2=GreenTimes5[indexes2[i][1]]
                MG3=GreenTimes12[indexes2[i][2]]
                MG4=GreenTimes13[indexes2[i][3]]
                indexes3.append([indexes2[i][0], indexes2[i][1], indexes2[i][2], indexes2[i][3]])






    
        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+2 > 22:
            koo=max(MG1,20) 
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('GreenTimeDuration',koo)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('GreenTimeDuration',CLength-koo-6)



            
        if Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+2 > 22:
            koo=max(MG2,20)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('GreenTimeDuration',koo)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            kk=0




        if Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+2 > 22:
            koo=max(MG3,20)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('GreenTimeDuration',koo)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('GreenTimeDuration',CLength-koo-6)






        if Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+2 > 22:
            koo=max(MG4,20)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('GreenTimeDuration',koo)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('GreenTimeDuration',CLength-koo-6)        







        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('GreenStart',2)
        ko = Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenStart')
        ko2 = max(ko,20)
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('GreenEnd',ko)
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('GreenEnd',CLength-1)



        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('GreenStart',2)
        ko = Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenStart')
        ko2 = max(ko,22)
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('GreenEnd',ko)
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('GreenEnd',CLength-1)



        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('GreenStart',2)
        ko = Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenStart')
        ko2 = max(ko,22)
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('GreenEnd',ko)
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('GreenEnd',CLength-1)


        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('GreenStart',2)
        ko = Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenStart')
        ko2 = max(ko,22)
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('GreenEnd',ko)
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('GreenEnd',CLength-1)
















        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][3]).SetAttValue ('GreenEnd', CLength-1)


        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][3]).SetAttValue ('GreenEnd', CLength-1)


        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][3]).SetAttValue ('GreenEnd', CLength-1)





        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][3]).SetAttValue ('GreenEnd', CLength-1)




        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][3]).SetAttValue ('GreenEnd', CLength-1)



        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][3]).SetAttValue ('GreenEnd', CLength-1)




        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][3]).SetAttValue ('GreenEnd', CLength-1)



        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][3]).SetAttValue ('GreenEnd', CLength-1)





        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][3]).SetAttValue ('GreenEnd', CLength-1)


















#fourth time step
    if Seconds>=29 and Seconds<=30:

        L1=[]
        L2=[]
        L3=[]
        L4=[]
        L5=[]
        L6=[]
        L7=[]
        L8=[]
        L9=[]
        L10=[]
        L11=[]
        L12=[]
        L13=[]
        L14=[]
        L15=[]
        L16=[]
        L17=[]
        L18=[]
        L19=[]
        L20=[]
        L21=[]
        L22=[]
        L23=[]
        L24=[]
        L25=[]
        L26=[]
        L27=[]
        L28=[]
        L29=[]
        L30=[]
        L31=[]
        L32=[]
        L33=[]
        L34=[]
        L35=[]
        L36=[]
        L37=[]
        L38=[]
        L39=[]
        L40=[]
        L41=[]
        L42=[]
        L43=[]
        L44=[]
        L45=[]
        L46=[]
        L47=[]
        L48=[]
        L49=[]
        L50=[]
        L51=[]
        L52=[]
        L53=[]
        L54=[]
        L55=[]
        L56=[]
        LL1=[]
        LL2=[]
        LL3=[]
        LL4=[]
        LL5=[]
        LL6=[]
        LL7=[]
        LL8=[]
        LL9=[]
        LL10=[]
        LL11=[]
        LL12=[]
        LL13=[]
        LL14=[]
        LL15=[]
        LL16=[]
        S1=[]
        S2=[]
        S3=[]
        S4=[]
        S5=[]
        S6=[]
        S7=[]
        S8=[]
        S9=[]
        S10=[]
        S11=[]
        S12=[]
        S13=[]
        S14=[]
        S15=[]
        S16=[]
        S17=[]
        S18=[]
        S19=[]
        S20=[]
        S21=[]
        S22=[]
        S23=[]
        S24=[]
        S25=[]
        S26=[]
        S27=[]
        S28=[]
        S29=[]
        S30=[]
        S31=[]
        S32=[]
        S33=[]
        S34=[]
        S35=[]
        S36=[]
        S37=[]
        S38=[]
        S39=[]
        S40=[]
        S41=[]
        S42=[]
        S43=[]
        S44=[]
        S45=[]
        S46=[]
        S47=[]
        S48=[]
        S49=[]
        S50=[]
        S51=[]
        S52=[]
        S53=[]
        S54=[]
        S55=[]
        S56=[]

        for vehAttributes in vehsAttributes:
            if vehAttributes[vehsAttNames['VehType\No']] in vehTypesEquipped:       
                if vehAttributes[vehsAttNames['Pos']] != None:
                    InQueue = vehAttributes[vehsAttNames['InQueue']]               
                    if InQueue == True:
                        DistanceToSigHead = vehAttributes[vehsAttNames['DistanceToSigHead']]
                        Link = vehAttributes[vehsAttNames['Lane\Link']]
                        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('LinkNo',Link)
                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 99:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            L6.append(DistanceToSigHead)
                            D6 = max (L6)
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('len1',len(L6))

                            if len(L6) > 0:
                                k= max(min(round(D6/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D6/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('Joining',mm)
                                

                                    
                            

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 65:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            L7.append(DistanceToSigHead)
                            D7 = max (L7)
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('len1',len(L7))

                            if len(L7) > 0:
                                k= max(min(round(D7/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D7/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('Joining',mm)
                                


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 75:
                            
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            L8.append(DistanceToSigHead)
                            D8 = max(L8)
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('len1',len(L8))

                            if len(L8) > 0:
                                k= max(min(round(D8/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D8/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('Joining',mm)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 102:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            L9.append(DistanceToSigHead)
                            D9 = max (L9)
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('len1',len(L9))


                            if len(L9) > 0:
                                k= max(min(round(D9/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D9/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('Joining',mm)







                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 76:
                            L15.append(DistanceToSigHead)
                            D15 = max (L15)
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('len1',len(L15))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1


                            if len(L15) > 0:
                                k= max(min(round(D15/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D15/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('Joining',mm)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 86:
                            L16.append(DistanceToSigHead)
                            D16 = max (L16)
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('len1',len(L16))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            if len(L16) > 0:
                                k= max(min(round(D16/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D16/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 77:
                            L17.append(DistanceToSigHead)
                            D17 = max (L17)
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('len1',len(L17))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            if len(L17) > 0:
                                k= max(min(round(D17/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D17/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 67:
                            L18.append(DistanceToSigHead)
                            D18 = max (L18)
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('len1',len(L18))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            if len(L18) > 0:
                                k= max(min(round(D18/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D18/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('Joining',mm)








                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 78:
                            L19.append(DistanceToSigHead)
                            D19 = max (L19)
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('len1',len(L19))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            if len(L19) > 0:
                                k= max(min(round(D19/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D19/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 96:
                            L20.append(DistanceToSigHead)
                            D20 = max (L20)
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('len1',len(L20))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1

                            if len(L20) > 0:
                                k= max(min(round(D20/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D20/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 69:
                            L21.append(DistanceToSigHead)
                            D21 = max (L21)
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('len1',len(L21))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            if len(L21) > 0:
                                k= max(min(round(D21/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D21/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 97:
                            L22.append(DistanceToSigHead)
                            D22 = max (L22)
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('len1',len(L22))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1

                            if len(L22) > 0:
                                k= max(min(round(D22/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D22/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('Joining',mm)








                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 70:
                            L28.append(DistanceToSigHead)
                            D28 = max (L28)
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('len1',len(L28))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            if len(L28) > 0:
                                k= max(min(round(D28/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D28/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 87:
                            L29.append(DistanceToSigHead)
                            D29 = max (L29)
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('len1',len(L29))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            if len(L29) > 0:
                                k= max(min(round(D29/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D29/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 63:
                            L30.append(DistanceToSigHead)
                            D30 = max (L30)
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('len1',len(L30))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            if len(L30) > 0:
                                k= max(min(round(D30/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D30/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('Joining',mm)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 82:
                            L31.append(DistanceToSigHead)
                            D31 = max (L31)
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('len1',len(L31))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            if len(L31) > 0:
                                k= max(min(round(D31/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D31/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('Joining',mm)





                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 81:
                            L32.append(DistanceToSigHead)
                            D32 = max (L32)
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('len1',len(L32))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1

                            if len(L32) > 0:
                                k= max(min(round(D32/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D32/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 61:
                            L33.append(DistanceToSigHead)
                            D33 = max (L33)
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('len1',len(L33))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1

                            if len(L33) > 0:
                                k= max(min(round(D33/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D33/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 80:
                            L34.append(DistanceToSigHead)
                            D34 = max (L34)
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('len1',len(L34))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1

                            if len(L34) > 0:
                                k= max(min(round(D34/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D34/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 68:
                            L35.append(DistanceToSigHead)
                            D35 = max (L35)
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('len1',len(L35))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1

                            if len(L35) > 0:
                                k= max(min(round(D35/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D35/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('Joining',mm)







                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 79:
                            L36.append(DistanceToSigHead)
                            D36 = max (L36)
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('len1',len(L36))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1

                            if len(L36) > 0:
                                k= max(min(round(D36/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D36/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('Joining',mm)
                            

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 59:
                            L37.append(DistanceToSigHead)
                            D37 = max (L37)
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('len1',len(L37))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1

                            if len(L37) > 0:
                                k= max(min(round(D37/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D37/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 90:
                            L38.append(DistanceToSigHead)
                            D38 = max (L38)
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('len1',len(L38))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            

                            if len(L38) > 0:
                                k= max(min(round(D38/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D38/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('Joining',mm)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 66:
                            L39.append(DistanceToSigHead)
                            D39 = max (L39)
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('len1',len(L39))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1

                            if len(L39) > 0:
                                k= max(min(round(D39/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D39/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('Joining',mm)









                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 60:
                            L40.append(DistanceToSigHead)
                            D40 = max (L40)
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('len1',len(L40))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1

                            if len(L40) > 0:
                                k= max(min(round(D40/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D40/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 92:
                            L41.append(DistanceToSigHead)
                            D41 = max (L41)
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('len1',len(L41))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1

                            if len(L41) > 0:
                                k= max(min(round(D41/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D41/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 71:
                            L42.append(DistanceToSigHead)
                            D42 = max (L42)
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('len1',len(L42))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1

                            if len(L42) > 0:
                                k= max(min(round(D42/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D42/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 93:
                            L43.append(DistanceToSigHead)
                            D43 = max (L43)
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('len1',len(L43))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1

                            if len(L43) > 0:
                                k= max(min(round(D43/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D43/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('Joining',mm)







                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 72:
                            L44.append(DistanceToSigHead)
                            D44 = max (L44)
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('len1',len(L44))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1

                            if len(L44) > 0:
                                k= max(min(round(D44/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D44/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 62:
                            L45.append(DistanceToSigHead)
                            D45 = max (L45)
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('len1',len(L45))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1

                            if len(L45) > 0:
                                k= max(min(round(D45/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D45/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 73:
                            L46.append(DistanceToSigHead)
                            D46 = max (L46)
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('len1',len(L46))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1

                            if len(L46) > 0:
                                k= max(min(round(D46/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D46/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 83:
                            L47.append(DistanceToSigHead)
                            D47 = max (L47)
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('len1',len(L47))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1

                            if len(L47) > 0:
                                k= max(min(round(D47/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D47/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('Joining',mm)






                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 74:
                            L48.append(DistanceToSigHead)
                            D48 = max (L48)
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('len1',len(L48))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1

                            if len(L48) > 0:
                                k= max(min(round(D48/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D48/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 64:
                            L49.append(DistanceToSigHead)
                            D49 = max (L49)
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('len1',len(L49))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            if len(L49) > 0:
                                k= max(min(round(D49/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D49/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 104:
                            L50.append(DistanceToSigHead)
                            D50 = max (L50)
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('len1',len(L50))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1

                            if len(L50) > 0:
                                k= max(min(round(D50/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D50/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 105:
                            L51.append(DistanceToSigHead)
                            D51 = max (L51)
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('len1',len(L51))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1


                            if len(L51) > 0:
                                k= max(min(round(D51/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D51/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('Joining',mm)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 109:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            LL1.append(DistanceToSigHead)
                            D1 = max (LL1)
                            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('len1',len(LL1))
                            if len(LL1) > 0:
                                k= max(min(round(D1/5),50),1)                                
                                sum1 = 0
                                while k <= 50:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.02)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D1/5),50),1)
                                sum2=0
                                while n <= 50:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.02)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('Joining',mm)
                                

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 91:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            LL2.append(DistanceToSigHead)
                            D2 = max (LL2)
                            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('len1',len(LL2))
                            if len(LL2) > 0:
                                k= max(min(round(D2/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D2/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('Joining',mm)
                                



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 89:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            LL3.append(DistanceToSigHead)
                            D3 = max (LL3)
                            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('len1',len(LL3))
                            if len(LL3) > 0:
                                k= max(min(round(D3/5),10),1)                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D3/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 100:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            LL4.append(DistanceToSigHead)
                            D4 = max (LL4)
                            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('len1',len(LL4))
                            if len(LL4) > 0:
                                k= max(min(round(D4/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D4/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('Joining',mm)












                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 108:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            LL5.append(DistanceToSigHead)
                            D5 = max (LL5)
                            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('len1',len(LL5))
                            if len(LL5) > 0:
                                k= max(min(round(D5/5),50),1)                                
                                sum1 = 0
                                while k <= 50:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.02)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D5/5),50),1)
                                sum2=0
                                while n <= 50:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.02)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('Joining',mm)
                                

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 98:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            LL6.append(DistanceToSigHead)
                            D6 = max (LL6)
                            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('len1',len(LL6))
                            if len(LL6) > 0:
                                k= max(min(round(D6/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D6/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('Joining',mm)
                                



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 88:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            LL7.append(DistanceToSigHead)
                            D7 = max (LL7)
                            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('len1',len(LL7))
                            if len(LL7) > 0:
                                k= max(min(round(D7/5),10),1)                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D7/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 103:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            LL8.append(DistanceToSigHead)
                            D8 = max (LL8)
                            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('len1',len(LL8))
                            if len(LL8) > 0:
                                k= max(min(round(D8/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D8/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('Joining',mm)





                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 112:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            LL9.append(DistanceToSigHead)
                            D9 = max (LL9)
                            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('len1',len(LL9))
                            if len(LL9) > 0:
                                k= max(min(round(D9/5),50),1)                                
                                sum1 = 0
                                while k <= 50:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.02)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D9/5),50),1)
                                sum2=0
                                while n <= 50:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.02)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('Joining',mm)


                                

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 101:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            LL10.append(DistanceToSigHead)
                            D10 = max (LL10)
                            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('len1',len(LL10))
                            if len(LL10) > 0:
                                k= max(min(round(D10/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D10/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('Joining',mm)
                                



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 85:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            LL11.append(DistanceToSigHead)
                            D11 = max (LL11)
                            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('len1',len(LL11))
                            if len(LL11) > 0:
                                k= max(min(round(D11/5),10),1)                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D11/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 95:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            LL12.append(DistanceToSigHead)
                            D12 = max (LL12)
                            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('len1',len(LL12))
                            if len(LL12) > 0:
                                k= max(min(round(D12/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D12/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('Joining',mm)





                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 113:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            LL13.append(DistanceToSigHead)
                            D13 = max (LL13)
                            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('len1',len(LL13))
                            if len(LL13) > 0:
                                k= max(min(round(D13/5),50),1)                                
                                sum1 = 0
                                while k <= 50:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.02)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D13/5),50),1)
                                sum2=0
                                while n <= 50:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.02)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('Joining',mm)


                                

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 106:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            LL14.append(DistanceToSigHead)
                            D14 = max (LL14)
                            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('len1',len(LL14))
                            if len(LL14) > 0:
                                k= max(min(round(D14/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D14/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('Joining',mm)
                                



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 84:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            LL15.append(DistanceToSigHead)
                            D15 = max (LL15)
                            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('len1',len(LL15))
                            if len(LL15) > 0:
                                k= max(min(round(D15/5),10),1)                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D15/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 94:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            LL16.append(DistanceToSigHead)
                            D16 = max (LL16)
                            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('len1',len(LL16))
                            if len(LL16) > 0:
                                k= max(min(round(D16/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D16/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('Joining',mm)




                    else:
                        continue




                    if vehAttributes[vehsAttNames['VehType\No']] in vehTypesSpecial:
                        Link = vehAttributes[vehsAttNames['Lane\Link']]
                        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('LinkNo1',Link)
                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 99:
                            S6.append(1)
                            if len(S6)>0:
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 65:
                            S7.append(1)
                            if len(S7) >0:
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)
                     

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 75:
                            S8.append(1)
                            if len(S8) >0:
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)
                            

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 102:
                            S9.append(1)
                            if len(S9) >0:
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 76:
                            S15.append(1)
                            if len(S15) >0:
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 86:
                            S16.append(1)
                            if len(S16) >0:
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 77:
                            S17.append(1)
                            if len(S17) >0:
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 67:
                            S18.append(1)
                            if len(S18) >0:
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 78:
                            S19.append(1)
                            if len(S19) >0:
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 96:
                            S20.append(1)
                            if len(S20) >0:
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 69:
                            S21.append(1)
                            if len(S21) >0:
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 97:
                            S22.append(1)
                            if len(S22) >0:
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 70:
                            S28.append(1)
                            if len(S28) >0:
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 87:
                            S29.append(1)
                            if len(S29) >0:
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 63:
                            S30.append(1)
                            if len(S30) >0:
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 82:
                            S31.append(1)
                            if len(S31) >0:
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 81:
                            S32.append(1)
                            if len(S32) >0:
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 61:
                            S33.append(1)
                            if len(S33) >0:
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 80:
                            S34.append(1)
                            if len(S34) >0:
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 68:
                            S35.append(1)
                            if len(S35) >0:
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 79:
                            S36.append(1)
                            if len(S36) >0:
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 59:
                            S37.append(1)
                            if len(S37) >0:
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 90:
                            S38.append(1)
                            if len(S38) >0:
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 66:
                            S39.append(1)
                            if len(S39) >0:
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 60:
                            S40.append(1)
                            if len(S40) >0:
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)
 
                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 92:
                            S41.append(1)
                            if len(S41) >0:
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 71:
                            S42.append(1)
                            if len(S42) >0:
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 93:
                            S43.append(1)
                            if len(S43) >0:
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 72:
                            S44.append(1)
                            if len(S44) >0:
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 62:
                            S45.append(1)
                            if len(S45) >0:
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 73:
                            S46.append(1)
                            if len(S46) >0:
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 83:
                            S47.append(1)
                            if len(S47) >0:
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 74:
                            S48.append(1)
                            if len(S48) >0:
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 64:
                            S49.append(1)
                            if len(S49) >0:
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 104:
                            S50.append(1)
                            if len(S50) >0:
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 105:
                            S51.append(1)
                            if len(S51) >0:
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)





        if len(LL1) == 0:
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',2)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('len1',0)
            

        if len(LL2) == 0:
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('len1',0)



        if len(LL3) == 0:
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('len1',0)


        if len(LL4) == 0:
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('len1',0)



        if len(LL5) == 0:
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',2)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('len1',0)

        if len(LL6) == 0:
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('len1',0)


        if len(LL7) == 0:
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('len1',0)



        if len(LL8) == 0:
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('len1',0)


        if len(LL9) == 0:
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',2)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('len1',0)


        if len(LL10) == 0:
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('len1',0)


        if len(LL11) == 0:
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('len1',0)


        if len(LL12) == 0:
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('len1',0)


        if len(LL13) == 0:
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',2)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('len1',0)


        if len(LL14) == 0:
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('len1',0)


        if len(LL15) == 0:
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('len1',0)



        if len(LL16) == 0:
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('len1',0)




        if len(L6)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L7)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('Joining',0)



        if len(L8)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('Joining',0)

        if len(L9)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('Joining',0)


        if len(L15)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('Joining',0)


        if len(L16)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('Joining',0)


        if len(L17)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('Joining',0)


        if len(L18)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('Joining',0)





        if len(L19)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L20)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('Joining',0)

        if len(L21)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('Joining',0)


        if len(L22)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('Joining',0)


        if len(L28)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('Joining',0)




        if len(L29)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('Joining',0)



        if len(L30)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('Joining',0)



        if len(L31)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('Joining',0)




        if len(L32)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('Joining',0)


        if len(L33)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('Joining',0)



        if len(L34)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('Joining',0)


        if len(L35)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('Joining',0)



        if len(L36)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('Joining',0)


        if len(L37)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('Joining',0)



        if len(L38)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L39)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('Joining',0)


        if len(L40)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('Joining',0)



        if len(L41)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L42)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('Joining',0)



        if len(L43)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('Joining',0)


        if len(L44)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L45)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('Joining',0)





        if len(L46)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('Joining',0)


        if len(L47)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('Joining',0)



        if len(L48)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L49)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('Joining',0)



        if len(L50)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('Joining',0)


        if len(L51)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('Joining',0)





        if len(S6)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)




        if len(S7)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)




        if len(S8)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)


        if len(S9)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)



        if len(S15)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)



        if len(S16)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)



        if len(S17)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)



        if len(S18)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)






        if len(S19)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)




        if len(S20)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)


        if len(S21)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)



        if len(S22)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)



        if len(S28)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)





        if len(S29)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)




        if len(S30)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)




        if len(S31)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)





        if len(S32)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)



        if len(S33)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)




        if len(S34)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)



        if len(S35)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)




        if len(S36)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)



        if len(S37)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)




        if len(S38)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)




        if len(S39)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)



        if len(S40)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)




        if len(S41)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)




        if len(S42)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)




        if len(S43)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)



        if len(S44)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)




        if len(S45)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)






        if len(S46)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)



        if len(S47)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)




        if len(S48)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)



        if len(S49)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)



        if len(S49)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)




        if len(S50)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)



        if len(S51)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)




        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('SigState') == 'RED':           
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('Joining')))
            kss1= 14-(Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).AttValue('Queuedup'))
            kss2= 17- (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).AttValue('Queuedup'))
            kss3 = 17- (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).AttValue('Queuedup'))
            kss4= min(kss1,kss2,kss3)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('CurrentSupply',3 * kss4)

            
        else:
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('Joining')))





        if Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('SigState') == 'RED':           
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('Joining')))
            kss11= 14-(Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).AttValue('Queuedup'))
            kss22= 17- (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).AttValue('Queuedup'))
            kss33 = 17- (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).AttValue('Queuedup'))
            kss44= min(kss11,kss22,kss33)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('CurrentSupply',3 * kss44)

        else:
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('Joining')))






        if Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('SigState') == 'RED':           
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('Joining')))
            kss111= 14-(Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss222= 17- (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss333 = 17- (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss444= min(kss111,kss222,kss333)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('CurrentSupply',3 * kss444)

        else:
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('Joining')))




        if Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('SigState') == 'RED':           
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('Joining')))
            kss1111= 14-(Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss2222= 17- (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss3333 = 17- (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss4444= min(kss1111,kss2222,kss3333)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('CurrentSupply',3 * kss4444)

        else:
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('Joining')))

        Aseq=[[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4]]




        GreenTimes = []
        i= GreenMinI2
        while i <= GreenMaxI2:
            GreenTimes.append(i)
            i=i+5


        GreenTimes1 = []
        GreenDemand1 = []
        for i in range(len(GreenTimes)):
            if GreenTimes[i] <= (Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('CurrentSupply')/St2):
                GreenTimes1.append(GreenTimes[i])
                GreenDemand1.append(round(GreenTimes[i]*(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue('ArrivalRate'))))
        if len(GreenTimes1)==0:
            GreenTimes1.append(GreenMinI2)
            GreenDemand1.append(round(GreenMinI2*(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue('ArrivalRate'))))

        GreenTimes11 = []
        GreenDemand11 = []        
        for i in range(len(GreenTimes1)):
            GreenTimes11.append(CLength-GreenTimes1[i])
            GreenDemand11.append(round((CLength-GreenTimes1[i]-6)*(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue('ArrivalRate')+ Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue('ArrivalRate')+Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue('ArrivalRate'))))
                
        GreenTimes5 = []
        GreenDemand5 = []  
        for i in range(len(GreenTimes)):
            if GreenTimes[i] <= (Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('CurrentSupply')/St):
                GreenTimes5.append(GreenTimes[i])
                GreenDemand5.append(round(GreenTimes[i]*(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue('ArrivalRate'))))

        if len(GreenTimes5)==0:
            GreenTimes5.append(GreenMinI2)
            GreenDemand5.append(round(GreenMinI2*(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue('ArrivalRate'))))

        GreenDemand51 = []  
        GreenTimes51 = []
        for i in range(len(GreenTimes5)):
            GreenTimes51.append(CLength-GreenTimes5[i])
            GreenDemand51.append(round((CLength-GreenTimes5[i]-6)*(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue('ArrivalRate')+ Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue('ArrivalRate')+Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue('ArrivalRate'))))


        GreenTimes12 = []
        GreenDemand12 = [] 
        for i in range(len(GreenTimes)):
            if GreenTimes[i] <= (Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('CurrentSupply')/St):
                GreenTimes12.append(GreenTimes[i])
                GreenDemand12.append(round(GreenTimes[i]*(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue('ArrivalRate'))))

        if len(GreenTimes12)==0:
            GreenTimes12.append(GreenMinI2)
            GreenDemand12.append(round(GreenMinI2*(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue('ArrivalRate'))))


        GreenTimes121 = []
        GreenDemand121 = []
        for i in range(len(GreenTimes12)): 
            GreenTimes121.append(CLength-GreenTimes12[i])
            GreenDemand121.append(round((CLength-GreenTimes12[i]-6)*(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue('ArrivalRate')+ Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue('ArrivalRate')+Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue('ArrivalRate'))))





        GreenTimes13 = []
        GreenDemand13 = [] 
        for i in range(len(GreenTimes)):
            if GreenTimes[i] <= (Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('CurrentSupply')/St):
                GreenTimes13.append(GreenTimes[i])
                GreenDemand13.append(round(GreenTimes[i]*(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue('ArrivalRate'))))

        if len(GreenTimes13)==0:
            GreenTimes13.append(GreenMinI2)
            GreenDemand13.append(round(GreenMinI2*(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue('ArrivalRate'))))



        GreenTimes131 = []
        GreenDemand131 = []
        for i in range(len(GreenTimes13)):
            GreenTimes131.append(CLength-GreenTimes13[i])
            GreenDemand131.append(round((CLength-GreenTimes13[i]-6)*(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue('ArrivalRate')+ Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue('ArrivalRate')+Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue('ArrivalRate'))))






        incoming1=[]
        outgoing1=[]
        content1=[]
        for i in range(len(GreenTimes1)):
            in1 = Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('CurrentDemand')+ GreenDemand1[i]
            in2 = GreenTimes1[i] * St2
            in3 = min(in1,in2)
            incoming1.append(in3)
            out1 = Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('CurrentDemand')+ Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('CurrentDemand')+ Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('CurrentDemand')+ GreenDemand11[i]
            out2 = GreenTimes11[i] * St2
            out3 = min(out1,out2)
            outgoing1.append(out3)
            content1.append(in3-out3)



        incoming5=[]
        outgoing5=[]
        content5=[]
        for i in range(len(GreenTimes5)):
            in1 = Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('CurrentDemand')+ GreenDemand5[i]
            in2 = GreenTimes5[i] * St2
            in3 = min(in1,in2)
            incoming5.append(in3)
            out1 = Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('CurrentDemand')+ GreenDemand51[i]
            out2 = GreenTimes51[i] * St2
            out3 = min(out1,out2)
            outgoing5.append(out3)
            content5.append(in3-out3)


        incoming12=[]
        outgoing12=[]
        content12=[]
        for i in range(len(GreenTimes12)):
            in1 = Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('CurrentDemand')+ GreenDemand12[i]
            in2 = GreenTimes12[i] * St2
            in3 = min(in1,in2)
            incoming12.append(in3)
            out1 = Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('CurrentDemand')+ GreenDemand121[i]
            out2 = GreenTimes121[i] * St2
            out3 = min(out1,out2)
            outgoing12.append(out3)
            content12.append(in3-out3)



        incoming13=[]
        outgoing13=[]
        content13=[]
        for i in range(len(GreenTimes13)):
            in1 = Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('CurrentDemand')+ GreenDemand13[i]
            in2 = GreenTimes13[i] * St2
            in3 = min(in1,in2)
            incoming13.append(in3)
            out1 = Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('CurrentDemand')+ GreenDemand131[i]
            out2 = GreenTimes131[i] * St2
            out3 = min(out1,out2)
            outgoing13.append(out3)
            content13.append(in3-out3)

        kk=0
        for x in LinkAttributes:
            kk= kk + x[LinAttNames['Count:Vehs']]
        density = kk  - Vissim.Net.Links.ItemByKey(107).AttValue ('Count:Vehs') - Vissim.Net.Links.ItemByKey(108).AttValue ('Count:Vehs') - Vissim.Net.Links.ItemByKey(109).AttValue ('Count:Vehs')- Vissim.Net.Links.ItemByKey(110).AttValue ('Count:Vehs')- Vissim.Net.Links.ItemByKey(111).AttValue ('Count:Vehs')- Vissim.Net.Links.ItemByKey(112).AttValue ('Count:Vehs')- Vissim.Net.Links.ItemByKey(113).AttValue ('Count:Vehs')-- Vissim.Net.Links.ItemByKey(114).AttValue ('Count:Vehs')

        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue('SystemContent',density)

        scc=[]
        scc2=[]        
        indexes=[]
        mmmm = Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue('SystemContent')
        for i in range(len(content1)):
            for j in range(len(content5)):
                for k in range(len(content12)):
                    for m in range(len(content13)):
                        scc1 = abs(Kq - (mmmm + content1[i] + content5[j] + content12[k] + content13[m]))
                        scc2.append(scc1)
                        indexes.append([i,j,k,m])



        minimals=[]
        indexes2=[]
        for i in range(len(scc2)):
            if scc2[i]== min(scc2):
                minimals.append(scc2[i])
                indexes2.append(indexes[i])

        mor=[]
        for i in range(len(minimals)):
            mo1 = abs(GreenTimes1[indexes2[i][0]]*St-Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('CurrentDemand'))+ abs((CLength-GreenTimes1[indexes2[i][0]])*St-Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('CurrentDemand')) + abs((CLength-GreenTimes1[indexes2[i][0]])*St-Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('CurrentDemand'))+ abs((CLength-GreenTimes1[indexes2[i][0]])*St-Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('CurrentDemand')) + abs(GreenTimes5[indexes2[i][1]]*St-Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('CurrentDemand'))+ abs((CLength - GreenTimes5[indexes2[i][1]])*St-Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('CurrentDemand')) + abs((CLength - GreenTimes5[indexes2[i][1]])*St-Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('CurrentDemand'))+ abs((CLength - GreenTimes5[indexes2[i][1]])*St-Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('CurrentDemand')) +abs(GreenTimes12[indexes2[i][2]]*St-Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('CurrentDemand'))+ abs((CLength - GreenTimes12[indexes2[i][2]])*St-Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('CurrentDemand')) + abs((CLength - GreenTimes12[indexes2[i][2]])*St-Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('CurrentDemand'))+ abs((CLength - GreenTimes12[indexes2[i][2]])*St-Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('CurrentDemand'))+abs(GreenTimes13[indexes2[i][3]]*St-Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('CurrentDemand')) + abs((CLength - GreenTimes13[indexes2[i][3]])*St-Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('CurrentDemand')) + abs((CLength - GreenTimes13[indexes2[i][3]])*St-Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('CurrentDemand'))+ abs((CLength - GreenTimes13[indexes2[i][3]])*St-Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('CurrentDemand'))
            mor.append(mo1)




        finding=[]
        indexes3=[]
        for i in range(len(mor)): 
            if mor[i] == min(mor):
                finding.append(mor[i])
                MG1=GreenTimes1[indexes2[i][0]]
                MG2=GreenTimes5[indexes2[i][1]]
                MG3=GreenTimes12[indexes2[i][2]]
                MG4=GreenTimes13[indexes2[i][3]]
                indexes3.append([indexes2[i][0], indexes2[i][1], indexes2[i][2], indexes2[i][3]])






    
        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+2 > 32:
            koo=max(MG1,30) 
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('GreenTimeDuration',koo)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('GreenTimeDuration',CLength-koo-6)



            
        if Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+2 > 32:
            koo=max(MG2,30)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('GreenTimeDuration',koo)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            kk=0




        if Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+2 > 32:
            koo=max(MG3,30)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('GreenTimeDuration',koo)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('GreenTimeDuration',CLength-koo-6)






        if Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+2 > 32:
            koo=max(MG4,30)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('GreenTimeDuration',koo)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('GreenTimeDuration',CLength-koo-6)        







        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('GreenStart',2)
        ko = Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenStart')
        ko2 = max(ko,32)
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('GreenEnd',ko)
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('GreenEnd',CLength-1)



        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('GreenStart',2)
        ko = Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenStart')
        ko2 = max(ko,32)
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('GreenEnd',ko)
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('GreenEnd',CLength-1)



        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('GreenStart',2)
        ko = Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenStart')
        ko2 = max(ko,32)
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('GreenEnd',ko)
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('GreenEnd',CLength-1)


        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('GreenStart',2)
        ko = Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenStart')
        ko2 = max(ko,32)
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('GreenEnd',ko)
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('GreenEnd',CLength-1)












        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][3]).SetAttValue ('GreenEnd', CLength-1)


        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][3]).SetAttValue ('GreenEnd', CLength-1)


        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][3]).SetAttValue ('GreenEnd', CLength-1)





        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][3]).SetAttValue ('GreenEnd', CLength-1)




        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][3]).SetAttValue ('GreenEnd', CLength-1)



        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][3]).SetAttValue ('GreenEnd', CLength-1)




        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][3]).SetAttValue ('GreenEnd', CLength-1)



        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][3]).SetAttValue ('GreenEnd', CLength-1)





        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][3]).SetAttValue ('GreenEnd', CLength-1)






#fifth time step
    if Seconds>=39 and Seconds<=40:

        L1=[]
        L2=[]
        L3=[]
        L4=[]
        L5=[]
        L6=[]
        L7=[]
        L8=[]
        L9=[]
        L10=[]
        L11=[]
        L12=[]
        L13=[]
        L14=[]
        L15=[]
        L16=[]
        L17=[]
        L18=[]
        L19=[]
        L20=[]
        L21=[]
        L22=[]
        L23=[]
        L24=[]
        L25=[]
        L26=[]
        L27=[]
        L28=[]
        L29=[]
        L30=[]
        L31=[]
        L32=[]
        L33=[]
        L34=[]
        L35=[]
        L36=[]
        L37=[]
        L38=[]
        L39=[]
        L40=[]
        L41=[]
        L42=[]
        L43=[]
        L44=[]
        L45=[]
        L46=[]
        L47=[]
        L48=[]
        L49=[]
        L50=[]
        L51=[]
        L52=[]
        L53=[]
        L54=[]
        L55=[]
        L56=[]
        LL1=[]
        LL2=[]
        LL3=[]
        LL4=[]
        LL5=[]
        LL6=[]
        LL7=[]
        LL8=[]
        LL9=[]
        LL10=[]
        LL11=[]
        LL12=[]
        LL13=[]
        LL14=[]
        LL15=[]
        LL16=[]
        S1=[]
        S2=[]
        S3=[]
        S4=[]
        S5=[]
        S6=[]
        S7=[]
        S8=[]
        S9=[]
        S10=[]
        S11=[]
        S12=[]
        S13=[]
        S14=[]
        S15=[]
        S16=[]
        S17=[]
        S18=[]
        S19=[]
        S20=[]
        S21=[]
        S22=[]
        S23=[]
        S24=[]
        S25=[]
        S26=[]
        S27=[]
        S28=[]
        S29=[]
        S30=[]
        S31=[]
        S32=[]
        S33=[]
        S34=[]
        S35=[]
        S36=[]
        S37=[]
        S38=[]
        S39=[]
        S40=[]
        S41=[]
        S42=[]
        S43=[]
        S44=[]
        S45=[]
        S46=[]
        S47=[]
        S48=[]
        S49=[]
        S50=[]
        S51=[]
        S52=[]
        S53=[]
        S54=[]
        S55=[]
        S56=[]

        for vehAttributes in vehsAttributes:
            if vehAttributes[vehsAttNames['VehType\No']] in vehTypesEquipped:       
                if vehAttributes[vehsAttNames['Pos']] != None:
                    InQueue = vehAttributes[vehsAttNames['InQueue']]               
                    if InQueue == True:
                        DistanceToSigHead = vehAttributes[vehsAttNames['DistanceToSigHead']]
                        Link = vehAttributes[vehsAttNames['Lane\Link']]
                        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('LinkNo',Link)
                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 99:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            L6.append(DistanceToSigHead)
                            D6 = max (L6)
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('len1',len(L6))

                            if len(L6) > 0:
                                k= max(min(round(D6/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D6/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('Joining',mm)
                                

                                    
                            

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 65:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            L7.append(DistanceToSigHead)
                            D7 = max (L7)
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('len1',len(L7))

                            if len(L7) > 0:
                                k= max(min(round(D7/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D7/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('Joining',mm)
                                


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 75:
                            
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            L8.append(DistanceToSigHead)
                            D8 = max(L8)
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('len1',len(L8))

                            if len(L8) > 0:
                                k= max(min(round(D8/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D8/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('Joining',mm)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 102:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            L9.append(DistanceToSigHead)
                            D9 = max (L9)
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('len1',len(L9))


                            if len(L9) > 0:
                                k= max(min(round(D9/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D9/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('Joining',mm)







                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 76:
                            L15.append(DistanceToSigHead)
                            D15 = max (L15)
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('len1',len(L15))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1


                            if len(L15) > 0:
                                k= max(min(round(D15/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D15/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('Joining',mm)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 86:
                            L16.append(DistanceToSigHead)
                            D16 = max (L16)
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('len1',len(L16))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            if len(L16) > 0:
                                k= max(min(round(D16/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D16/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 77:
                            L17.append(DistanceToSigHead)
                            D17 = max (L17)
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('len1',len(L17))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            if len(L17) > 0:
                                k= max(min(round(D17/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D17/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 67:
                            L18.append(DistanceToSigHead)
                            D18 = max (L18)
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('len1',len(L18))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            if len(L18) > 0:
                                k= max(min(round(D18/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D18/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('Joining',mm)








                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 78:
                            L19.append(DistanceToSigHead)
                            D19 = max (L19)
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('len1',len(L19))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            if len(L19) > 0:
                                k= max(min(round(D19/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D19/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 96:
                            L20.append(DistanceToSigHead)
                            D20 = max (L20)
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('len1',len(L20))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1

                            if len(L20) > 0:
                                k= max(min(round(D20/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D20/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 69:
                            L21.append(DistanceToSigHead)
                            D21 = max (L21)
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('len1',len(L21))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            if len(L21) > 0:
                                k= max(min(round(D21/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D21/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 97:
                            L22.append(DistanceToSigHead)
                            D22 = max (L22)
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('len1',len(L22))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1

                            if len(L22) > 0:
                                k= max(min(round(D22/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D22/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('Joining',mm)








                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 70:
                            L28.append(DistanceToSigHead)
                            D28 = max (L28)
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('len1',len(L28))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            if len(L28) > 0:
                                k= max(min(round(D28/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D28/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 87:
                            L29.append(DistanceToSigHead)
                            D29 = max (L29)
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('len1',len(L29))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            if len(L29) > 0:
                                k= max(min(round(D29/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D29/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 63:
                            L30.append(DistanceToSigHead)
                            D30 = max (L30)
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('len1',len(L30))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            if len(L30) > 0:
                                k= max(min(round(D30/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D30/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('Joining',mm)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 82:
                            L31.append(DistanceToSigHead)
                            D31 = max (L31)
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('len1',len(L31))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            if len(L31) > 0:
                                k= max(min(round(D31/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D31/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('Joining',mm)





                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 81:
                            L32.append(DistanceToSigHead)
                            D32 = max (L32)
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('len1',len(L32))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1

                            if len(L32) > 0:
                                k= max(min(round(D32/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D32/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 61:
                            L33.append(DistanceToSigHead)
                            D33 = max (L33)
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('len1',len(L33))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1

                            if len(L33) > 0:
                                k= max(min(round(D33/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D33/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 80:
                            L34.append(DistanceToSigHead)
                            D34 = max (L34)
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('len1',len(L34))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1

                            if len(L34) > 0:
                                k= max(min(round(D34/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D34/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 68:
                            L35.append(DistanceToSigHead)
                            D35 = max (L35)
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('len1',len(L35))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1

                            if len(L35) > 0:
                                k= max(min(round(D35/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D35/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('Joining',mm)







                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 79:
                            L36.append(DistanceToSigHead)
                            D36 = max (L36)
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('len1',len(L36))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1

                            if len(L36) > 0:
                                k= max(min(round(D36/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D36/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('Joining',mm)
                            

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 59:
                            L37.append(DistanceToSigHead)
                            D37 = max (L37)
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('len1',len(L37))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1

                            if len(L37) > 0:
                                k= max(min(round(D37/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D37/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 90:
                            L38.append(DistanceToSigHead)
                            D38 = max (L38)
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('len1',len(L38))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            

                            if len(L38) > 0:
                                k= max(min(round(D38/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D38/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('Joining',mm)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 66:
                            L39.append(DistanceToSigHead)
                            D39 = max (L39)
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('len1',len(L39))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1

                            if len(L39) > 0:
                                k= max(min(round(D39/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D39/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('Joining',mm)









                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 60:
                            L40.append(DistanceToSigHead)
                            D40 = max (L40)
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('len1',len(L40))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1

                            if len(L40) > 0:
                                k= max(min(round(D40/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D40/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 92:
                            L41.append(DistanceToSigHead)
                            D41 = max (L41)
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('len1',len(L41))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1

                            if len(L41) > 0:
                                k= max(min(round(D41/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D41/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 71:
                            L42.append(DistanceToSigHead)
                            D42 = max (L42)
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('len1',len(L42))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1

                            if len(L42) > 0:
                                k= max(min(round(D42/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D42/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 93:
                            L43.append(DistanceToSigHead)
                            D43 = max (L43)
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('len1',len(L43))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1

                            if len(L43) > 0:
                                k= max(min(round(D43/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D43/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('Joining',mm)







                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 72:
                            L44.append(DistanceToSigHead)
                            D44 = max (L44)
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('len1',len(L44))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1

                            if len(L44) > 0:
                                k= max(min(round(D44/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D44/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 62:
                            L45.append(DistanceToSigHead)
                            D45 = max (L45)
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('len1',len(L45))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1

                            if len(L45) > 0:
                                k= max(min(round(D45/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D45/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 73:
                            L46.append(DistanceToSigHead)
                            D46 = max (L46)
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('len1',len(L46))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1

                            if len(L46) > 0:
                                k= max(min(round(D46/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D46/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 83:
                            L47.append(DistanceToSigHead)
                            D47 = max (L47)
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('len1',len(L47))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1

                            if len(L47) > 0:
                                k= max(min(round(D47/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D47/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('Joining',mm)






                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 74:
                            L48.append(DistanceToSigHead)
                            D48 = max (L48)
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('len1',len(L48))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1

                            if len(L48) > 0:
                                k= max(min(round(D48/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D48/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 64:
                            L49.append(DistanceToSigHead)
                            D49 = max (L49)
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('len1',len(L49))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            if len(L49) > 0:
                                k= max(min(round(D49/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D49/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 104:
                            L50.append(DistanceToSigHead)
                            D50 = max (L50)
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('len1',len(L50))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1

                            if len(L50) > 0:
                                k= max(min(round(D50/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D50/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 105:
                            L51.append(DistanceToSigHead)
                            D51 = max (L51)
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('len1',len(L51))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1


                            if len(L51) > 0:
                                k= max(min(round(D51/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D51/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('Joining',mm)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 109:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            LL1.append(DistanceToSigHead)
                            D1 = max (LL1)
                            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('len1',len(LL1))
                            if len(LL1) > 0:
                                k= max(min(round(D1/5),50),1)                                
                                sum1 = 0
                                while k <= 50:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.02)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D1/5),50),1)
                                sum2=0
                                while n <= 50:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.02)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('Joining',mm)
                                

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 91:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            LL2.append(DistanceToSigHead)
                            D2 = max (LL2)
                            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('len1',len(LL2))
                            if len(LL2) > 0:
                                k= max(min(round(D2/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D2/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('Joining',mm)
                                



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 89:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            LL3.append(DistanceToSigHead)
                            D3 = max (LL3)
                            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('len1',len(LL3))
                            if len(LL3) > 0:
                                k= max(min(round(D3/5),10),1)                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D3/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 100:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            LL4.append(DistanceToSigHead)
                            D4 = max (LL4)
                            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('len1',len(LL4))
                            if len(LL4) > 0:
                                k= max(min(round(D4/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D4/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('Joining',mm)












                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 108:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            LL5.append(DistanceToSigHead)
                            D5 = max (LL5)
                            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('len1',len(LL5))
                            if len(LL5) > 0:
                                k= max(min(round(D5/5),50),1)                                
                                sum1 = 0
                                while k <= 50:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.02)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D5/5),50),1)
                                sum2=0
                                while n <= 50:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.02)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('Joining',mm)
                                

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 98:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            LL6.append(DistanceToSigHead)
                            D6 = max (LL6)
                            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('len1',len(LL6))
                            if len(LL6) > 0:
                                k= max(min(round(D6/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D6/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('Joining',mm)
                                



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 88:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            LL7.append(DistanceToSigHead)
                            D7 = max (LL7)
                            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('len1',len(LL7))
                            if len(LL7) > 0:
                                k= max(min(round(D7/5),10),1)                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D7/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 103:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            LL8.append(DistanceToSigHead)
                            D8 = max (LL8)
                            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('len1',len(LL8))
                            if len(LL8) > 0:
                                k= max(min(round(D8/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D8/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('Joining',mm)





                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 112:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            LL9.append(DistanceToSigHead)
                            D9 = max (LL9)
                            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('len1',len(LL9))
                            if len(LL9) > 0:
                                k= max(min(round(D9/5),50),1)                                
                                sum1 = 0
                                while k <= 50:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.02)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D9/5),50),1)
                                sum2=0
                                while n <= 50:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.02)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('Joining',mm)


                                

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 101:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            LL10.append(DistanceToSigHead)
                            D10 = max (LL10)
                            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('len1',len(LL10))
                            if len(LL10) > 0:
                                k= max(min(round(D10/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D10/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('Joining',mm)
                                



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 85:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            LL11.append(DistanceToSigHead)
                            D11 = max (LL11)
                            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('len1',len(LL11))
                            if len(LL11) > 0:
                                k= max(min(round(D11/5),10),1)                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D11/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 95:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            LL12.append(DistanceToSigHead)
                            D12 = max (LL12)
                            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('len1',len(LL12))
                            if len(LL12) > 0:
                                k= max(min(round(D12/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D12/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('Joining',mm)





                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 113:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            LL13.append(DistanceToSigHead)
                            D13 = max (LL13)
                            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('len1',len(LL13))
                            if len(LL13) > 0:
                                k= max(min(round(D13/5),50),1)                                
                                sum1 = 0
                                while k <= 50:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.02)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D13/5),50),1)
                                sum2=0
                                while n <= 50:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.02)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('Joining',mm)


                                

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 106:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            LL14.append(DistanceToSigHead)
                            D14 = max (LL14)
                            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('len1',len(LL14))
                            if len(LL14) > 0:
                                k= max(min(round(D14/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D14/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('Joining',mm)
                                



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 84:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            LL15.append(DistanceToSigHead)
                            D15 = max (LL15)
                            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('len1',len(LL15))
                            if len(LL15) > 0:
                                k= max(min(round(D15/5),10),1)                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D15/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 94:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            LL16.append(DistanceToSigHead)
                            D16 = max (LL16)
                            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('len1',len(LL16))
                            if len(LL16) > 0:
                                k= max(min(round(D16/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D16/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('Joining',mm)




                    else:
                        continue




                    if vehAttributes[vehsAttNames['VehType\No']] in vehTypesSpecial:
                        Link = vehAttributes[vehsAttNames['Lane\Link']]
                        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('LinkNo1',Link)
                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 99:
                            S6.append(1)
                            if len(S6)>0:
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 65:
                            S7.append(1)
                            if len(S7) >0:
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)
                     

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 75:
                            S8.append(1)
                            if len(S8) >0:
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)
                            

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 102:
                            S9.append(1)
                            if len(S9) >0:
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 76:
                            S15.append(1)
                            if len(S15) >0:
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 86:
                            S16.append(1)
                            if len(S16) >0:
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 77:
                            S17.append(1)
                            if len(S17) >0:
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 67:
                            S18.append(1)
                            if len(S18) >0:
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 78:
                            S19.append(1)
                            if len(S19) >0:
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 96:
                            S20.append(1)
                            if len(S20) >0:
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 69:
                            S21.append(1)
                            if len(S21) >0:
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 97:
                            S22.append(1)
                            if len(S22) >0:
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 70:
                            S28.append(1)
                            if len(S28) >0:
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 87:
                            S29.append(1)
                            if len(S29) >0:
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 63:
                            S30.append(1)
                            if len(S30) >0:
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 82:
                            S31.append(1)
                            if len(S31) >0:
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 81:
                            S32.append(1)
                            if len(S32) >0:
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 61:
                            S33.append(1)
                            if len(S33) >0:
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 80:
                            S34.append(1)
                            if len(S34) >0:
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 68:
                            S35.append(1)
                            if len(S35) >0:
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 79:
                            S36.append(1)
                            if len(S36) >0:
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 59:
                            S37.append(1)
                            if len(S37) >0:
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 90:
                            S38.append(1)
                            if len(S38) >0:
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 66:
                            S39.append(1)
                            if len(S39) >0:
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 60:
                            S40.append(1)
                            if len(S40) >0:
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)
 
                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 92:
                            S41.append(1)
                            if len(S41) >0:
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 71:
                            S42.append(1)
                            if len(S42) >0:
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 93:
                            S43.append(1)
                            if len(S43) >0:
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 72:
                            S44.append(1)
                            if len(S44) >0:
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 62:
                            S45.append(1)
                            if len(S45) >0:
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 73:
                            S46.append(1)
                            if len(S46) >0:
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 83:
                            S47.append(1)
                            if len(S47) >0:
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 74:
                            S48.append(1)
                            if len(S48) >0:
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 64:
                            S49.append(1)
                            if len(S49) >0:
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 104:
                            S50.append(1)
                            if len(S50) >0:
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 105:
                            S51.append(1)
                            if len(S51) >0:
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)





        if len(LL1) == 0:
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',2)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('len1',0)
            

        if len(LL2) == 0:
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('len1',0)



        if len(LL3) == 0:
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('len1',0)


        if len(LL4) == 0:
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('len1',0)



        if len(LL5) == 0:
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',2)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('len1',0)

        if len(LL6) == 0:
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('len1',0)


        if len(LL7) == 0:
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('len1',0)



        if len(LL8) == 0:
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('len1',0)


        if len(LL9) == 0:
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',2)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('len1',0)


        if len(LL10) == 0:
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('len1',0)


        if len(LL11) == 0:
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('len1',0)


        if len(LL12) == 0:
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('len1',0)


        if len(LL13) == 0:
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',2)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('len1',0)


        if len(LL14) == 0:
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('len1',0)


        if len(LL15) == 0:
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('len1',0)



        if len(LL16) == 0:
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('len1',0)




        if len(L6)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L7)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('Joining',0)



        if len(L8)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('Joining',0)

        if len(L9)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('Joining',0)


        if len(L15)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('Joining',0)


        if len(L16)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('Joining',0)


        if len(L17)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('Joining',0)


        if len(L18)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('Joining',0)





        if len(L19)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L20)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('Joining',0)

        if len(L21)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('Joining',0)


        if len(L22)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('Joining',0)


        if len(L28)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('Joining',0)




        if len(L29)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('Joining',0)



        if len(L30)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('Joining',0)



        if len(L31)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('Joining',0)




        if len(L32)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('Joining',0)


        if len(L33)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('Joining',0)



        if len(L34)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('Joining',0)


        if len(L35)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('Joining',0)



        if len(L36)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('Joining',0)


        if len(L37)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('Joining',0)



        if len(L38)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L39)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('Joining',0)


        if len(L40)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('Joining',0)



        if len(L41)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L42)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('Joining',0)



        if len(L43)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('Joining',0)


        if len(L44)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L45)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('Joining',0)





        if len(L46)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('Joining',0)


        if len(L47)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('Joining',0)



        if len(L48)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L49)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('Joining',0)



        if len(L50)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('Joining',0)


        if len(L51)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('Joining',0)





        if len(S6)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)




        if len(S7)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)




        if len(S8)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)


        if len(S9)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)



        if len(S15)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)



        if len(S16)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)



        if len(S17)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)



        if len(S18)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)






        if len(S19)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)




        if len(S20)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)


        if len(S21)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)



        if len(S22)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)



        if len(S28)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)





        if len(S29)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)




        if len(S30)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)




        if len(S31)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)





        if len(S32)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)



        if len(S33)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)




        if len(S34)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)



        if len(S35)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)




        if len(S36)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)



        if len(S37)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)




        if len(S38)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)




        if len(S39)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)



        if len(S40)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)




        if len(S41)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)




        if len(S42)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)




        if len(S43)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)



        if len(S44)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)




        if len(S45)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)






        if len(S46)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)



        if len(S47)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)




        if len(S48)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)



        if len(S49)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)



        if len(S49)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)




        if len(S50)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)



        if len(S51)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)




        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('SigState') == 'RED':           
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('Joining')))
            kss1= 14-(Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).AttValue('Queuedup'))
            kss2= 17- (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).AttValue('Queuedup'))
            kss3 = 17- (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).AttValue('Queuedup'))
            kss4= min(kss1,kss2,kss3)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('CurrentSupply',3 * kss4)

            
        else:
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('Joining')))





        if Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('SigState') == 'RED':           
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('Joining')))
            kss11= 14-(Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).AttValue('Queuedup'))
            kss22= 17- (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).AttValue('Queuedup'))
            kss33 = 17- (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).AttValue('Queuedup'))
            kss44= min(kss11,kss22,kss33)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('CurrentSupply',3 * kss44)

        else:
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('Joining')))






        if Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('SigState') == 'RED':           
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('Joining')))
            kss111= 14-(Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss222= 17- (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss333 = 17- (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss444= min(kss111,kss222,kss333)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('CurrentSupply',3 * kss444)

        else:
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('Joining')))




        if Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('SigState') == 'RED':           
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('Joining')))
            kss1111= 14-(Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss2222= 17- (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss3333 = 17- (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss4444= min(kss1111,kss2222,kss3333)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('CurrentSupply',3 * kss4444)

        else:
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('Joining')))

        Aseq=[[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4]]







        GreenTimes = []
        i= GreenMinI2
        while i <= GreenMaxI2:
            GreenTimes.append(i)
            i=i+5


        GreenTimes1 = []
        GreenDemand1 = []
        for i in range(len(GreenTimes)):
            if GreenTimes[i] <= (Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('CurrentSupply')/St2):
                GreenTimes1.append(GreenTimes[i])
                GreenDemand1.append(round(GreenTimes[i]*(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue('ArrivalRate'))))
        if len(GreenTimes1)==0:
            GreenTimes1.append(GreenMinI2)
            GreenDemand1.append(round(GreenMinI2*(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue('ArrivalRate'))))

        GreenTimes11 = []
        GreenDemand11 = []        
        for i in range(len(GreenTimes1)):
            GreenTimes11.append(CLength-GreenTimes1[i])
            GreenDemand11.append(round((CLength-GreenTimes1[i]-6)*(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue('ArrivalRate')+ Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue('ArrivalRate')+Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue('ArrivalRate'))))
                
        GreenTimes5 = []
        GreenDemand5 = []  
        for i in range(len(GreenTimes)):
            if GreenTimes[i] <= (Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('CurrentSupply')/St):
                GreenTimes5.append(GreenTimes[i])
                GreenDemand5.append(round(GreenTimes[i]*(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue('ArrivalRate'))))

        if len(GreenTimes5)==0:
            GreenTimes5.append(GreenMinI2)
            GreenDemand5.append(round(GreenMinI2*(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue('ArrivalRate'))))

        GreenDemand51 = []  
        GreenTimes51 = []
        for i in range(len(GreenTimes5)):
            GreenTimes51.append(CLength-GreenTimes5[i])
            GreenDemand51.append(round((CLength-GreenTimes5[i]-6)*(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue('ArrivalRate')+ Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue('ArrivalRate')+Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue('ArrivalRate'))))


        GreenTimes12 = []
        GreenDemand12 = [] 
        for i in range(len(GreenTimes)):
            if GreenTimes[i] <= (Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('CurrentSupply')/St):
                GreenTimes12.append(GreenTimes[i])
                GreenDemand12.append(round(GreenTimes[i]*(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue('ArrivalRate'))))

        if len(GreenTimes12)==0:
            GreenTimes12.append(GreenMinI2)
            GreenDemand12.append(round(GreenMinI2*(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue('ArrivalRate'))))


        GreenTimes121 = []
        GreenDemand121 = []
        for i in range(len(GreenTimes12)): 
            GreenTimes121.append(CLength-GreenTimes12[i])
            GreenDemand121.append(round((CLength-GreenTimes12[i]-6)*(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue('ArrivalRate')+ Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue('ArrivalRate')+Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue('ArrivalRate'))))





        GreenTimes13 = []
        GreenDemand13 = [] 
        for i in range(len(GreenTimes)):
            if GreenTimes[i] <= (Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('CurrentSupply')/St):
                GreenTimes13.append(GreenTimes[i])
                GreenDemand13.append(round(GreenTimes[i]*(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue('ArrivalRate'))))

        if len(GreenTimes13)==0:
            GreenTimes13.append(GreenMinI2)
            GreenDemand13.append(round(GreenMinI2*(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue('ArrivalRate'))))



        GreenTimes131 = []
        GreenDemand131 = []
        for i in range(len(GreenTimes13)):
            GreenTimes131.append(CLength-GreenTimes13[i])
            GreenDemand131.append(round((CLength-GreenTimes13[i]-6)*(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue('ArrivalRate')+ Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue('ArrivalRate')+Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue('ArrivalRate'))))






        incoming1=[]
        outgoing1=[]
        content1=[]
        for i in range(len(GreenTimes1)):
            in1 = Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('CurrentDemand')+ GreenDemand1[i]
            in2 = GreenTimes1[i] * St2
            in3 = min(in1,in2)
            incoming1.append(in3)
            out1 = Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('CurrentDemand')+ Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('CurrentDemand')+ Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('CurrentDemand')+ GreenDemand11[i]
            out2 = GreenTimes11[i] * St2
            out3 = min(out1,out2)
            outgoing1.append(out3)
            content1.append(in3-out3)



        incoming5=[]
        outgoing5=[]
        content5=[]
        for i in range(len(GreenTimes5)):
            in1 = Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('CurrentDemand')+ GreenDemand5[i]
            in2 = GreenTimes5[i] * St2
            in3 = min(in1,in2)
            incoming5.append(in3)
            out1 = Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('CurrentDemand')+ GreenDemand51[i]
            out2 = GreenTimes51[i] * St2
            out3 = min(out1,out2)
            outgoing5.append(out3)
            content5.append(in3-out3)


        incoming12=[]
        outgoing12=[]
        content12=[]
        for i in range(len(GreenTimes12)):
            in1 = Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('CurrentDemand')+ GreenDemand12[i]
            in2 = GreenTimes12[i] * St2
            in3 = min(in1,in2)
            incoming12.append(in3)
            out1 = Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('CurrentDemand')+ GreenDemand121[i]
            out2 = GreenTimes121[i] * St2
            out3 = min(out1,out2)
            outgoing12.append(out3)
            content12.append(in3-out3)



        incoming13=[]
        outgoing13=[]
        content13=[]
        for i in range(len(GreenTimes13)):
            in1 = Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('CurrentDemand')+ GreenDemand13[i]
            in2 = GreenTimes13[i] * St2
            in3 = min(in1,in2)
            incoming13.append(in3)
            out1 = Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('CurrentDemand')+ GreenDemand131[i]
            out2 = GreenTimes131[i] * St2
            out3 = min(out1,out2)
            outgoing13.append(out3)
            content13.append(in3-out3)

        kk=0
        for x in LinkAttributes:
            kk= kk + x[LinAttNames['Count:Vehs']]
        density = kk  - Vissim.Net.Links.ItemByKey(107).AttValue ('Count:Vehs') - Vissim.Net.Links.ItemByKey(108).AttValue ('Count:Vehs') - Vissim.Net.Links.ItemByKey(109).AttValue ('Count:Vehs')- Vissim.Net.Links.ItemByKey(110).AttValue ('Count:Vehs')- Vissim.Net.Links.ItemByKey(111).AttValue ('Count:Vehs')- Vissim.Net.Links.ItemByKey(112).AttValue ('Count:Vehs')- Vissim.Net.Links.ItemByKey(113).AttValue ('Count:Vehs')-- Vissim.Net.Links.ItemByKey(114).AttValue ('Count:Vehs')

        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue('SystemContent',density)

        scc=[]
        scc2=[]        
        indexes=[]
        mmmm = Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue('SystemContent')
        for i in range(len(content1)):
            for j in range(len(content5)):
                for k in range(len(content12)):
                    for m in range(len(content13)):
                        scc1 = abs(Kq - (mmmm + content1[i] + content5[j] + content12[k] + content13[m]))
                        scc2.append(scc1)
                        indexes.append([i,j,k,m])



        minimals=[]
        indexes2=[]
        for i in range(len(scc2)):
            if scc2[i]== min(scc2):
                minimals.append(scc2[i])
                indexes2.append(indexes[i])

        mor=[]
        for i in range(len(minimals)):
            mo1 = abs(GreenTimes1[indexes2[i][0]]*St-Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('CurrentDemand'))+ abs((CLength-GreenTimes1[indexes2[i][0]])*St-Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('CurrentDemand')) + abs((CLength-GreenTimes1[indexes2[i][0]])*St-Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('CurrentDemand'))+ abs((CLength-GreenTimes1[indexes2[i][0]])*St-Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('CurrentDemand')) + abs(GreenTimes5[indexes2[i][1]]*St-Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('CurrentDemand'))+ abs((CLength - GreenTimes5[indexes2[i][1]])*St-Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('CurrentDemand')) + abs((CLength - GreenTimes5[indexes2[i][1]])*St-Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('CurrentDemand'))+ abs((CLength - GreenTimes5[indexes2[i][1]])*St-Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('CurrentDemand')) +abs(GreenTimes12[indexes2[i][2]]*St-Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('CurrentDemand'))+ abs((CLength - GreenTimes12[indexes2[i][2]])*St-Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('CurrentDemand')) + abs((CLength - GreenTimes12[indexes2[i][2]])*St-Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('CurrentDemand'))+ abs((CLength - GreenTimes12[indexes2[i][2]])*St-Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('CurrentDemand'))+abs(GreenTimes13[indexes2[i][3]]*St-Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('CurrentDemand')) + abs((CLength - GreenTimes13[indexes2[i][3]])*St-Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('CurrentDemand')) + abs((CLength - GreenTimes13[indexes2[i][3]])*St-Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('CurrentDemand'))+ abs((CLength - GreenTimes13[indexes2[i][3]])*St-Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('CurrentDemand'))
            mor.append(mo1)




        finding=[]
        indexes3=[]
        for i in range(len(mor)): 
            if mor[i] == min(mor):
                finding.append(mor[i])
                MG1=GreenTimes1[indexes2[i][0]]
                MG2=GreenTimes5[indexes2[i][1]]
                MG3=GreenTimes12[indexes2[i][2]]
                MG4=GreenTimes13[indexes2[i][3]]
                indexes3.append([indexes2[i][0], indexes2[i][1], indexes2[i][2], indexes2[i][3]])






    
        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+2 > 42:
            koo=max(MG1,40) 
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('GreenTimeDuration',koo)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('GreenTimeDuration',CLength-koo-6)



            
        if Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+2 > 42:
            koo=max(MG2,40)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('GreenTimeDuration',koo)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            kk=0




        if Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+2 > 42:
            koo=max(MG3,40)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('GreenTimeDuration',koo)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('GreenTimeDuration',CLength-koo-6)






        if Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+2 > 42:
            koo=max(MG4,40)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('GreenTimeDuration',koo)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('GreenTimeDuration',CLength-koo-6)        







        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('GreenStart',2)
        ko = Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenStart')
        ko2 = max(ko,42)
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('GreenEnd',ko)
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('GreenEnd',CLength-1)



        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('GreenStart',2)
        ko = Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenStart')
        ko2 = max(ko,42)
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('GreenEnd',ko)
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('GreenEnd',CLength-1)



        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('GreenStart',2)
        ko = Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenStart')
        ko2 = max(ko,42)
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('GreenEnd',ko)
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('GreenEnd',CLength-1)


        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('GreenStart',2)
        ko = Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenStart')
        ko2 = max(ko,42)
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('GreenEnd',ko)
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('GreenEnd',CLength-1)









        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][3]).SetAttValue ('GreenEnd', CLength-1)


        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][3]).SetAttValue ('GreenEnd', CLength-1)


        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][3]).SetAttValue ('GreenEnd', CLength-1)





        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][3]).SetAttValue ('GreenEnd', CLength-1)




        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][3]).SetAttValue ('GreenEnd', CLength-1)



        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][3]).SetAttValue ('GreenEnd', CLength-1)




        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][3]).SetAttValue ('GreenEnd', CLength-1)



        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][3]).SetAttValue ('GreenEnd', CLength-1)





        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][3]).SetAttValue ('GreenEnd', CLength-1)















#sixth time step
    if Seconds>=49 and Seconds<=50:

        L1=[]
        L2=[]
        L3=[]
        L4=[]
        L5=[]
        L6=[]
        L7=[]
        L8=[]
        L9=[]
        L10=[]
        L11=[]
        L12=[]
        L13=[]
        L14=[]
        L15=[]
        L16=[]
        L17=[]
        L18=[]
        L19=[]
        L20=[]
        L21=[]
        L22=[]
        L23=[]
        L24=[]
        L25=[]
        L26=[]
        L27=[]
        L28=[]
        L29=[]
        L30=[]
        L31=[]
        L32=[]
        L33=[]
        L34=[]
        L35=[]
        L36=[]
        L37=[]
        L38=[]
        L39=[]
        L40=[]
        L41=[]
        L42=[]
        L43=[]
        L44=[]
        L45=[]
        L46=[]
        L47=[]
        L48=[]
        L49=[]
        L50=[]
        L51=[]
        L52=[]
        L53=[]
        L54=[]
        L55=[]
        L56=[]
        LL1=[]
        LL2=[]
        LL3=[]
        LL4=[]
        LL5=[]
        LL6=[]
        LL7=[]
        LL8=[]
        LL9=[]
        LL10=[]
        LL11=[]
        LL12=[]
        LL13=[]
        LL14=[]
        LL15=[]
        LL16=[]
        S1=[]
        S2=[]
        S3=[]
        S4=[]
        S5=[]
        S6=[]
        S7=[]
        S8=[]
        S9=[]
        S10=[]
        S11=[]
        S12=[]
        S13=[]
        S14=[]
        S15=[]
        S16=[]
        S17=[]
        S18=[]
        S19=[]
        S20=[]
        S21=[]
        S22=[]
        S23=[]
        S24=[]
        S25=[]
        S26=[]
        S27=[]
        S28=[]
        S29=[]
        S30=[]
        S31=[]
        S32=[]
        S33=[]
        S34=[]
        S35=[]
        S36=[]
        S37=[]
        S38=[]
        S39=[]
        S40=[]
        S41=[]
        S42=[]
        S43=[]
        S44=[]
        S45=[]
        S46=[]
        S47=[]
        S48=[]
        S49=[]
        S50=[]
        S51=[]
        S52=[]
        S53=[]
        S54=[]
        S55=[]
        S56=[]

        for vehAttributes in vehsAttributes:
            if vehAttributes[vehsAttNames['VehType\No']] in vehTypesEquipped:       
                if vehAttributes[vehsAttNames['Pos']] != None:
                    InQueue = vehAttributes[vehsAttNames['InQueue']]               
                    if InQueue == True:
                        DistanceToSigHead = vehAttributes[vehsAttNames['DistanceToSigHead']]
                        Link = vehAttributes[vehsAttNames['Lane\Link']]
                        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('LinkNo',Link)
                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 99:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            L6.append(DistanceToSigHead)
                            D6 = max (L6)
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('len1',len(L6))

                            if len(L6) > 0:
                                k= max(min(round(D6/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D6/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('Joining',mm)
                                

                                    
                            

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 65:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            L7.append(DistanceToSigHead)
                            D7 = max (L7)
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('len1',len(L7))

                            if len(L7) > 0:
                                k= max(min(round(D7/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D7/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('Joining',mm)
                                


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 75:
                            
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            L8.append(DistanceToSigHead)
                            D8 = max(L8)
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('len1',len(L8))

                            if len(L8) > 0:
                                k= max(min(round(D8/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D8/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('Joining',mm)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 102:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            L9.append(DistanceToSigHead)
                            D9 = max (L9)
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('len1',len(L9))


                            if len(L9) > 0:
                                k= max(min(round(D9/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D9/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('Joining',mm)







                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 76:
                            L15.append(DistanceToSigHead)
                            D15 = max (L15)
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('len1',len(L15))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1


                            if len(L15) > 0:
                                k= max(min(round(D15/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D15/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('Joining',mm)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 86:
                            L16.append(DistanceToSigHead)
                            D16 = max (L16)
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('len1',len(L16))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            if len(L16) > 0:
                                k= max(min(round(D16/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D16/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 77:
                            L17.append(DistanceToSigHead)
                            D17 = max (L17)
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('len1',len(L17))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            if len(L17) > 0:
                                k= max(min(round(D17/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D17/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 67:
                            L18.append(DistanceToSigHead)
                            D18 = max (L18)
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('len1',len(L18))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            if len(L18) > 0:
                                k= max(min(round(D18/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D18/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('Joining',mm)








                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 78:
                            L19.append(DistanceToSigHead)
                            D19 = max (L19)
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('len1',len(L19))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            if len(L19) > 0:
                                k= max(min(round(D19/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D19/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 96:
                            L20.append(DistanceToSigHead)
                            D20 = max (L20)
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('len1',len(L20))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1

                            if len(L20) > 0:
                                k= max(min(round(D20/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D20/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 69:
                            L21.append(DistanceToSigHead)
                            D21 = max (L21)
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('len1',len(L21))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            if len(L21) > 0:
                                k= max(min(round(D21/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D21/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 97:
                            L22.append(DistanceToSigHead)
                            D22 = max (L22)
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('len1',len(L22))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1

                            if len(L22) > 0:
                                k= max(min(round(D22/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D22/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('Joining',mm)








                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 70:
                            L28.append(DistanceToSigHead)
                            D28 = max (L28)
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('len1',len(L28))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            if len(L28) > 0:
                                k= max(min(round(D28/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D28/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 87:
                            L29.append(DistanceToSigHead)
                            D29 = max (L29)
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('len1',len(L29))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            if len(L29) > 0:
                                k= max(min(round(D29/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D29/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 63:
                            L30.append(DistanceToSigHead)
                            D30 = max (L30)
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('len1',len(L30))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            if len(L30) > 0:
                                k= max(min(round(D30/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D30/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('Joining',mm)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 82:
                            L31.append(DistanceToSigHead)
                            D31 = max (L31)
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('len1',len(L31))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            if len(L31) > 0:
                                k= max(min(round(D31/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D31/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('Joining',mm)





                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 81:
                            L32.append(DistanceToSigHead)
                            D32 = max (L32)
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('len1',len(L32))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1

                            if len(L32) > 0:
                                k= max(min(round(D32/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D32/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 61:
                            L33.append(DistanceToSigHead)
                            D33 = max (L33)
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('len1',len(L33))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1

                            if len(L33) > 0:
                                k= max(min(round(D33/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D33/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 80:
                            L34.append(DistanceToSigHead)
                            D34 = max (L34)
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('len1',len(L34))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1

                            if len(L34) > 0:
                                k= max(min(round(D34/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D34/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 68:
                            L35.append(DistanceToSigHead)
                            D35 = max (L35)
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('len1',len(L35))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1

                            if len(L35) > 0:
                                k= max(min(round(D35/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D35/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('Joining',mm)







                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 79:
                            L36.append(DistanceToSigHead)
                            D36 = max (L36)
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('len1',len(L36))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1

                            if len(L36) > 0:
                                k= max(min(round(D36/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D36/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('Joining',mm)
                            

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 59:
                            L37.append(DistanceToSigHead)
                            D37 = max (L37)
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('len1',len(L37))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1

                            if len(L37) > 0:
                                k= max(min(round(D37/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D37/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 90:
                            L38.append(DistanceToSigHead)
                            D38 = max (L38)
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('len1',len(L38))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            

                            if len(L38) > 0:
                                k= max(min(round(D38/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D38/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('Joining',mm)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 66:
                            L39.append(DistanceToSigHead)
                            D39 = max (L39)
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('len1',len(L39))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1

                            if len(L39) > 0:
                                k= max(min(round(D39/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D39/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('Joining',mm)









                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 60:
                            L40.append(DistanceToSigHead)
                            D40 = max (L40)
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('len1',len(L40))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1

                            if len(L40) > 0:
                                k= max(min(round(D40/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D40/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 92:
                            L41.append(DistanceToSigHead)
                            D41 = max (L41)
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('len1',len(L41))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1

                            if len(L41) > 0:
                                k= max(min(round(D41/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D41/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 71:
                            L42.append(DistanceToSigHead)
                            D42 = max (L42)
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('len1',len(L42))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1

                            if len(L42) > 0:
                                k= max(min(round(D42/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D42/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 93:
                            L43.append(DistanceToSigHead)
                            D43 = max (L43)
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('len1',len(L43))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1

                            if len(L43) > 0:
                                k= max(min(round(D43/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D43/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('Joining',mm)







                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 72:
                            L44.append(DistanceToSigHead)
                            D44 = max (L44)
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('len1',len(L44))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1

                            if len(L44) > 0:
                                k= max(min(round(D44/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D44/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 62:
                            L45.append(DistanceToSigHead)
                            D45 = max (L45)
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('len1',len(L45))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1

                            if len(L45) > 0:
                                k= max(min(round(D45/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D45/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 73:
                            L46.append(DistanceToSigHead)
                            D46 = max (L46)
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('len1',len(L46))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1

                            if len(L46) > 0:
                                k= max(min(round(D46/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D46/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 83:
                            L47.append(DistanceToSigHead)
                            D47 = max (L47)
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('len1',len(L47))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1

                            if len(L47) > 0:
                                k= max(min(round(D47/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D47/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('Joining',mm)






                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 74:
                            L48.append(DistanceToSigHead)
                            D48 = max (L48)
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('len1',len(L48))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1

                            if len(L48) > 0:
                                k= max(min(round(D48/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D48/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 64:
                            L49.append(DistanceToSigHead)
                            D49 = max (L49)
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('len1',len(L49))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            if len(L49) > 0:
                                k= max(min(round(D49/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D49/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 104:
                            L50.append(DistanceToSigHead)
                            D50 = max (L50)
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('len1',len(L50))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1

                            if len(L50) > 0:
                                k= max(min(round(D50/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D50/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 105:
                            L51.append(DistanceToSigHead)
                            D51 = max (L51)
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('len1',len(L51))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1


                            if len(L51) > 0:
                                k= max(min(round(D51/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D51/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('Joining',mm)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 109:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            LL1.append(DistanceToSigHead)
                            D1 = max (LL1)
                            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('len1',len(LL1))
                            if len(LL1) > 0:
                                k= max(min(round(D1/5),50),1)                                
                                sum1 = 0
                                while k <= 50:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.02)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D1/5),50),1)
                                sum2=0
                                while n <= 50:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.02)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('Joining',mm)
                                

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 91:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            LL2.append(DistanceToSigHead)
                            D2 = max (LL2)
                            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('len1',len(LL2))
                            if len(LL2) > 0:
                                k= max(min(round(D2/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D2/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('Joining',mm)
                                



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 89:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            LL3.append(DistanceToSigHead)
                            D3 = max (LL3)
                            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('len1',len(LL3))
                            if len(LL3) > 0:
                                k= max(min(round(D3/5),10),1)                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D3/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 100:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            LL4.append(DistanceToSigHead)
                            D4 = max (LL4)
                            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('len1',len(LL4))
                            if len(LL4) > 0:
                                k= max(min(round(D4/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D4/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('Joining',mm)












                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 108:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            LL5.append(DistanceToSigHead)
                            D5 = max (LL5)
                            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('len1',len(LL5))
                            if len(LL5) > 0:
                                k= max(min(round(D5/5),50),1)                                
                                sum1 = 0
                                while k <= 50:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.02)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D5/5),50),1)
                                sum2=0
                                while n <= 50:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.02)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('Joining',mm)
                                

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 98:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            LL6.append(DistanceToSigHead)
                            D6 = max (LL6)
                            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('len1',len(LL6))
                            if len(LL6) > 0:
                                k= max(min(round(D6/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D6/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('Joining',mm)
                                



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 88:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            LL7.append(DistanceToSigHead)
                            D7 = max (LL7)
                            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('len1',len(LL7))
                            if len(LL7) > 0:
                                k= max(min(round(D7/5),10),1)                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D7/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 103:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            LL8.append(DistanceToSigHead)
                            D8 = max (LL8)
                            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('len1',len(LL8))
                            if len(LL8) > 0:
                                k= max(min(round(D8/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D8/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('Joining',mm)





                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 112:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            LL9.append(DistanceToSigHead)
                            D9 = max (LL9)
                            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('len1',len(LL9))
                            if len(LL9) > 0:
                                k= max(min(round(D9/5),50),1)                                
                                sum1 = 0
                                while k <= 50:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.02)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D9/5),50),1)
                                sum2=0
                                while n <= 50:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.02)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('Joining',mm)


                                

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 101:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            LL10.append(DistanceToSigHead)
                            D10 = max (LL10)
                            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('len1',len(LL10))
                            if len(LL10) > 0:
                                k= max(min(round(D10/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D10/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('Joining',mm)
                                



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 85:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            LL11.append(DistanceToSigHead)
                            D11 = max (LL11)
                            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('len1',len(LL11))
                            if len(LL11) > 0:
                                k= max(min(round(D11/5),10),1)                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D11/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 95:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            LL12.append(DistanceToSigHead)
                            D12 = max (LL12)
                            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('len1',len(LL12))
                            if len(LL12) > 0:
                                k= max(min(round(D12/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D12/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('Joining',mm)





                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 113:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            LL13.append(DistanceToSigHead)
                            D13 = max (LL13)
                            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('len1',len(LL13))
                            if len(LL13) > 0:
                                k= max(min(round(D13/5),50),1)                                
                                sum1 = 0
                                while k <= 50:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.02)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D13/5),50),1)
                                sum2=0
                                while n <= 50:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.02)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('Joining',mm)


                                

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 106:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            LL14.append(DistanceToSigHead)
                            D14 = max (LL14)
                            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('len1',len(LL14))
                            if len(LL14) > 0:
                                k= max(min(round(D14/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D14/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('Joining',mm)
                                



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 84:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            LL15.append(DistanceToSigHead)
                            D15 = max (LL15)
                            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('len1',len(LL15))
                            if len(LL15) > 0:
                                k= max(min(round(D15/5),10),1)                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D15/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 94:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            LL16.append(DistanceToSigHead)
                            D16 = max (LL16)
                            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('len1',len(LL16))
                            if len(LL16) > 0:
                                k= max(min(round(D16/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D16/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('Joining',mm)




                    else:
                        continue




                    if vehAttributes[vehsAttNames['VehType\No']] in vehTypesSpecial:
                        Link = vehAttributes[vehsAttNames['Lane\Link']]
                        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('LinkNo1',Link)
                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 99:
                            S6.append(1)
                            if len(S6)>0:
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 65:
                            S7.append(1)
                            if len(S7) >0:
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)
                     

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 75:
                            S8.append(1)
                            if len(S8) >0:
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)
                            

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 102:
                            S9.append(1)
                            if len(S9) >0:
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 76:
                            S15.append(1)
                            if len(S15) >0:
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 86:
                            S16.append(1)
                            if len(S16) >0:
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 77:
                            S17.append(1)
                            if len(S17) >0:
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 67:
                            S18.append(1)
                            if len(S18) >0:
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 78:
                            S19.append(1)
                            if len(S19) >0:
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 96:
                            S20.append(1)
                            if len(S20) >0:
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 69:
                            S21.append(1)
                            if len(S21) >0:
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 97:
                            S22.append(1)
                            if len(S22) >0:
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 70:
                            S28.append(1)
                            if len(S28) >0:
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 87:
                            S29.append(1)
                            if len(S29) >0:
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 63:
                            S30.append(1)
                            if len(S30) >0:
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 82:
                            S31.append(1)
                            if len(S31) >0:
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 81:
                            S32.append(1)
                            if len(S32) >0:
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 61:
                            S33.append(1)
                            if len(S33) >0:
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 80:
                            S34.append(1)
                            if len(S34) >0:
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 68:
                            S35.append(1)
                            if len(S35) >0:
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 79:
                            S36.append(1)
                            if len(S36) >0:
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 59:
                            S37.append(1)
                            if len(S37) >0:
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 90:
                            S38.append(1)
                            if len(S38) >0:
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 66:
                            S39.append(1)
                            if len(S39) >0:
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 60:
                            S40.append(1)
                            if len(S40) >0:
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)
 
                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 92:
                            S41.append(1)
                            if len(S41) >0:
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 71:
                            S42.append(1)
                            if len(S42) >0:
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 93:
                            S43.append(1)
                            if len(S43) >0:
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 72:
                            S44.append(1)
                            if len(S44) >0:
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 62:
                            S45.append(1)
                            if len(S45) >0:
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 73:
                            S46.append(1)
                            if len(S46) >0:
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 83:
                            S47.append(1)
                            if len(S47) >0:
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 74:
                            S48.append(1)
                            if len(S48) >0:
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 64:
                            S49.append(1)
                            if len(S49) >0:
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 104:
                            S50.append(1)
                            if len(S50) >0:
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 105:
                            S51.append(1)
                            if len(S51) >0:
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)





        if len(LL1) == 0:
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',2)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('len1',0)
            

        if len(LL2) == 0:
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('len1',0)



        if len(LL3) == 0:
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('len1',0)


        if len(LL4) == 0:
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('len1',0)



        if len(LL5) == 0:
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',2)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('len1',0)

        if len(LL6) == 0:
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('len1',0)


        if len(LL7) == 0:
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('len1',0)



        if len(LL8) == 0:
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('len1',0)


        if len(LL9) == 0:
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',2)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('len1',0)


        if len(LL10) == 0:
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('len1',0)


        if len(LL11) == 0:
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('len1',0)


        if len(LL12) == 0:
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('len1',0)


        if len(LL13) == 0:
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',2)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('len1',0)


        if len(LL14) == 0:
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('len1',0)


        if len(LL15) == 0:
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('len1',0)



        if len(LL16) == 0:
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('len1',0)




        if len(L6)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L7)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('Joining',0)



        if len(L8)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('Joining',0)

        if len(L9)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('Joining',0)


        if len(L15)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('Joining',0)


        if len(L16)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('Joining',0)


        if len(L17)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('Joining',0)


        if len(L18)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('Joining',0)





        if len(L19)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L20)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('Joining',0)

        if len(L21)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('Joining',0)


        if len(L22)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('Joining',0)


        if len(L28)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('Joining',0)




        if len(L29)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('Joining',0)



        if len(L30)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('Joining',0)



        if len(L31)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('Joining',0)




        if len(L32)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('Joining',0)


        if len(L33)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('Joining',0)



        if len(L34)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('Joining',0)


        if len(L35)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('Joining',0)



        if len(L36)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('Joining',0)


        if len(L37)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('Joining',0)



        if len(L38)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L39)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('Joining',0)


        if len(L40)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('Joining',0)



        if len(L41)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L42)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('Joining',0)



        if len(L43)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('Joining',0)


        if len(L44)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L45)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('Joining',0)





        if len(L46)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('Joining',0)


        if len(L47)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('Joining',0)



        if len(L48)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L49)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('Joining',0)



        if len(L50)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('Joining',0)


        if len(L51)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('Joining',0)





        if len(S6)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)




        if len(S7)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)




        if len(S8)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)


        if len(S9)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)



        if len(S15)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)



        if len(S16)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)



        if len(S17)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)



        if len(S18)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)






        if len(S19)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)




        if len(S20)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)


        if len(S21)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)



        if len(S22)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)



        if len(S28)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)





        if len(S29)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)




        if len(S30)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)




        if len(S31)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)





        if len(S32)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)



        if len(S33)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)




        if len(S34)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)



        if len(S35)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)




        if len(S36)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)



        if len(S37)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)




        if len(S38)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)




        if len(S39)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)



        if len(S40)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)




        if len(S41)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)




        if len(S42)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)




        if len(S43)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)



        if len(S44)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)




        if len(S45)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)






        if len(S46)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)



        if len(S47)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)




        if len(S48)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)



        if len(S49)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)



        if len(S49)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)




        if len(S50)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)



        if len(S51)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)




        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('SigState') == 'RED':           
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('Joining')))
            kss1= 14-(Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).AttValue('Queuedup'))
            kss2= 17- (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).AttValue('Queuedup'))
            kss3 = 17- (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).AttValue('Queuedup'))
            kss4= min(kss1,kss2,kss3)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('CurrentSupply',3 * kss4)

            
        else:
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('Joining')))





        if Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('SigState') == 'RED':           
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('Joining')))
            kss11= 14-(Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).AttValue('Queuedup'))
            kss22= 17- (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).AttValue('Queuedup'))
            kss33 = 17- (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).AttValue('Queuedup'))
            kss44= min(kss11,kss22,kss33)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('CurrentSupply',3 * kss44)

        else:
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('Joining')))






        if Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('SigState') == 'RED':           
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('Joining')))
            kss111= 14-(Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss222= 17- (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss333 = 17- (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss444= min(kss111,kss222,kss333)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('CurrentSupply',3 * kss444)

        else:
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('Joining')))




        if Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('SigState') == 'RED':           
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('Joining')))
            kss1111= 14-(Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss2222= 17- (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss3333 = 17- (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss4444= min(kss1111,kss2222,kss3333)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('CurrentSupply',3 * kss4444)

        else:
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('Joining')))

        Aseq=[[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4]]




        GreenTimes = []
        i= GreenMinI2
        while i <= GreenMaxI2:
            GreenTimes.append(i)
            i=i+5


        GreenTimes1 = []
        GreenDemand1 = []
        for i in range(len(GreenTimes)):
            if GreenTimes[i] <= (Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('CurrentSupply')/St2):
                GreenTimes1.append(GreenTimes[i])
                GreenDemand1.append(round(GreenTimes[i]*(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue('ArrivalRate'))))
        if len(GreenTimes1)==0:
            GreenTimes1.append(GreenMinI2)
            GreenDemand1.append(round(GreenMinI2*(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue('ArrivalRate'))))

        GreenTimes11 = []
        GreenDemand11 = []        
        for i in range(len(GreenTimes1)):
            GreenTimes11.append(CLength-GreenTimes1[i])
            GreenDemand11.append(round((CLength-GreenTimes1[i]-6)*(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue('ArrivalRate')+ Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue('ArrivalRate')+Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue('ArrivalRate'))))
                
        GreenTimes5 = []
        GreenDemand5 = []  
        for i in range(len(GreenTimes)):
            if GreenTimes[i] <= (Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('CurrentSupply')/St):
                GreenTimes5.append(GreenTimes[i])
                GreenDemand5.append(round(GreenTimes[i]*(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue('ArrivalRate'))))

        if len(GreenTimes5)==0:
            GreenTimes5.append(GreenMinI2)
            GreenDemand5.append(round(GreenMinI2*(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue('ArrivalRate'))))

        GreenDemand51 = []  
        GreenTimes51 = []
        for i in range(len(GreenTimes5)):
            GreenTimes51.append(CLength-GreenTimes5[i])
            GreenDemand51.append(round((CLength-GreenTimes5[i]-6)*(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue('ArrivalRate')+ Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue('ArrivalRate')+Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue('ArrivalRate'))))


        GreenTimes12 = []
        GreenDemand12 = [] 
        for i in range(len(GreenTimes)):
            if GreenTimes[i] <= (Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('CurrentSupply')/St):
                GreenTimes12.append(GreenTimes[i])
                GreenDemand12.append(round(GreenTimes[i]*(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue('ArrivalRate'))))

        if len(GreenTimes12)==0:
            GreenTimes12.append(GreenMinI2)
            GreenDemand12.append(round(GreenMinI2*(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue('ArrivalRate'))))


        GreenTimes121 = []
        GreenDemand121 = []
        for i in range(len(GreenTimes12)): 
            GreenTimes121.append(CLength-GreenTimes12[i])
            GreenDemand121.append(round((CLength-GreenTimes12[i]-6)*(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue('ArrivalRate')+ Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue('ArrivalRate')+Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue('ArrivalRate'))))





        GreenTimes13 = []
        GreenDemand13 = [] 
        for i in range(len(GreenTimes)):
            if GreenTimes[i] <= (Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('CurrentSupply')/St):
                GreenTimes13.append(GreenTimes[i])
                GreenDemand13.append(round(GreenTimes[i]*(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue('ArrivalRate'))))

        if len(GreenTimes13)==0:
            GreenTimes13.append(GreenMinI2)
            GreenDemand13.append(round(GreenMinI2*(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue('ArrivalRate'))))



        GreenTimes131 = []
        GreenDemand131 = []
        for i in range(len(GreenTimes13)):
            GreenTimes131.append(CLength-GreenTimes13[i])
            GreenDemand131.append(round((CLength-GreenTimes13[i]-6)*(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue('ArrivalRate')+ Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue('ArrivalRate')+Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue('ArrivalRate'))))






        incoming1=[]
        outgoing1=[]
        content1=[]
        for i in range(len(GreenTimes1)):
            in1 = Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('CurrentDemand')+ GreenDemand1[i]
            in2 = GreenTimes1[i] * St2
            in3 = min(in1,in2)
            incoming1.append(in3)
            out1 = Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('CurrentDemand')+ Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('CurrentDemand')+ Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('CurrentDemand')+ GreenDemand11[i]
            out2 = GreenTimes11[i] * St2
            out3 = min(out1,out2)
            outgoing1.append(out3)
            content1.append(in3-out3)



        incoming5=[]
        outgoing5=[]
        content5=[]
        for i in range(len(GreenTimes5)):
            in1 = Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('CurrentDemand')+ GreenDemand5[i]
            in2 = GreenTimes5[i] * St2
            in3 = min(in1,in2)
            incoming5.append(in3)
            out1 = Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('CurrentDemand')+ GreenDemand51[i]
            out2 = GreenTimes51[i] * St2
            out3 = min(out1,out2)
            outgoing5.append(out3)
            content5.append(in3-out3)


        incoming12=[]
        outgoing12=[]
        content12=[]
        for i in range(len(GreenTimes12)):
            in1 = Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('CurrentDemand')+ GreenDemand12[i]
            in2 = GreenTimes12[i] * St2
            in3 = min(in1,in2)
            incoming12.append(in3)
            out1 = Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('CurrentDemand')+ GreenDemand121[i]
            out2 = GreenTimes121[i] * St2
            out3 = min(out1,out2)
            outgoing12.append(out3)
            content12.append(in3-out3)



        incoming13=[]
        outgoing13=[]
        content13=[]
        for i in range(len(GreenTimes13)):
            in1 = Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('CurrentDemand')+ GreenDemand13[i]
            in2 = GreenTimes13[i] * St2
            in3 = min(in1,in2)
            incoming13.append(in3)
            out1 = Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('CurrentDemand')+ GreenDemand131[i]
            out2 = GreenTimes131[i] * St2
            out3 = min(out1,out2)
            outgoing13.append(out3)
            content13.append(in3-out3)

        kk=0
        for x in LinkAttributes:
            kk= kk + x[LinAttNames['Count:Vehs']]
        density = kk  - Vissim.Net.Links.ItemByKey(107).AttValue ('Count:Vehs') - Vissim.Net.Links.ItemByKey(108).AttValue ('Count:Vehs') - Vissim.Net.Links.ItemByKey(109).AttValue ('Count:Vehs')- Vissim.Net.Links.ItemByKey(110).AttValue ('Count:Vehs')- Vissim.Net.Links.ItemByKey(111).AttValue ('Count:Vehs')- Vissim.Net.Links.ItemByKey(112).AttValue ('Count:Vehs')- Vissim.Net.Links.ItemByKey(113).AttValue ('Count:Vehs')-- Vissim.Net.Links.ItemByKey(114).AttValue ('Count:Vehs')

        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue('SystemContent',density)

        scc=[]
        scc2=[]        
        indexes=[]
        mmmm = Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue('SystemContent')
        for i in range(len(content1)):
            for j in range(len(content5)):
                for k in range(len(content12)):
                    for m in range(len(content13)):
                        scc1 = abs(Kq - (mmmm + content1[i] + content5[j] + content12[k] + content13[m]))
                        scc2.append(scc1)
                        indexes.append([i,j,k,m])



        minimals=[]
        indexes2=[]
        for i in range(len(scc2)):
            if scc2[i]== min(scc2):
                minimals.append(scc2[i])
                indexes2.append(indexes[i])

        mor=[]
        for i in range(len(minimals)):
            mo1 = abs(GreenTimes1[indexes2[i][0]]*St-Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('CurrentDemand'))+ abs((CLength-GreenTimes1[indexes2[i][0]])*St-Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('CurrentDemand')) + abs((CLength-GreenTimes1[indexes2[i][0]])*St-Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('CurrentDemand'))+ abs((CLength-GreenTimes1[indexes2[i][0]])*St-Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('CurrentDemand')) + abs(GreenTimes5[indexes2[i][1]]*St-Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('CurrentDemand'))+ abs((CLength - GreenTimes5[indexes2[i][1]])*St-Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('CurrentDemand')) + abs((CLength - GreenTimes5[indexes2[i][1]])*St-Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('CurrentDemand'))+ abs((CLength - GreenTimes5[indexes2[i][1]])*St-Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('CurrentDemand')) +abs(GreenTimes12[indexes2[i][2]]*St-Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('CurrentDemand'))+ abs((CLength - GreenTimes12[indexes2[i][2]])*St-Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('CurrentDemand')) + abs((CLength - GreenTimes12[indexes2[i][2]])*St-Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('CurrentDemand'))+ abs((CLength - GreenTimes12[indexes2[i][2]])*St-Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('CurrentDemand'))+abs(GreenTimes13[indexes2[i][3]]*St-Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('CurrentDemand')) + abs((CLength - GreenTimes13[indexes2[i][3]])*St-Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('CurrentDemand')) + abs((CLength - GreenTimes13[indexes2[i][3]])*St-Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('CurrentDemand'))+ abs((CLength - GreenTimes13[indexes2[i][3]])*St-Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('CurrentDemand'))
            mor.append(mo1)




        finding=[]
        indexes3=[]
        for i in range(len(mor)): 
            if mor[i] == min(mor):
                finding.append(mor[i])
                MG1=GreenTimes1[indexes2[i][0]]
                MG2=GreenTimes5[indexes2[i][1]]
                MG3=GreenTimes12[indexes2[i][2]]
                MG4=GreenTimes13[indexes2[i][3]]
                indexes3.append([indexes2[i][0], indexes2[i][1], indexes2[i][2], indexes2[i][3]])






    
        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+2 > 52:
            koo=max(MG1,50) 
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('GreenTimeDuration',koo)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('GreenTimeDuration',CLength-koo-6)



            
        if Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+2 > 52:
            koo=max(MG2,50)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('GreenTimeDuration',koo)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            kk=0




        if Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+2 > 52:
            koo=max(MG3,50)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('GreenTimeDuration',koo)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('GreenTimeDuration',CLength-koo-6)






        if Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+2 > 52:
            koo=max(MG4,50)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('GreenTimeDuration',koo)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('GreenTimeDuration',CLength-koo-6)        







        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('GreenStart',2)
        ko = Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenStart')
        ko2 = max(ko,52)
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('GreenEnd',ko)
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('GreenEnd',CLength-1)



        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('GreenStart',2)
        ko = Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenStart')
        ko2 = max(ko,52)
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('GreenEnd',ko)
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('GreenEnd',CLength-1)



        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('GreenStart',2)
        ko = Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenStart')
        ko2 = max(ko,52)
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('GreenEnd',ko)
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('GreenEnd',CLength-1)


        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('GreenStart',2)
        ko = Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenStart')
        ko2 = max(ko,52)
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('GreenEnd',ko)
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('GreenEnd',CLength-1)









        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][3]).SetAttValue ('GreenEnd', CLength-1)


        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][3]).SetAttValue ('GreenEnd', CLength-1)


        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][3]).SetAttValue ('GreenEnd', CLength-1)





        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][3]).SetAttValue ('GreenEnd', CLength-1)




        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][3]).SetAttValue ('GreenEnd', CLength-1)



        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][3]).SetAttValue ('GreenEnd', CLength-1)




        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][3]).SetAttValue ('GreenEnd', CLength-1)



        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][3]).SetAttValue ('GreenEnd', CLength-1)





        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][3]).SetAttValue ('GreenEnd', CLength-1)








#seventh time step
    if Seconds>=59 and Seconds<=60:

        L1=[]
        L2=[]
        L3=[]
        L4=[]
        L5=[]
        L6=[]
        L7=[]
        L8=[]
        L9=[]
        L10=[]
        L11=[]
        L12=[]
        L13=[]
        L14=[]
        L15=[]
        L16=[]
        L17=[]
        L18=[]
        L19=[]
        L20=[]
        L21=[]
        L22=[]
        L23=[]
        L24=[]
        L25=[]
        L26=[]
        L27=[]
        L28=[]
        L29=[]
        L30=[]
        L31=[]
        L32=[]
        L33=[]
        L34=[]
        L35=[]
        L36=[]
        L37=[]
        L38=[]
        L39=[]
        L40=[]
        L41=[]
        L42=[]
        L43=[]
        L44=[]
        L45=[]
        L46=[]
        L47=[]
        L48=[]
        L49=[]
        L50=[]
        L51=[]
        L52=[]
        L53=[]
        L54=[]
        L55=[]
        L56=[]
        LL1=[]
        LL2=[]
        LL3=[]
        LL4=[]
        LL5=[]
        LL6=[]
        LL7=[]
        LL8=[]
        LL9=[]
        LL10=[]
        LL11=[]
        LL12=[]
        LL13=[]
        LL14=[]
        LL15=[]
        LL16=[]
        S1=[]
        S2=[]
        S3=[]
        S4=[]
        S5=[]
        S6=[]
        S7=[]
        S8=[]
        S9=[]
        S10=[]
        S11=[]
        S12=[]
        S13=[]
        S14=[]
        S15=[]
        S16=[]
        S17=[]
        S18=[]
        S19=[]
        S20=[]
        S21=[]
        S22=[]
        S23=[]
        S24=[]
        S25=[]
        S26=[]
        S27=[]
        S28=[]
        S29=[]
        S30=[]
        S31=[]
        S32=[]
        S33=[]
        S34=[]
        S35=[]
        S36=[]
        S37=[]
        S38=[]
        S39=[]
        S40=[]
        S41=[]
        S42=[]
        S43=[]
        S44=[]
        S45=[]
        S46=[]
        S47=[]
        S48=[]
        S49=[]
        S50=[]
        S51=[]
        S52=[]
        S53=[]
        S54=[]
        S55=[]
        S56=[]

        for vehAttributes in vehsAttributes:
            if vehAttributes[vehsAttNames['VehType\No']] in vehTypesEquipped:       
                if vehAttributes[vehsAttNames['Pos']] != None:
                    InQueue = vehAttributes[vehsAttNames['InQueue']]               
                    if InQueue == True:
                        DistanceToSigHead = vehAttributes[vehsAttNames['DistanceToSigHead']]
                        Link = vehAttributes[vehsAttNames['Lane\Link']]
                        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('LinkNo',Link)
                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 99:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            L6.append(DistanceToSigHead)
                            D6 = max (L6)
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('len1',len(L6))

                            if len(L6) > 0:
                                k= max(min(round(D6/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D6/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('Joining',mm)
                                

                                    
                            

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 65:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            L7.append(DistanceToSigHead)
                            D7 = max (L7)
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('len1',len(L7))

                            if len(L7) > 0:
                                k= max(min(round(D7/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D7/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('Joining',mm)
                                


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 75:
                            
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            L8.append(DistanceToSigHead)
                            D8 = max(L8)
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('len1',len(L8))

                            if len(L8) > 0:
                                k= max(min(round(D8/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D8/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('Joining',mm)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 102:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            L9.append(DistanceToSigHead)
                            D9 = max (L9)
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('len1',len(L9))


                            if len(L9) > 0:
                                k= max(min(round(D9/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D9/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('Joining',mm)







                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 76:
                            L15.append(DistanceToSigHead)
                            D15 = max (L15)
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('len1',len(L15))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1


                            if len(L15) > 0:
                                k= max(min(round(D15/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D15/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('Joining',mm)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 86:
                            L16.append(DistanceToSigHead)
                            D16 = max (L16)
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('len1',len(L16))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            if len(L16) > 0:
                                k= max(min(round(D16/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D16/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 77:
                            L17.append(DistanceToSigHead)
                            D17 = max (L17)
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('len1',len(L17))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            if len(L17) > 0:
                                k= max(min(round(D17/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D17/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 67:
                            L18.append(DistanceToSigHead)
                            D18 = max (L18)
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('len1',len(L18))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            if len(L18) > 0:
                                k= max(min(round(D18/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D18/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('Joining',mm)








                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 78:
                            L19.append(DistanceToSigHead)
                            D19 = max (L19)
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('len1',len(L19))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            if len(L19) > 0:
                                k= max(min(round(D19/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D19/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 96:
                            L20.append(DistanceToSigHead)
                            D20 = max (L20)
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('len1',len(L20))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1

                            if len(L20) > 0:
                                k= max(min(round(D20/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D20/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 69:
                            L21.append(DistanceToSigHead)
                            D21 = max (L21)
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('len1',len(L21))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            if len(L21) > 0:
                                k= max(min(round(D21/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D21/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 97:
                            L22.append(DistanceToSigHead)
                            D22 = max (L22)
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('len1',len(L22))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1

                            if len(L22) > 0:
                                k= max(min(round(D22/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D22/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('Joining',mm)








                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 70:
                            L28.append(DistanceToSigHead)
                            D28 = max (L28)
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('len1',len(L28))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            if len(L28) > 0:
                                k= max(min(round(D28/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D28/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 87:
                            L29.append(DistanceToSigHead)
                            D29 = max (L29)
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('len1',len(L29))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            if len(L29) > 0:
                                k= max(min(round(D29/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D29/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 63:
                            L30.append(DistanceToSigHead)
                            D30 = max (L30)
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('len1',len(L30))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            if len(L30) > 0:
                                k= max(min(round(D30/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D30/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('Joining',mm)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 82:
                            L31.append(DistanceToSigHead)
                            D31 = max (L31)
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('len1',len(L31))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            if len(L31) > 0:
                                k= max(min(round(D31/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D31/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('Joining',mm)





                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 81:
                            L32.append(DistanceToSigHead)
                            D32 = max (L32)
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('len1',len(L32))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1

                            if len(L32) > 0:
                                k= max(min(round(D32/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D32/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 61:
                            L33.append(DistanceToSigHead)
                            D33 = max (L33)
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('len1',len(L33))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1

                            if len(L33) > 0:
                                k= max(min(round(D33/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D33/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 80:
                            L34.append(DistanceToSigHead)
                            D34 = max (L34)
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('len1',len(L34))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1

                            if len(L34) > 0:
                                k= max(min(round(D34/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D34/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 68:
                            L35.append(DistanceToSigHead)
                            D35 = max (L35)
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('len1',len(L35))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1

                            if len(L35) > 0:
                                k= max(min(round(D35/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D35/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('Joining',mm)







                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 79:
                            L36.append(DistanceToSigHead)
                            D36 = max (L36)
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('len1',len(L36))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1

                            if len(L36) > 0:
                                k= max(min(round(D36/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D36/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('Joining',mm)
                            

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 59:
                            L37.append(DistanceToSigHead)
                            D37 = max (L37)
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('len1',len(L37))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1

                            if len(L37) > 0:
                                k= max(min(round(D37/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D37/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 90:
                            L38.append(DistanceToSigHead)
                            D38 = max (L38)
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('len1',len(L38))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            

                            if len(L38) > 0:
                                k= max(min(round(D38/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D38/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('Joining',mm)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 66:
                            L39.append(DistanceToSigHead)
                            D39 = max (L39)
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('len1',len(L39))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1

                            if len(L39) > 0:
                                k= max(min(round(D39/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D39/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('Joining',mm)









                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 60:
                            L40.append(DistanceToSigHead)
                            D40 = max (L40)
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('len1',len(L40))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1

                            if len(L40) > 0:
                                k= max(min(round(D40/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D40/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 92:
                            L41.append(DistanceToSigHead)
                            D41 = max (L41)
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('len1',len(L41))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1

                            if len(L41) > 0:
                                k= max(min(round(D41/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D41/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 71:
                            L42.append(DistanceToSigHead)
                            D42 = max (L42)
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('len1',len(L42))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1

                            if len(L42) > 0:
                                k= max(min(round(D42/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D42/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 93:
                            L43.append(DistanceToSigHead)
                            D43 = max (L43)
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('len1',len(L43))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1

                            if len(L43) > 0:
                                k= max(min(round(D43/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D43/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('Joining',mm)







                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 72:
                            L44.append(DistanceToSigHead)
                            D44 = max (L44)
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('len1',len(L44))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1

                            if len(L44) > 0:
                                k= max(min(round(D44/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D44/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 62:
                            L45.append(DistanceToSigHead)
                            D45 = max (L45)
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('len1',len(L45))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1

                            if len(L45) > 0:
                                k= max(min(round(D45/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D45/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 73:
                            L46.append(DistanceToSigHead)
                            D46 = max (L46)
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('len1',len(L46))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1

                            if len(L46) > 0:
                                k= max(min(round(D46/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D46/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 83:
                            L47.append(DistanceToSigHead)
                            D47 = max (L47)
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('len1',len(L47))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1

                            if len(L47) > 0:
                                k= max(min(round(D47/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D47/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('Joining',mm)






                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 74:
                            L48.append(DistanceToSigHead)
                            D48 = max (L48)
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('len1',len(L48))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1

                            if len(L48) > 0:
                                k= max(min(round(D48/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D48/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 64:
                            L49.append(DistanceToSigHead)
                            D49 = max (L49)
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('len1',len(L49))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            if len(L49) > 0:
                                k= max(min(round(D49/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D49/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 104:
                            L50.append(DistanceToSigHead)
                            D50 = max (L50)
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('len1',len(L50))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1

                            if len(L50) > 0:
                                k= max(min(round(D50/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D50/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 105:
                            L51.append(DistanceToSigHead)
                            D51 = max (L51)
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('len1',len(L51))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1


                            if len(L51) > 0:
                                k= max(min(round(D51/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D51/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('Joining',mm)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 109:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            LL1.append(DistanceToSigHead)
                            D1 = max (LL1)
                            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('len1',len(LL1))
                            if len(LL1) > 0:
                                k= max(min(round(D1/5),50),1)                                
                                sum1 = 0
                                while k <= 50:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.02)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D1/5),50),1)
                                sum2=0
                                while n <= 50:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.02)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('Joining',mm)
                                

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 91:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            LL2.append(DistanceToSigHead)
                            D2 = max (LL2)
                            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('len1',len(LL2))
                            if len(LL2) > 0:
                                k= max(min(round(D2/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D2/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('Joining',mm)
                                



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 89:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            LL3.append(DistanceToSigHead)
                            D3 = max (LL3)
                            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('len1',len(LL3))
                            if len(LL3) > 0:
                                k= max(min(round(D3/5),10),1)                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D3/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 100:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            LL4.append(DistanceToSigHead)
                            D4 = max (LL4)
                            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('len1',len(LL4))
                            if len(LL4) > 0:
                                k= max(min(round(D4/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D4/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('Joining',mm)












                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 108:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            LL5.append(DistanceToSigHead)
                            D5 = max (LL5)
                            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('len1',len(LL5))
                            if len(LL5) > 0:
                                k= max(min(round(D5/5),50),1)                                
                                sum1 = 0
                                while k <= 50:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.02)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D5/5),50),1)
                                sum2=0
                                while n <= 50:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.02)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('Joining',mm)
                                

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 98:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            LL6.append(DistanceToSigHead)
                            D6 = max (LL6)
                            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('len1',len(LL6))
                            if len(LL6) > 0:
                                k= max(min(round(D6/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D6/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('Joining',mm)
                                



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 88:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            LL7.append(DistanceToSigHead)
                            D7 = max (LL7)
                            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('len1',len(LL7))
                            if len(LL7) > 0:
                                k= max(min(round(D7/5),10),1)                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D7/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 103:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            LL8.append(DistanceToSigHead)
                            D8 = max (LL8)
                            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('len1',len(LL8))
                            if len(LL8) > 0:
                                k= max(min(round(D8/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D8/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('Joining',mm)





                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 112:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            LL9.append(DistanceToSigHead)
                            D9 = max (LL9)
                            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('len1',len(LL9))
                            if len(LL9) > 0:
                                k= max(min(round(D9/5),50),1)                                
                                sum1 = 0
                                while k <= 50:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.02)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D9/5),50),1)
                                sum2=0
                                while n <= 50:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.02)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('Joining',mm)


                                

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 101:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            LL10.append(DistanceToSigHead)
                            D10 = max (LL10)
                            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('len1',len(LL10))
                            if len(LL10) > 0:
                                k= max(min(round(D10/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D10/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('Joining',mm)
                                



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 85:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            LL11.append(DistanceToSigHead)
                            D11 = max (LL11)
                            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('len1',len(LL11))
                            if len(LL11) > 0:
                                k= max(min(round(D11/5),10),1)                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D11/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 95:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            LL12.append(DistanceToSigHead)
                            D12 = max (LL12)
                            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('len1',len(LL12))
                            if len(LL12) > 0:
                                k= max(min(round(D12/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D12/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('Joining',mm)





                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 113:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            LL13.append(DistanceToSigHead)
                            D13 = max (LL13)
                            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('len1',len(LL13))
                            if len(LL13) > 0:
                                k= max(min(round(D13/5),50),1)                                
                                sum1 = 0
                                while k <= 50:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.02)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D13/5),50),1)
                                sum2=0
                                while n <= 50:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.02)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('Joining',mm)


                                

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 106:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            LL14.append(DistanceToSigHead)
                            D14 = max (LL14)
                            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('len1',len(LL14))
                            if len(LL14) > 0:
                                k= max(min(round(D14/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D14/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('Joining',mm)
                                



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 84:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            LL15.append(DistanceToSigHead)
                            D15 = max (LL15)
                            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('len1',len(LL15))
                            if len(LL15) > 0:
                                k= max(min(round(D15/5),10),1)                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D15/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 94:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            LL16.append(DistanceToSigHead)
                            D16 = max (LL16)
                            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('len1',len(LL16))
                            if len(LL16) > 0:
                                k= max(min(round(D16/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D16/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('Joining',mm)




                    else:
                        continue




                    if vehAttributes[vehsAttNames['VehType\No']] in vehTypesSpecial:
                        Link = vehAttributes[vehsAttNames['Lane\Link']]
                        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('LinkNo1',Link)
                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 99:
                            S6.append(1)
                            if len(S6)>0:
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 65:
                            S7.append(1)
                            if len(S7) >0:
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)
                     

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 75:
                            S8.append(1)
                            if len(S8) >0:
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)
                            

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 102:
                            S9.append(1)
                            if len(S9) >0:
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 76:
                            S15.append(1)
                            if len(S15) >0:
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 86:
                            S16.append(1)
                            if len(S16) >0:
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 77:
                            S17.append(1)
                            if len(S17) >0:
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 67:
                            S18.append(1)
                            if len(S18) >0:
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 78:
                            S19.append(1)
                            if len(S19) >0:
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 96:
                            S20.append(1)
                            if len(S20) >0:
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 69:
                            S21.append(1)
                            if len(S21) >0:
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 97:
                            S22.append(1)
                            if len(S22) >0:
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 70:
                            S28.append(1)
                            if len(S28) >0:
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 87:
                            S29.append(1)
                            if len(S29) >0:
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 63:
                            S30.append(1)
                            if len(S30) >0:
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 82:
                            S31.append(1)
                            if len(S31) >0:
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 81:
                            S32.append(1)
                            if len(S32) >0:
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 61:
                            S33.append(1)
                            if len(S33) >0:
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 80:
                            S34.append(1)
                            if len(S34) >0:
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 68:
                            S35.append(1)
                            if len(S35) >0:
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 79:
                            S36.append(1)
                            if len(S36) >0:
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 59:
                            S37.append(1)
                            if len(S37) >0:
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 90:
                            S38.append(1)
                            if len(S38) >0:
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 66:
                            S39.append(1)
                            if len(S39) >0:
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 60:
                            S40.append(1)
                            if len(S40) >0:
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)
 
                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 92:
                            S41.append(1)
                            if len(S41) >0:
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 71:
                            S42.append(1)
                            if len(S42) >0:
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 93:
                            S43.append(1)
                            if len(S43) >0:
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 72:
                            S44.append(1)
                            if len(S44) >0:
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 62:
                            S45.append(1)
                            if len(S45) >0:
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 73:
                            S46.append(1)
                            if len(S46) >0:
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 83:
                            S47.append(1)
                            if len(S47) >0:
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 74:
                            S48.append(1)
                            if len(S48) >0:
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 64:
                            S49.append(1)
                            if len(S49) >0:
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 104:
                            S50.append(1)
                            if len(S50) >0:
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 105:
                            S51.append(1)
                            if len(S51) >0:
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)





        if len(LL1) == 0:
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',2)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('len1',0)
            

        if len(LL2) == 0:
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('len1',0)



        if len(LL3) == 0:
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('len1',0)


        if len(LL4) == 0:
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('len1',0)



        if len(LL5) == 0:
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',2)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('len1',0)

        if len(LL6) == 0:
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('len1',0)


        if len(LL7) == 0:
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('len1',0)



        if len(LL8) == 0:
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('len1',0)


        if len(LL9) == 0:
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',2)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('len1',0)


        if len(LL10) == 0:
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('len1',0)


        if len(LL11) == 0:
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('len1',0)


        if len(LL12) == 0:
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('len1',0)


        if len(LL13) == 0:
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',2)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('len1',0)


        if len(LL14) == 0:
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('len1',0)


        if len(LL15) == 0:
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('len1',0)



        if len(LL16) == 0:
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('len1',0)




        if len(L6)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L7)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('Joining',0)



        if len(L8)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('Joining',0)

        if len(L9)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('Joining',0)


        if len(L15)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('Joining',0)


        if len(L16)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('Joining',0)


        if len(L17)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('Joining',0)


        if len(L18)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('Joining',0)





        if len(L19)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L20)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('Joining',0)

        if len(L21)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('Joining',0)


        if len(L22)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('Joining',0)


        if len(L28)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('Joining',0)




        if len(L29)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('Joining',0)



        if len(L30)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('Joining',0)



        if len(L31)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('Joining',0)




        if len(L32)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('Joining',0)


        if len(L33)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('Joining',0)



        if len(L34)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('Joining',0)


        if len(L35)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('Joining',0)



        if len(L36)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('Joining',0)


        if len(L37)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('Joining',0)



        if len(L38)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L39)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('Joining',0)


        if len(L40)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('Joining',0)



        if len(L41)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L42)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('Joining',0)



        if len(L43)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('Joining',0)


        if len(L44)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L45)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('Joining',0)





        if len(L46)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('Joining',0)


        if len(L47)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('Joining',0)



        if len(L48)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L49)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('Joining',0)



        if len(L50)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('Joining',0)


        if len(L51)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('Joining',0)





        if len(S6)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)




        if len(S7)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)




        if len(S8)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)


        if len(S9)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)



        if len(S15)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)



        if len(S16)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)



        if len(S17)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)



        if len(S18)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)






        if len(S19)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)




        if len(S20)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)


        if len(S21)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)



        if len(S22)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)



        if len(S28)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)





        if len(S29)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)




        if len(S30)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)




        if len(S31)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)





        if len(S32)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)



        if len(S33)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)




        if len(S34)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)



        if len(S35)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)




        if len(S36)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)



        if len(S37)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)




        if len(S38)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)




        if len(S39)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)



        if len(S40)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)




        if len(S41)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)




        if len(S42)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)




        if len(S43)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)



        if len(S44)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)




        if len(S45)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)






        if len(S46)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)



        if len(S47)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)




        if len(S48)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)



        if len(S49)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)



        if len(S49)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)




        if len(S50)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)



        if len(S51)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)




        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('SigState') == 'RED':           
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('Joining')))
            kss1= 14-(Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).AttValue('Queuedup'))
            kss2= 17- (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).AttValue('Queuedup'))
            kss3 = 17- (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).AttValue('Queuedup'))
            kss4= min(kss1,kss2,kss3)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('CurrentSupply',3 * kss4)

            
        else:
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('Joining')))





        if Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('SigState') == 'RED':           
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('Joining')))
            kss11= 14-(Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).AttValue('Queuedup'))
            kss22= 17- (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).AttValue('Queuedup'))
            kss33 = 17- (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).AttValue('Queuedup'))
            kss44= min(kss11,kss22,kss33)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('CurrentSupply',3 * kss44)

        else:
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('Joining')))






        if Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('SigState') == 'RED':           
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('Joining')))
            kss111= 14-(Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss222= 17- (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss333 = 17- (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss444= min(kss111,kss222,kss333)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('CurrentSupply',3 * kss444)

        else:
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('Joining')))




        if Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('SigState') == 'RED':           
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('Joining')))
            kss1111= 14-(Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss2222= 17- (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss3333 = 17- (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss4444= min(kss1111,kss2222,kss3333)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('CurrentSupply',3 * kss4444)

        else:
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('Joining')))

        Aseq=[[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4]]






        GreenTimes = []
        i= GreenMinI2
        while i <= GreenMaxI2:
            GreenTimes.append(i)
            i=i+5


        GreenTimes1 = []
        GreenDemand1 = []
        for i in range(len(GreenTimes)):
            if GreenTimes[i] <= (Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('CurrentSupply')/St2):
                GreenTimes1.append(GreenTimes[i])
                GreenDemand1.append(round(GreenTimes[i]*(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue('ArrivalRate'))))
        if len(GreenTimes1)==0:
            GreenTimes1.append(GreenMinI2)
            GreenDemand1.append(round(GreenMinI2*(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue('ArrivalRate'))))

        GreenTimes11 = []
        GreenDemand11 = []        
        for i in range(len(GreenTimes1)):
            GreenTimes11.append(CLength-GreenTimes1[i])
            GreenDemand11.append(round((CLength-GreenTimes1[i]-6)*(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue('ArrivalRate')+ Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue('ArrivalRate')+Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue('ArrivalRate'))))
                
        GreenTimes5 = []
        GreenDemand5 = []  
        for i in range(len(GreenTimes)):
            if GreenTimes[i] <= (Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('CurrentSupply')/St):
                GreenTimes5.append(GreenTimes[i])
                GreenDemand5.append(round(GreenTimes[i]*(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue('ArrivalRate'))))

        if len(GreenTimes5)==0:
            GreenTimes5.append(GreenMinI2)
            GreenDemand5.append(round(GreenMinI2*(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue('ArrivalRate'))))

        GreenDemand51 = []  
        GreenTimes51 = []
        for i in range(len(GreenTimes5)):
            GreenTimes51.append(CLength-GreenTimes5[i])
            GreenDemand51.append(round((CLength-GreenTimes5[i]-6)*(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue('ArrivalRate')+ Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue('ArrivalRate')+Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue('ArrivalRate'))))


        GreenTimes12 = []
        GreenDemand12 = [] 
        for i in range(len(GreenTimes)):
            if GreenTimes[i] <= (Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('CurrentSupply')/St):
                GreenTimes12.append(GreenTimes[i])
                GreenDemand12.append(round(GreenTimes[i]*(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue('ArrivalRate'))))

        if len(GreenTimes12)==0:
            GreenTimes12.append(GreenMinI2)
            GreenDemand12.append(round(GreenMinI2*(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue('ArrivalRate'))))


        GreenTimes121 = []
        GreenDemand121 = []
        for i in range(len(GreenTimes12)): 
            GreenTimes121.append(CLength-GreenTimes12[i])
            GreenDemand121.append(round((CLength-GreenTimes12[i]-6)*(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue('ArrivalRate')+ Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue('ArrivalRate')+Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue('ArrivalRate'))))





        GreenTimes13 = []
        GreenDemand13 = [] 
        for i in range(len(GreenTimes)):
            if GreenTimes[i] <= (Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('CurrentSupply')/St):
                GreenTimes13.append(GreenTimes[i])
                GreenDemand13.append(round(GreenTimes[i]*(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue('ArrivalRate'))))

        if len(GreenTimes13)==0:
            GreenTimes13.append(GreenMinI2)
            GreenDemand13.append(round(GreenMinI2*(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue('ArrivalRate'))))



        GreenTimes131 = []
        GreenDemand131 = []
        for i in range(len(GreenTimes13)):
            GreenTimes131.append(CLength-GreenTimes13[i])
            GreenDemand131.append(round((CLength-GreenTimes13[i]-6)*(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue('ArrivalRate')+ Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue('ArrivalRate')+Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue('ArrivalRate'))))






        incoming1=[]
        outgoing1=[]
        content1=[]
        for i in range(len(GreenTimes1)):
            in1 = Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('CurrentDemand')+ GreenDemand1[i]
            in2 = GreenTimes1[i] * St2
            in3 = min(in1,in2)
            incoming1.append(in3)
            out1 = Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('CurrentDemand')+ Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('CurrentDemand')+ Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('CurrentDemand')+ GreenDemand11[i]
            out2 = GreenTimes11[i] * St2
            out3 = min(out1,out2)
            outgoing1.append(out3)
            content1.append(in3-out3)



        incoming5=[]
        outgoing5=[]
        content5=[]
        for i in range(len(GreenTimes5)):
            in1 = Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('CurrentDemand')+ GreenDemand5[i]
            in2 = GreenTimes5[i] * St2
            in3 = min(in1,in2)
            incoming5.append(in3)
            out1 = Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('CurrentDemand')+ GreenDemand51[i]
            out2 = GreenTimes51[i] * St2
            out3 = min(out1,out2)
            outgoing5.append(out3)
            content5.append(in3-out3)


        incoming12=[]
        outgoing12=[]
        content12=[]
        for i in range(len(GreenTimes12)):
            in1 = Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('CurrentDemand')+ GreenDemand12[i]
            in2 = GreenTimes12[i] * St2
            in3 = min(in1,in2)
            incoming12.append(in3)
            out1 = Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('CurrentDemand')+ GreenDemand121[i]
            out2 = GreenTimes121[i] * St2
            out3 = min(out1,out2)
            outgoing12.append(out3)
            content12.append(in3-out3)



        incoming13=[]
        outgoing13=[]
        content13=[]
        for i in range(len(GreenTimes13)):
            in1 = Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('CurrentDemand')+ GreenDemand13[i]
            in2 = GreenTimes13[i] * St2
            in3 = min(in1,in2)
            incoming13.append(in3)
            out1 = Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('CurrentDemand')+ GreenDemand131[i]
            out2 = GreenTimes131[i] * St2
            out3 = min(out1,out2)
            outgoing13.append(out3)
            content13.append(in3-out3)

        kk=0
        for x in LinkAttributes:
            kk= kk + x[LinAttNames['Count:Vehs']]
        density = kk  - Vissim.Net.Links.ItemByKey(107).AttValue ('Count:Vehs') - Vissim.Net.Links.ItemByKey(108).AttValue ('Count:Vehs') - Vissim.Net.Links.ItemByKey(109).AttValue ('Count:Vehs')- Vissim.Net.Links.ItemByKey(110).AttValue ('Count:Vehs')- Vissim.Net.Links.ItemByKey(111).AttValue ('Count:Vehs')- Vissim.Net.Links.ItemByKey(112).AttValue ('Count:Vehs')- Vissim.Net.Links.ItemByKey(113).AttValue ('Count:Vehs')-- Vissim.Net.Links.ItemByKey(114).AttValue ('Count:Vehs')

        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue('SystemContent',density)

        scc=[]
        scc2=[]        
        indexes=[]
        mmmm = Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue('SystemContent')
        for i in range(len(content1)):
            for j in range(len(content5)):
                for k in range(len(content12)):
                    for m in range(len(content13)):
                        scc1 = abs(Kq - (mmmm + content1[i] + content5[j] + content12[k] + content13[m]))
                        scc2.append(scc1)
                        indexes.append([i,j,k,m])



        minimals=[]
        indexes2=[]
        for i in range(len(scc2)):
            if scc2[i]== min(scc2):
                minimals.append(scc2[i])
                indexes2.append(indexes[i])

        mor=[]
        for i in range(len(minimals)):
            mo1 = abs(GreenTimes1[indexes2[i][0]]*St-Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('CurrentDemand'))+ abs((CLength-GreenTimes1[indexes2[i][0]])*St-Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('CurrentDemand')) + abs((CLength-GreenTimes1[indexes2[i][0]])*St-Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('CurrentDemand'))+ abs((CLength-GreenTimes1[indexes2[i][0]])*St-Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('CurrentDemand')) + abs(GreenTimes5[indexes2[i][1]]*St-Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('CurrentDemand'))+ abs((CLength - GreenTimes5[indexes2[i][1]])*St-Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('CurrentDemand')) + abs((CLength - GreenTimes5[indexes2[i][1]])*St-Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('CurrentDemand'))+ abs((CLength - GreenTimes5[indexes2[i][1]])*St-Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('CurrentDemand')) +abs(GreenTimes12[indexes2[i][2]]*St-Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('CurrentDemand'))+ abs((CLength - GreenTimes12[indexes2[i][2]])*St-Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('CurrentDemand')) + abs((CLength - GreenTimes12[indexes2[i][2]])*St-Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('CurrentDemand'))+ abs((CLength - GreenTimes12[indexes2[i][2]])*St-Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('CurrentDemand'))+abs(GreenTimes13[indexes2[i][3]]*St-Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('CurrentDemand')) + abs((CLength - GreenTimes13[indexes2[i][3]])*St-Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('CurrentDemand')) + abs((CLength - GreenTimes13[indexes2[i][3]])*St-Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('CurrentDemand'))+ abs((CLength - GreenTimes13[indexes2[i][3]])*St-Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('CurrentDemand'))
            mor.append(mo1)




        finding=[]
        indexes3=[]
        for i in range(len(mor)): 
            if mor[i] == min(mor):
                finding.append(mor[i])
                MG1=GreenTimes1[indexes2[i][0]]
                MG2=GreenTimes5[indexes2[i][1]]
                MG3=GreenTimes12[indexes2[i][2]]
                MG4=GreenTimes13[indexes2[i][3]]
                indexes3.append([indexes2[i][0], indexes2[i][1], indexes2[i][2], indexes2[i][3]])






    
        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+2 > 62:
            koo=max(MG1,60) 
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('GreenTimeDuration',koo)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('GreenTimeDuration',CLength-koo-6)



            
        if Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+2 > 62:
            koo=max(MG2,60)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('GreenTimeDuration',koo)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            kk=0




        if Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+2 > 62:
            koo=max(MG3,60)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('GreenTimeDuration',koo)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('GreenTimeDuration',CLength-koo-6)






        if Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+2 > 62:
            koo=max(MG4,60)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('GreenTimeDuration',koo)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('GreenTimeDuration',CLength-koo-6)        







        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('GreenStart',2)
        ko = Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenStart')
        ko2 = max(ko,62)
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('GreenEnd',ko)
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('GreenEnd',CLength-1)



        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('GreenStart',2)
        ko = Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenStart')
        ko2 = max(ko,62)
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('GreenEnd',ko)
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('GreenEnd',CLength-1)



        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('GreenStart',2)
        ko = Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenStart')
        ko2 = max(ko,62)
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('GreenEnd',ko)
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('GreenEnd',CLength-1)


        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('GreenStart',2)
        ko = Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenStart')
        ko2 = max(ko,62)
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('GreenEnd',ko)
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('GreenEnd',CLength-1)











        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][3]).SetAttValue ('GreenEnd', CLength-1)


        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][3]).SetAttValue ('GreenEnd', CLength-1)


        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][3]).SetAttValue ('GreenEnd', CLength-1)





        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][3]).SetAttValue ('GreenEnd', CLength-1)




        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][3]).SetAttValue ('GreenEnd', CLength-1)



        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][3]).SetAttValue ('GreenEnd', CLength-1)




        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][3]).SetAttValue ('GreenEnd', CLength-1)



        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][3]).SetAttValue ('GreenEnd', CLength-1)





        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][3]).SetAttValue ('GreenEnd', CLength-1)














#eigth time step
    if Seconds>=69 and Seconds<=70:

        L1=[]
        L2=[]
        L3=[]
        L4=[]
        L5=[]
        L6=[]
        L7=[]
        L8=[]
        L9=[]
        L10=[]
        L11=[]
        L12=[]
        L13=[]
        L14=[]
        L15=[]
        L16=[]
        L17=[]
        L18=[]
        L19=[]
        L20=[]
        L21=[]
        L22=[]
        L23=[]
        L24=[]
        L25=[]
        L26=[]
        L27=[]
        L28=[]
        L29=[]
        L30=[]
        L31=[]
        L32=[]
        L33=[]
        L34=[]
        L35=[]
        L36=[]
        L37=[]
        L38=[]
        L39=[]
        L40=[]
        L41=[]
        L42=[]
        L43=[]
        L44=[]
        L45=[]
        L46=[]
        L47=[]
        L48=[]
        L49=[]
        L50=[]
        L51=[]
        L52=[]
        L53=[]
        L54=[]
        L55=[]
        L56=[]
        LL1=[]
        LL2=[]
        LL3=[]
        LL4=[]
        LL5=[]
        LL6=[]
        LL7=[]
        LL8=[]
        LL9=[]
        LL10=[]
        LL11=[]
        LL12=[]
        LL13=[]
        LL14=[]
        LL15=[]
        LL16=[]
        S1=[]
        S2=[]
        S3=[]
        S4=[]
        S5=[]
        S6=[]
        S7=[]
        S8=[]
        S9=[]
        S10=[]
        S11=[]
        S12=[]
        S13=[]
        S14=[]
        S15=[]
        S16=[]
        S17=[]
        S18=[]
        S19=[]
        S20=[]
        S21=[]
        S22=[]
        S23=[]
        S24=[]
        S25=[]
        S26=[]
        S27=[]
        S28=[]
        S29=[]
        S30=[]
        S31=[]
        S32=[]
        S33=[]
        S34=[]
        S35=[]
        S36=[]
        S37=[]
        S38=[]
        S39=[]
        S40=[]
        S41=[]
        S42=[]
        S43=[]
        S44=[]
        S45=[]
        S46=[]
        S47=[]
        S48=[]
        S49=[]
        S50=[]
        S51=[]
        S52=[]
        S53=[]
        S54=[]
        S55=[]
        S56=[]

        for vehAttributes in vehsAttributes:
            if vehAttributes[vehsAttNames['VehType\No']] in vehTypesEquipped:       
                if vehAttributes[vehsAttNames['Pos']] != None:
                    InQueue = vehAttributes[vehsAttNames['InQueue']]               
                    if InQueue == True:
                        DistanceToSigHead = vehAttributes[vehsAttNames['DistanceToSigHead']]
                        Link = vehAttributes[vehsAttNames['Lane\Link']]
                        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('LinkNo',Link)
                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 99:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            L6.append(DistanceToSigHead)
                            D6 = max (L6)
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('len1',len(L6))

                            if len(L6) > 0:
                                k= max(min(round(D6/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D6/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('Joining',mm)
                                

                                    
                            

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 65:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            L7.append(DistanceToSigHead)
                            D7 = max (L7)
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('len1',len(L7))

                            if len(L7) > 0:
                                k= max(min(round(D7/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D7/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('Joining',mm)
                                


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 75:
                            
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            L8.append(DistanceToSigHead)
                            D8 = max(L8)
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('len1',len(L8))

                            if len(L8) > 0:
                                k= max(min(round(D8/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D8/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('Joining',mm)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 102:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            L9.append(DistanceToSigHead)
                            D9 = max (L9)
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('len1',len(L9))


                            if len(L9) > 0:
                                k= max(min(round(D9/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D9/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('Joining',mm)







                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 76:
                            L15.append(DistanceToSigHead)
                            D15 = max (L15)
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('len1',len(L15))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1


                            if len(L15) > 0:
                                k= max(min(round(D15/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D15/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('Joining',mm)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 86:
                            L16.append(DistanceToSigHead)
                            D16 = max (L16)
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('len1',len(L16))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            if len(L16) > 0:
                                k= max(min(round(D16/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D16/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 77:
                            L17.append(DistanceToSigHead)
                            D17 = max (L17)
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('len1',len(L17))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            if len(L17) > 0:
                                k= max(min(round(D17/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D17/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 67:
                            L18.append(DistanceToSigHead)
                            D18 = max (L18)
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('len1',len(L18))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            if len(L18) > 0:
                                k= max(min(round(D18/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D18/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('Joining',mm)








                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 78:
                            L19.append(DistanceToSigHead)
                            D19 = max (L19)
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('len1',len(L19))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            if len(L19) > 0:
                                k= max(min(round(D19/5),10),1)
                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D19/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 96:
                            L20.append(DistanceToSigHead)
                            D20 = max (L20)
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('len1',len(L20))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1

                            if len(L20) > 0:
                                k= max(min(round(D20/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D20/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 69:
                            L21.append(DistanceToSigHead)
                            D21 = max (L21)
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('len1',len(L21))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            if len(L21) > 0:
                                k= max(min(round(D21/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D21/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 97:
                            L22.append(DistanceToSigHead)
                            D22 = max (L22)
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('len1',len(L22))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1

                            if len(L22) > 0:
                                k= max(min(round(D22/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D22/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('Joining',mm)








                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 70:
                            L28.append(DistanceToSigHead)
                            D28 = max (L28)
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('len1',len(L28))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            if len(L28) > 0:
                                k= max(min(round(D28/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D28/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 87:
                            L29.append(DistanceToSigHead)
                            D29 = max (L29)
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('len1',len(L29))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            if len(L29) > 0:
                                k= max(min(round(D29/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D29/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 63:
                            L30.append(DistanceToSigHead)
                            D30 = max (L30)
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('len1',len(L30))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            if len(L30) > 0:
                                k= max(min(round(D30/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D30/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('Joining',mm)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 82:
                            L31.append(DistanceToSigHead)
                            D31 = max (L31)
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('len1',len(L31))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            if len(L31) > 0:
                                k= max(min(round(D31/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D31/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('Joining',mm)





                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 81:
                            L32.append(DistanceToSigHead)
                            D32 = max (L32)
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('len1',len(L32))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1

                            if len(L32) > 0:
                                k= max(min(round(D32/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D32/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 61:
                            L33.append(DistanceToSigHead)
                            D33 = max (L33)
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('len1',len(L33))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1

                            if len(L33) > 0:
                                k= max(min(round(D33/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D33/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 80:
                            L34.append(DistanceToSigHead)
                            D34 = max (L34)
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('len1',len(L34))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1

                            if len(L34) > 0:
                                k= max(min(round(D34/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D34/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 68:
                            L35.append(DistanceToSigHead)
                            D35 = max (L35)
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('len1',len(L35))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1

                            if len(L35) > 0:
                                k= max(min(round(D35/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D35/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('Joining',mm)







                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 79:
                            L36.append(DistanceToSigHead)
                            D36 = max (L36)
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('len1',len(L36))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1

                            if len(L36) > 0:
                                k= max(min(round(D36/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D36/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('Joining',mm)
                            

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 59:
                            L37.append(DistanceToSigHead)
                            D37 = max (L37)
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('len1',len(L37))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1

                            if len(L37) > 0:
                                k= max(min(round(D37/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D37/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 90:
                            L38.append(DistanceToSigHead)
                            D38 = max (L38)
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('len1',len(L38))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            

                            if len(L38) > 0:
                                k= max(min(round(D38/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D38/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('Joining',mm)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 66:
                            L39.append(DistanceToSigHead)
                            D39 = max (L39)
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('len1',len(L39))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1

                            if len(L39) > 0:
                                k= max(min(round(D39/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D39/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('Joining',mm)









                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 60:
                            L40.append(DistanceToSigHead)
                            D40 = max (L40)
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('len1',len(L40))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1

                            if len(L40) > 0:
                                k= max(min(round(D40/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D40/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 92:
                            L41.append(DistanceToSigHead)
                            D41 = max (L41)
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('len1',len(L41))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1

                            if len(L41) > 0:
                                k= max(min(round(D41/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D41/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 71:
                            L42.append(DistanceToSigHead)
                            D42 = max (L42)
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('len1',len(L42))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1

                            if len(L42) > 0:
                                k= max(min(round(D42/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D42/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 93:
                            L43.append(DistanceToSigHead)
                            D43 = max (L43)
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('len1',len(L43))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1

                            if len(L43) > 0:
                                k= max(min(round(D43/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D43/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('Joining',mm)







                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 72:
                            L44.append(DistanceToSigHead)
                            D44 = max (L44)
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('len1',len(L44))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1

                            if len(L44) > 0:
                                k= max(min(round(D44/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D44/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 62:
                            L45.append(DistanceToSigHead)
                            D45 = max (L45)
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('len1',len(L45))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1

                            if len(L45) > 0:
                                k= max(min(round(D45/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D45/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 73:
                            L46.append(DistanceToSigHead)
                            D46 = max (L46)
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('len1',len(L46))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1

                            if len(L46) > 0:
                                k= max(min(round(D46/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D46/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 83:
                            L47.append(DistanceToSigHead)
                            D47 = max (L47)
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('len1',len(L47))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1

                            if len(L47) > 0:
                                k= max(min(round(D47/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D47/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('Joining',mm)






                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 74:
                            L48.append(DistanceToSigHead)
                            D48 = max (L48)
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('len1',len(L48))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1

                            if len(L48) > 0:
                                k= max(min(round(D48/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D48/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 64:
                            L49.append(DistanceToSigHead)
                            D49 = max (L49)
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('len1',len(L49))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            if len(L49) > 0:
                                k= max(min(round(D49/5),10),1)                               
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D49/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 104:
                            L50.append(DistanceToSigHead)
                            D50 = max (L50)
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('len1',len(L50))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1

                            if len(L50) > 0:
                                k= max(min(round(D50/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D50/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('Joining',mm)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 105:
                            L51.append(DistanceToSigHead)
                            D51 = max (L51)
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('len1',len(L51))
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1


                            if len(L51) > 0:
                                k= max(min(round(D51/5),15),1)
                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D51/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('Joining',mm)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 109:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            LL1.append(DistanceToSigHead)
                            D1 = max (LL1)
                            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('len1',len(LL1))
                            if len(LL1) > 0:
                                k= max(min(round(D1/5),50),1)                                
                                sum1 = 0
                                while k <= 50:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.02)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D1/5),50),1)
                                sum2=0
                                while n <= 50:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.02)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('Joining',mm)
                                

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 91:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            LL2.append(DistanceToSigHead)
                            D2 = max (LL2)
                            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('len1',len(LL2))
                            if len(LL2) > 0:
                                k= max(min(round(D2/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D2/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('Joining',mm)
                                



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 89:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            LL3.append(DistanceToSigHead)
                            D3 = max (LL3)
                            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('len1',len(LL3))
                            if len(LL3) > 0:
                                k= max(min(round(D3/5),10),1)                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D3/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 100:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            LL4.append(DistanceToSigHead)
                            D4 = max (LL4)
                            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('len1',len(LL4))
                            if len(LL4) > 0:
                                k= max(min(round(D4/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D4/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('Joining',mm)












                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 108:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            LL5.append(DistanceToSigHead)
                            D5 = max (LL5)
                            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('len1',len(LL5))
                            if len(LL5) > 0:
                                k= max(min(round(D5/5),50),1)                                
                                sum1 = 0
                                while k <= 50:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.02)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D5/5),50),1)
                                sum2=0
                                while n <= 50:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.02)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('Joining',mm)
                                

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 98:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            LL6.append(DistanceToSigHead)
                            D6 = max (LL6)
                            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('len1',len(LL6))
                            if len(LL6) > 0:
                                k= max(min(round(D6/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D6/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('Joining',mm)
                                



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 88:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            LL7.append(DistanceToSigHead)
                            D7 = max (LL7)
                            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('len1',len(LL7))
                            if len(LL7) > 0:
                                k= max(min(round(D7/5),10),1)                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D7/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 103:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            LL8.append(DistanceToSigHead)
                            D8 = max (LL8)
                            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('len1',len(LL8))
                            if len(LL8) > 0:
                                k= max(min(round(D8/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D8/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('Joining',mm)





                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 112:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            LL9.append(DistanceToSigHead)
                            D9 = max (LL9)
                            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('len1',len(LL9))
                            if len(LL9) > 0:
                                k= max(min(round(D9/5),50),1)                                
                                sum1 = 0
                                while k <= 50:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.02)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D9/5),50),1)
                                sum2=0
                                while n <= 50:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.02)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('Joining',mm)


                                

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 101:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            LL10.append(DistanceToSigHead)
                            D10 = max (LL10)
                            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('len1',len(LL10))
                            if len(LL10) > 0:
                                k= max(min(round(D10/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D10/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('Joining',mm)
                                



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 85:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            LL11.append(DistanceToSigHead)
                            D11 = max (LL11)
                            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('len1',len(LL11))
                            if len(LL11) > 0:
                                k= max(min(round(D11/5),10),1)                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D11/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 95:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            LL12.append(DistanceToSigHead)
                            D12 = max (LL12)
                            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('len1',len(LL12))
                            if len(LL12) > 0:
                                k= max(min(round(D12/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D12/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('Joining',mm)





                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 113:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('ArrivalRate'))/3600))+1
                            LL13.append(DistanceToSigHead)
                            D13 = max (LL13)
                            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('len1',len(LL13))
                            if len(LL13) > 0:
                                k= max(min(round(D13/5),50),1)                                
                                sum1 = 0
                                while k <= 50:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.02)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D13/5),50),1)
                                sum2=0
                                while n <= 50:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.02)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('Joining',mm)


                                

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 106:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('ArrivalRate'))/3600))+1
                            LL14.append(DistanceToSigHead)
                            D14 = max (LL14)
                            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('len1',len(LL14))
                            if len(LL14) > 0:
                                k= max(min(round(D14/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D14/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('Joining',mm)
                                



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 84:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('ArrivalRate'))/3600))+1
                            LL15.append(DistanceToSigHead)
                            D15 = max (LL15)
                            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('len1',len(LL15))
                            if len(LL15) > 0:
                                k= max(min(round(D15/5),10),1)                                
                                sum1 = 0
                                while k <= 10:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.1)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D15/5),10),1)
                                sum2=0
                                while n <= 10:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.1)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('Joining',mm)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo') == 94:
                            mm = round(pow(e, Tt * (Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('ArrivalRate'))/3600))+1
                            LL16.append(DistanceToSigHead)
                            D16 = max (LL16)
                            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('len1',len(LL16))
                            if len(LL16) > 0:
                                k= max(min(round(D16/5),15),1)                                
                                sum1 = 0
                                while k <= 15:
                                    f1=pow((1 - proportion_of_CAVs),k)* (0.067)
                                    sum1 = sum1 + f1
                                    k=k+1

                                n=max(min(round(D16/5),15),1)
                                sum2=0
                                while n <= 15:
                                    sum2 = sum2 + (n*(pow((1 - proportion_of_CAVs),n)*(0.067)))/sum1
                                    n = n+1
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('Queuedup',round(sum2))
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
                                Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('Joining',mm)




                    else:
                        continue




                    if vehAttributes[vehsAttNames['VehType\No']] in vehTypesSpecial:
                        Link = vehAttributes[vehsAttNames['Lane\Link']]
                        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('LinkNo1',Link)
                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 99:
                            S6.append(1)
                            if len(S6)>0:
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 65:
                            S7.append(1)
                            if len(S7) >0:
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)
                     

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 75:
                            S8.append(1)
                            if len(S8) >0:
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)
                            

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 102:
                            S9.append(1)
                            if len(S9) >0:
                                Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 76:
                            S15.append(1)
                            if len(S15) >0:
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 86:
                            S16.append(1)
                            if len(S16) >0:
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 77:
                            S17.append(1)
                            if len(S17) >0:
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 67:
                            S18.append(1)
                            if len(S18) >0:
                                Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 78:
                            S19.append(1)
                            if len(S19) >0:
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 96:
                            S20.append(1)
                            if len(S20) >0:
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 69:
                            S21.append(1)
                            if len(S21) >0:
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 97:
                            S22.append(1)
                            if len(S22) >0:
                                Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 70:
                            S28.append(1)
                            if len(S28) >0:
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 87:
                            S29.append(1)
                            if len(S29) >0:
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 63:
                            S30.append(1)
                            if len(S30) >0:
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 82:
                            S31.append(1)
                            if len(S31) >0:
                                Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 81:
                            S32.append(1)
                            if len(S32) >0:
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 61:
                            S33.append(1)
                            if len(S33) >0:
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 80:
                            S34.append(1)
                            if len(S34) >0:
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 68:
                            S35.append(1)
                            if len(S35) >0:
                                Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 79:
                            S36.append(1)
                            if len(S36) >0:
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 59:
                            S37.append(1)
                            if len(S37) >0:
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 90:
                            S38.append(1)
                            if len(S38) >0:
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)



                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 66:
                            S39.append(1)
                            if len(S39) >0:
                                Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 60:
                            S40.append(1)
                            if len(S40) >0:
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)
 
                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 92:
                            S41.append(1)
                            if len(S41) >0:
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 71:
                            S42.append(1)
                            if len(S42) >0:
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 93:
                            S43.append(1)
                            if len(S43) >0:
                                Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 72:
                            S44.append(1)
                            if len(S44) >0:
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 62:
                            S45.append(1)
                            if len(S45) >0:
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 73:
                            S46.append(1)
                            if len(S46) >0:
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 83:
                            S47.append(1)
                            if len(S47) >0:
                                Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 74:
                            S48.append(1)
                            if len(S48) >0:
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 64:
                            S49.append(1)
                            if len(S49) >0:
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',greenExtension)

                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 104:
                            S50.append(1)
                            if len(S50) >0:
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',greenExtension)


                        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('LinkNo1') == 105:
                            S51.append(1)
                            if len(S51) >0:
                                Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',greenExtension)





        if len(LL1) == 0:
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',2)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('len1',0)
            

        if len(LL2) == 0:
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('len1',0)



        if len(LL3) == 0:
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('len1',0)


        if len(LL4) == 0:
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('len1',0)



        if len(LL5) == 0:
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',2)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('len1',0)

        if len(LL6) == 0:
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('len1',0)


        if len(LL7) == 0:
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('len1',0)



        if len(LL8) == 0:
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('len1',0)


        if len(LL9) == 0:
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',2)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('len1',0)


        if len(LL10) == 0:
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('len1',0)


        if len(LL11) == 0:
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('len1',0)


        if len(LL12) == 0:
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('len1',0)


        if len(LL13) == 0:
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',2)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('len1',0)


        if len(LL14) == 0:
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('len1',0)


        if len(LL15) == 0:
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('len1',0)



        if len(LL16) == 0:
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('Joining',0)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('len1',0)




        if len(L6)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L7)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('Joining',0)



        if len(L8)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('Joining',0)

        if len(L9)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('Joining',0)


        if len(L15)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('Joining',0)


        if len(L16)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('Joining',0)


        if len(L17)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('Joining',0)


        if len(L18)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('Joining',0)





        if len(L19)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L20)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('Joining',0)

        if len(L21)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('Joining',0)


        if len(L22)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('Joining',0)


        if len(L28)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('Joining',0)




        if len(L29)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('Joining',0)



        if len(L30)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('Joining',0)



        if len(L31)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('Joining',0)




        if len(L32)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('Joining',0)


        if len(L33)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('Joining',0)



        if len(L34)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('Joining',0)


        if len(L35)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('Joining',0)



        if len(L36)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('Joining',0)


        if len(L37)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('Joining',0)



        if len(L38)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L39)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('Joining',0)


        if len(L40)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('Joining',0)



        if len(L41)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L42)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('Joining',0)



        if len(L43)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('Joining',0)


        if len(L44)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L45)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('Joining',0)





        if len(L46)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('Joining',0)


        if len(L47)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('Joining',0)



        if len(L48)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('Joining',0)



        if len(L49)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('Joining',0)



        if len(L50)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('Joining',0)


        if len(L51)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('Queuedup',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('WithoutInformation',1)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('len1',0)
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('Joining',0)





        if len(S6)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)




        if len(S7)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)




        if len(S8)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)


        if len(S9)==0:
            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)



        if len(S15)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)



        if len(S16)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)



        if len(S17)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)



        if len(S18)==0:
            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)






        if len(S19)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)




        if len(S20)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)


        if len(S21)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)



        if len(S22)==0:
            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)



        if len(S28)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)





        if len(S29)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)




        if len(S30)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)




        if len(S31)==0:
            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)





        if len(S32)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)



        if len(S33)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)




        if len(S34)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)



        if len(S35)==0:
            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)




        if len(S36)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)



        if len(S37)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)




        if len(S38)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)




        if len(S39)==0:
            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)



        if len(S40)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)




        if len(S41)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)




        if len(S42)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)




        if len(S43)==0:
            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)



        if len(S44)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)




        if len(S45)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)






        if len(S46)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)



        if len(S47)==0:
            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)




        if len(S48)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('SpecialExtension',0)



        if len(S49)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)



        if len(S49)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('SpecialExtension',0)




        if len(S50)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('SpecialExtension',0)



        if len(S51)==0:
            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('SpecialExtension',0)




        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('SigState') == 'RED':           
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('Joining')))
            kss1= 14-(Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).AttValue('Queuedup'))
            kss2= 17- (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).AttValue('Queuedup'))
            kss3 = 17- (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).AttValue('Queuedup'))
            kss4= min(kss1,kss2,kss3)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('CurrentSupply',3 * kss4)

            
        else:
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('Joining')))





        if Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('SigState') == 'RED':           
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('Joining')))
            kss11= 14-(Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).AttValue('Queuedup'))
            kss22= 17- (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).AttValue('Queuedup'))
            kss33 = 17- (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).AttValue('Queuedup'))
            kss44= min(kss11,kss22,kss33)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('CurrentSupply',3 * kss44)

        else:
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('Joining')))






        if Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('SigState') == 'RED':           
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('Joining')))
            kss111= 14-(Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss222= 17- (Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss333 = 17- (Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss444= min(kss111,kss222,kss333)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('CurrentSupply',3 * kss444)

        else:
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('Joining')))




        if Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('SigState') == 'RED':           
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('Joining')))
            kss1111= 14-(Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss2222= 17- (Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss3333 = 17- (Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).AttValue('Queuedup'))
            kss4444= min(kss1111,kss2222,kss3333)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('CurrentSupply',3 * kss4444)

        else:
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('Joining')))
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('CurrentDemand',(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('Queuedup'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('WithoutInformation'))+(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('Joining')))

        Aseq=[[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4]]





        GreenTimes = []
        i= GreenMinI2
        while i <= GreenMaxI2:
            GreenTimes.append(i)
            i=i+5


        GreenTimes1 = []
        GreenDemand1 = []
        for i in range(len(GreenTimes)):
            if GreenTimes[i] <= (Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('CurrentSupply')/St2):
                GreenTimes1.append(GreenTimes[i])
                GreenDemand1.append(round(GreenTimes[i]*(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue('ArrivalRate'))))
        if len(GreenTimes1)==0:
            GreenTimes1.append(GreenMinI2)
            GreenDemand1.append(round(GreenMinI2*(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue('ArrivalRate'))))

        GreenTimes11 = []
        GreenDemand11 = []        
        for i in range(len(GreenTimes1)):
            GreenTimes11.append(CLength-GreenTimes1[i])
            GreenDemand11.append(round((CLength-GreenTimes1[i]-6)*(Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue('ArrivalRate')+ Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue('ArrivalRate')+Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue('ArrivalRate'))))
                
        GreenTimes5 = []
        GreenDemand5 = []  
        for i in range(len(GreenTimes)):
            if GreenTimes[i] <= (Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('CurrentSupply')/St):
                GreenTimes5.append(GreenTimes[i])
                GreenDemand5.append(round(GreenTimes[i]*(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue('ArrivalRate'))))

        if len(GreenTimes5)==0:
            GreenTimes5.append(GreenMinI2)
            GreenDemand5.append(round(GreenMinI2*(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue('ArrivalRate'))))

        GreenDemand51 = []  
        GreenTimes51 = []
        for i in range(len(GreenTimes5)):
            GreenTimes51.append(CLength-GreenTimes5[i])
            GreenDemand51.append(round((CLength-GreenTimes5[i]-6)*(Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue('ArrivalRate')+ Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue('ArrivalRate')+Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue('ArrivalRate'))))


        GreenTimes12 = []
        GreenDemand12 = [] 
        for i in range(len(GreenTimes)):
            if GreenTimes[i] <= (Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('CurrentSupply')/St):
                GreenTimes12.append(GreenTimes[i])
                GreenDemand12.append(round(GreenTimes[i]*(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue('ArrivalRate'))))

        if len(GreenTimes12)==0:
            GreenTimes12.append(GreenMinI2)
            GreenDemand12.append(round(GreenMinI2*(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue('ArrivalRate'))))


        GreenTimes121 = []
        GreenDemand121 = []
        for i in range(len(GreenTimes12)): 
            GreenTimes121.append(CLength-GreenTimes12[i])
            GreenDemand121.append(round((CLength-GreenTimes12[i]-6)*(Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue('ArrivalRate')+ Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue('ArrivalRate')+Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue('ArrivalRate'))))





        GreenTimes13 = []
        GreenDemand13 = [] 
        for i in range(len(GreenTimes)):
            if GreenTimes[i] <= (Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('CurrentSupply')/St):
                GreenTimes13.append(GreenTimes[i])
                GreenDemand13.append(round(GreenTimes[i]*(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue('ArrivalRate'))))

        if len(GreenTimes13)==0:
            GreenTimes13.append(GreenMinI2)
            GreenDemand13.append(round(GreenMinI2*(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue('ArrivalRate'))))



        GreenTimes131 = []
        GreenDemand131 = []
        for i in range(len(GreenTimes13)):
            GreenTimes131.append(CLength-GreenTimes13[i])
            GreenDemand131.append(round((CLength-GreenTimes13[i]-6)*(Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue('ArrivalRate')+ Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue('ArrivalRate')+Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue('ArrivalRate'))))






        incoming1=[]
        outgoing1=[]
        content1=[]
        for i in range(len(GreenTimes1)):
            in1 = Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('CurrentDemand')+ GreenDemand1[i]
            in2 = GreenTimes1[i] * St2
            in3 = min(in1,in2)
            incoming1.append(in3)
            out1 = Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('CurrentDemand')+ Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('CurrentDemand')+ Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('CurrentDemand')+ GreenDemand11[i]
            out2 = GreenTimes11[i] * St2
            out3 = min(out1,out2)
            outgoing1.append(out3)
            content1.append(in3-out3)



        incoming5=[]
        outgoing5=[]
        content5=[]
        for i in range(len(GreenTimes5)):
            in1 = Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('CurrentDemand')+ GreenDemand5[i]
            in2 = GreenTimes5[i] * St2
            in3 = min(in1,in2)
            incoming5.append(in3)
            out1 = Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('CurrentDemand')+ GreenDemand51[i]
            out2 = GreenTimes51[i] * St2
            out3 = min(out1,out2)
            outgoing5.append(out3)
            content5.append(in3-out3)


        incoming12=[]
        outgoing12=[]
        content12=[]
        for i in range(len(GreenTimes12)):
            in1 = Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('CurrentDemand')+ GreenDemand12[i]
            in2 = GreenTimes12[i] * St2
            in3 = min(in1,in2)
            incoming12.append(in3)
            out1 = Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('CurrentDemand')+ GreenDemand121[i]
            out2 = GreenTimes121[i] * St2
            out3 = min(out1,out2)
            outgoing12.append(out3)
            content12.append(in3-out3)



        incoming13=[]
        outgoing13=[]
        content13=[]
        for i in range(len(GreenTimes13)):
            in1 = Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('CurrentDemand')+ GreenDemand13[i]
            in2 = GreenTimes13[i] * St2
            in3 = min(in1,in2)
            incoming13.append(in3)
            out1 = Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('CurrentDemand')+Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('CurrentDemand')+ GreenDemand131[i]
            out2 = GreenTimes131[i] * St2
            out3 = min(out1,out2)
            outgoing13.append(out3)
            content13.append(in3-out3)

        kk=0
        for x in LinkAttributes:
            kk= kk + x[LinAttNames['Count:Vehs']]
        density = kk  - Vissim.Net.Links.ItemByKey(107).AttValue ('Count:Vehs') - Vissim.Net.Links.ItemByKey(108).AttValue ('Count:Vehs') - Vissim.Net.Links.ItemByKey(109).AttValue ('Count:Vehs')- Vissim.Net.Links.ItemByKey(110).AttValue ('Count:Vehs')- Vissim.Net.Links.ItemByKey(111).AttValue ('Count:Vehs')- Vissim.Net.Links.ItemByKey(112).AttValue ('Count:Vehs')- Vissim.Net.Links.ItemByKey(113).AttValue ('Count:Vehs')-- Vissim.Net.Links.ItemByKey(114).AttValue ('Count:Vehs')

        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue('SystemContent',density)

        scc=[]
        scc2=[]        
        indexes=[]
        mmmm = Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue('SystemContent')
        for i in range(len(content1)):
            for j in range(len(content5)):
                for k in range(len(content12)):
                    for m in range(len(content13)):
                        scc1 = abs(Kq - (mmmm + content1[i] + content5[j] + content12[k] + content13[m]))
                        scc2.append(scc1)
                        indexes.append([i,j,k,m])



        minimals=[]
        indexes2=[]
        for i in range(len(scc2)):
            if scc2[i]== min(scc2):
                minimals.append(scc2[i])
                indexes2.append(indexes[i])

        mor=[]
        for i in range(len(minimals)):
            mo1 = abs(GreenTimes1[indexes2[i][0]]*St-Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('CurrentDemand'))+ abs((CLength-GreenTimes1[indexes2[i][0]])*St-Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('CurrentDemand')) + abs((CLength-GreenTimes1[indexes2[i][0]])*St-Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).AttValue ('CurrentDemand'))+ abs((CLength-GreenTimes1[indexes2[i][0]])*St-Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).AttValue ('CurrentDemand')) + abs(GreenTimes5[indexes2[i][1]]*St-Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('CurrentDemand'))+ abs((CLength - GreenTimes5[indexes2[i][1]])*St-Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('CurrentDemand')) + abs((CLength - GreenTimes5[indexes2[i][1]])*St-Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).AttValue ('CurrentDemand'))+ abs((CLength - GreenTimes5[indexes2[i][1]])*St-Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).AttValue ('CurrentDemand')) +abs(GreenTimes12[indexes2[i][2]]*St-Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('CurrentDemand'))+ abs((CLength - GreenTimes12[indexes2[i][2]])*St-Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('CurrentDemand')) + abs((CLength - GreenTimes12[indexes2[i][2]])*St-Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).AttValue ('CurrentDemand'))+ abs((CLength - GreenTimes12[indexes2[i][2]])*St-Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).AttValue ('CurrentDemand'))+abs(GreenTimes13[indexes2[i][3]]*St-Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('CurrentDemand')) + abs((CLength - GreenTimes13[indexes2[i][3]])*St-Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('CurrentDemand')) + abs((CLength - GreenTimes13[indexes2[i][3]])*St-Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).AttValue ('CurrentDemand'))+ abs((CLength - GreenTimes13[indexes2[i][3]])*St-Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).AttValue ('CurrentDemand'))
            mor.append(mo1)




        finding=[]
        indexes3=[]
        for i in range(len(mor)): 
            if mor[i] == min(mor):
                finding.append(mor[i])
                MG1=GreenTimes1[indexes2[i][0]]
                MG2=GreenTimes5[indexes2[i][1]]
                MG3=GreenTimes12[indexes2[i][2]]
                MG4=GreenTimes13[indexes2[i][3]]
                indexes3.append([indexes2[i][0], indexes2[i][1], indexes2[i][2], indexes2[i][3]])






    
        if Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+2 > 72:
            koo=max(MG1,70) 
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('GreenTimeDuration',koo)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('GreenTimeDuration',CLength-koo-6)



            
        if Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+2 > 72:
            koo=max(MG2,70)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('GreenTimeDuration',koo)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            kk=0




        if Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+2 > 72:
            koo=max(MG3,70)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('GreenTimeDuration',koo)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('GreenTimeDuration',CLength-koo-6)






        if Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+2 > 72:
            koo=max(MG4,70)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('GreenTimeDuration',koo)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('GreenTimeDuration',CLength-koo-6)
            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('GreenTimeDuration',CLength-koo-6)        







        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('GreenStart',2)
        ko = Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenStart')
        ko2 = max(ko,72)
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('GreenEnd',ko)
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('GreenEnd',CLength-1)



        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('GreenStart',2)
        ko = Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenStart')
        ko2 = max(ko,72)
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('GreenEnd',ko)
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('GreenEnd',CLength-1)



        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('GreenStart',2)
        ko = Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenStart')
        ko2 = max(ko,72)
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('GreenEnd',ko)
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('GreenEnd',CLength-1)


        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('GreenStart',2)
        ko = Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenTimeDuration')+Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenStart')
        ko2 = max(ko,72)
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('GreenEnd',ko)
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('GreenEnd',CLength-1)
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenEnd')+3)    
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('GreenEnd',CLength-1)











        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][3]).SetAttValue ('GreenEnd', CLength-1)


        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][3]).SetAttValue ('GreenEnd', CLength-1)


        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][3]).SetAttValue ('GreenEnd', CLength-1)





        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][3]).SetAttValue ('GreenEnd', CLength-1)




        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][3]).SetAttValue ('GreenEnd', CLength-1)



        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][3]).SetAttValue ('GreenEnd', CLength-1)




        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][3]).SetAttValue ('GreenEnd', CLength-1)



        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][3]).SetAttValue ('GreenEnd', CLength-1)





        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).SetAttValue ('GreenStart',2)
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).SetAttValue ('GreenEnd',Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).SetAttValue ('GreenEnd', Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).AttValue ('GreenStart')+Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).AttValue ('GreenTimeDuration'))
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][3]).SetAttValue ('GreenStart',Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).AttValue ('GreenEnd')+3)
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][3]).SetAttValue ('GreenEnd', CLength-1)






    Aseq=[[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4],[1, 2, 3, 4]]
    Seconds = Vissim.Net.SignalControllers.ItemByKey(1).AttValue ('CycSec')
    CLength=80
    if Seconds >= 1 and Seconds < 5:

        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(Aseq[12][0]).SetAttValue ('SigState','GREEN')


        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(Aseq[11][0]).SetAttValue ('SigState','GREEN')



        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(1).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(2).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(3).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(4).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).SetAttValue ('SigState','GREEN')


        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(1).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(2).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(3).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(4).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).SetAttValue ('SigState','GREEN')


        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(1).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(2).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(3).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(4).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).SetAttValue ('SigState','GREEN')

        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(1).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(2).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(3).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(4).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).SetAttValue ('SigState','GREEN')

        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(1).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(2).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(3).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(4).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).SetAttValue ('SigState','GREEN')

        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(1).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(2).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(3).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(4).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).SetAttValue ('SigState','GREEN')


        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(Aseq[4][0]).SetAttValue ('SigState','GREEN')


        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(1).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(2).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(3).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(4).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).SetAttValue ('SigState','GREEN')

        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(1).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(2).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(3).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(4).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).SetAttValue ('SigState','GREEN')


        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(1).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(2).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(3).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(4).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).SetAttValue ('SigState','GREEN')


        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('ContrByCOM',True)
        Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(Aseq[0][0]).SetAttValue ('SigState','GREEN')








    if Seconds>1:
               
                if  Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).AttValue ('SigState') == 'GREEN':
                    Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][3]).SetAttValue ('SigState','RED')
                    if Seconds >= Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).AttValue ('GreenEnd')-1:
                        if Seconds < Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).AttValue ('GreenEnd')+2:
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][3]).SetAttValue ('SigState','RED')


                if Seconds >= Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).AttValue ('GreenStart')-1:
                    if Seconds <= Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).AttValue ('GreenEnd')-1:
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).SetAttValue ('SigState','GREEN')
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][3]).SetAttValue ('SigState','RED')


                if  Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).AttValue ('SigState') == 'GREEN':
                    Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][3]).SetAttValue ('SigState','RED')             
                    if Seconds >= Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).AttValue ('GreenEnd')-1:
                        if Seconds < Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).AttValue ('GreenEnd')+2:                 
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][3]).SetAttValue ('SigState','RED')


                if Seconds >= Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).AttValue ('GreenStart')-1:
                    if Seconds <= Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).AttValue ('GreenEnd')-1:
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).SetAttValue ('SigState','GREEN')
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][3]).SetAttValue ('SigState','RED')


                if  Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).AttValue ('SigState') == 'GREEN':
                    Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][3]).SetAttValue ('SigState','RED') 
                    if Seconds >= Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).AttValue ('GreenEnd')-1:
                        if Seconds < Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).AttValue ('GreenEnd')+2:             
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][3]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).SetAttValue ('SigState','RED')


                if Seconds >= Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][3]).AttValue ('GreenStart')-1:
                    if Seconds <= Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][3]).AttValue ('GreenEnd')-1:
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][3]).SetAttValue ('SigState','GREEN')
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).SetAttValue ('SigState','RED')


                if  Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][3]).AttValue ('SigState') == 'GREEN':
                    Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).SetAttValue ('SigState','RED')
                    if Seconds >= Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][3]).AttValue ('GreenEnd')-1:             
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][2]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(11).SGs.ItemByKey(Aseq[10][3]).SetAttValue ('SigState','RED')


                if  Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).AttValue ('SigState') == 'GREEN':
                    Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][3]).SetAttValue ('SigState','RED')
                    if Seconds >= Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).AttValue ('GreenEnd')-1:
                        if Seconds < Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).AttValue ('GreenEnd')+2:
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][3]).SetAttValue ('SigState','RED')


                if Seconds >= Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).AttValue ('GreenStart')-1:
                    if Seconds <= Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).AttValue ('GreenEnd')-1:
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).SetAttValue ('SigState','GREEN')
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][3]).SetAttValue ('SigState','RED')


                if  Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).AttValue ('SigState') == 'GREEN':
                    Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][3]).SetAttValue ('SigState','RED')             
                    if Seconds >= Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).AttValue ('GreenEnd')-1:
                        if Seconds < Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).AttValue ('GreenEnd')+2:                 
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][3]).SetAttValue ('SigState','RED')


                if Seconds >= Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).AttValue ('GreenStart')-1:
                    if Seconds <= Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).AttValue ('GreenEnd')-1:
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).SetAttValue ('SigState','GREEN')
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][3]).SetAttValue ('SigState','RED')


                if  Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).AttValue ('SigState') == 'GREEN':
                    Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][3]).SetAttValue ('SigState','RED') 
                    if Seconds >= Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).AttValue ('GreenEnd')-1:
                        if Seconds < Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).AttValue ('GreenEnd')+2:             
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][3]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).SetAttValue ('SigState','RED')


                if Seconds >= Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][3]).AttValue ('GreenStart')-1:
                    if Seconds <= Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][3]).AttValue ('GreenEnd')-1:
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][3]).SetAttValue ('SigState','GREEN')
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).SetAttValue ('SigState','RED')


                if  Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][3]).AttValue ('SigState') == 'GREEN':
                    Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).SetAttValue ('SigState','RED')
                    if Seconds >= Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][3]).AttValue ('GreenEnd')-1:             
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][2]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(10).SGs.ItemByKey(Aseq[9][3]).SetAttValue ('SigState','RED')






                if  Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).AttValue ('SigState') == 'GREEN':
                    Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][3]).SetAttValue ('SigState','RED')
                    if Seconds >= Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).AttValue ('GreenEnd')-1:
                        if Seconds < Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).AttValue ('GreenEnd')+2:
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][3]).SetAttValue ('SigState','RED')


                if Seconds >= Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).AttValue ('GreenStart')-1:
                    if Seconds <= Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).AttValue ('GreenEnd')-1:
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).SetAttValue ('SigState','GREEN')
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][3]).SetAttValue ('SigState','RED')


                if  Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).AttValue ('SigState') == 'GREEN':
                    Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][3]).SetAttValue ('SigState','RED')             
                    if Seconds >= Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).AttValue ('GreenEnd')-1:
                        if Seconds < Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).AttValue ('GreenEnd')+2:                 
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][3]).SetAttValue ('SigState','RED')


                if Seconds >= Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).AttValue ('GreenStart')-1:
                    if Seconds <= Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).AttValue ('GreenEnd')-1:
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).SetAttValue ('SigState','GREEN')
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][3]).SetAttValue ('SigState','RED')


                if  Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).AttValue ('SigState') == 'GREEN':
                    Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][3]).SetAttValue ('SigState','RED') 
                    if Seconds >= Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).AttValue ('GreenEnd')-1:
                        if Seconds < Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).AttValue ('GreenEnd')+2:             
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][3]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).SetAttValue ('SigState','RED')


                if Seconds >= Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][3]).AttValue ('GreenStart')-1:
                    if Seconds <= Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][3]).AttValue ('GreenEnd')-1:
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][3]).SetAttValue ('SigState','GREEN')
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).SetAttValue ('SigState','RED')


                if  Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][3]).AttValue ('SigState') == 'GREEN':
                    Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).SetAttValue ('SigState','RED')
                    if Seconds >= Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][3]).AttValue ('GreenEnd')-1:             
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][2]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(9).SGs.ItemByKey(Aseq[8][3]).SetAttValue ('SigState','RED')







                if  Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).AttValue ('SigState') == 'GREEN':
                    Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][3]).SetAttValue ('SigState','RED')
                    if Seconds >= Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).AttValue ('GreenEnd')-1:
                        if Seconds < Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).AttValue ('GreenEnd')+2:
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][3]).SetAttValue ('SigState','RED')


                if Seconds >= Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).AttValue ('GreenStart')-1:
                    if Seconds <= Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).AttValue ('GreenEnd')-1:
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).SetAttValue ('SigState','GREEN')
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][3]).SetAttValue ('SigState','RED')


                if  Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).AttValue ('SigState') == 'GREEN':
                    Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][3]).SetAttValue ('SigState','RED')             
                    if Seconds >= Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).AttValue ('GreenEnd')-1:
                        if Seconds < Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).AttValue ('GreenEnd')+2:                 
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][3]).SetAttValue ('SigState','RED')


                if Seconds >= Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).AttValue ('GreenStart')-1:
                    if Seconds <= Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).AttValue ('GreenEnd')-1:
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).SetAttValue ('SigState','GREEN')
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][3]).SetAttValue ('SigState','RED')


                if  Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).AttValue ('SigState') == 'GREEN':
                    Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][3]).SetAttValue ('SigState','RED') 
                    if Seconds >= Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).AttValue ('GreenEnd')-1:
                        if Seconds < Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).AttValue ('GreenEnd')+2:             
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][3]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).SetAttValue ('SigState','RED')


                if Seconds >= Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][3]).AttValue ('GreenStart')-1:
                    if Seconds <= Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][3]).AttValue ('GreenEnd')-1:
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][3]).SetAttValue ('SigState','GREEN')
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).SetAttValue ('SigState','RED')


                if  Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][3]).AttValue ('SigState') == 'GREEN':
                    Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).SetAttValue ('SigState','RED')
                    if Seconds >= Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][3]).AttValue ('GreenEnd')-1:             
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][2]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(8).SGs.ItemByKey(Aseq[7][3]).SetAttValue ('SigState','RED')



                if  Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).AttValue ('SigState') == 'GREEN':
                    Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][3]).SetAttValue ('SigState','RED')
                    if Seconds >= Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).AttValue ('GreenEnd')-1:
                        if Seconds < Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).AttValue ('GreenEnd')+2:
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][3]).SetAttValue ('SigState','RED')


                if Seconds >= Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).AttValue ('GreenStart')-1:
                    if Seconds <= Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).AttValue ('GreenEnd')-1:
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).SetAttValue ('SigState','GREEN')
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][3]).SetAttValue ('SigState','RED')


                if  Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).AttValue ('SigState') == 'GREEN':
                    Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][3]).SetAttValue ('SigState','RED')             
                    if Seconds >= Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).AttValue ('GreenEnd')-1:
                        if Seconds < Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).AttValue ('GreenEnd')+2:                 
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][3]).SetAttValue ('SigState','RED')


                if Seconds >= Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).AttValue ('GreenStart')-1:
                    if Seconds <= Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).AttValue ('GreenEnd')-1:
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).SetAttValue ('SigState','GREEN')
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][3]).SetAttValue ('SigState','RED')


                if  Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).AttValue ('SigState') == 'GREEN':
                    Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][3]).SetAttValue ('SigState','RED') 
                    if Seconds >= Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).AttValue ('GreenEnd')-1:
                        if Seconds < Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).AttValue ('GreenEnd')+2:             
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][3]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).SetAttValue ('SigState','RED')


                if Seconds >= Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][3]).AttValue ('GreenStart')-1:
                    if Seconds <= Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][3]).AttValue ('GreenEnd')-1:
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][3]).SetAttValue ('SigState','GREEN')
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).SetAttValue ('SigState','RED')


                if  Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][3]).AttValue ('SigState') == 'GREEN':
                    Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).SetAttValue ('SigState','RED')
                    if Seconds >= Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][3]).AttValue ('GreenEnd')-1:             
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][2]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(7).SGs.ItemByKey(Aseq[6][3]).SetAttValue ('SigState','RED')


                if  Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).AttValue ('SigState') == 'GREEN':
                    Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][3]).SetAttValue ('SigState','RED')
                    if Seconds >= Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).AttValue ('GreenEnd')-1:
                        if Seconds < Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).AttValue ('GreenEnd')+2:
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][3]).SetAttValue ('SigState','RED')


                if Seconds >= Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).AttValue ('GreenStart')-1:
                    if Seconds <= Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).AttValue ('GreenEnd')-1:
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).SetAttValue ('SigState','GREEN')
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][3]).SetAttValue ('SigState','RED')


                if  Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).AttValue ('SigState') == 'GREEN':
                    Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][3]).SetAttValue ('SigState','RED')             
                    if Seconds >= Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).AttValue ('GreenEnd')-1:
                        if Seconds < Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).AttValue ('GreenEnd')+2:                 
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][3]).SetAttValue ('SigState','RED')


                if Seconds >= Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).AttValue ('GreenStart')-1:
                    if Seconds <= Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).AttValue ('GreenEnd')-1:
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).SetAttValue ('SigState','GREEN')
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][3]).SetAttValue ('SigState','RED')


                if  Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).AttValue ('SigState') == 'GREEN':
                    Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][3]).SetAttValue ('SigState','RED') 
                    if Seconds >= Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).AttValue ('GreenEnd')-1:
                        if Seconds < Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).AttValue ('GreenEnd')+2:             
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][3]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).SetAttValue ('SigState','RED')


                if Seconds >= Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][3]).AttValue ('GreenStart')-1:
                    if Seconds <= Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][3]).AttValue ('GreenEnd')-1:
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][3]).SetAttValue ('SigState','GREEN')
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).SetAttValue ('SigState','RED')


                if  Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][3]).AttValue ('SigState') == 'GREEN':
                    Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).SetAttValue ('SigState','RED')
                    if Seconds >= Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][3]).AttValue ('GreenEnd')-1:             
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][2]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(6).SGs.ItemByKey(Aseq[5][3]).SetAttValue ('SigState','RED')






                if  Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).AttValue ('SigState') == 'GREEN':
                    Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][3]).SetAttValue ('SigState','RED')
                    if Seconds >= Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).AttValue ('GreenEnd')-1:
                        if Seconds < Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).AttValue ('GreenEnd')+2:
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][3]).SetAttValue ('SigState','RED')


                if Seconds >= Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).AttValue ('GreenStart')-1:
                    if Seconds <= Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).AttValue ('GreenEnd')-1:
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).SetAttValue ('SigState','GREEN')
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][3]).SetAttValue ('SigState','RED')


                if  Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).AttValue ('SigState') == 'GREEN':
                    Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][3]).SetAttValue ('SigState','RED')             
                    if Seconds >= Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).AttValue ('GreenEnd')-1:
                        if Seconds < Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).AttValue ('GreenEnd')+2:                 
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][3]).SetAttValue ('SigState','RED')


                if Seconds >= Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).AttValue ('GreenStart')-1:
                    if Seconds <= Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).AttValue ('GreenEnd')-1:
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).SetAttValue ('SigState','GREEN')
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][3]).SetAttValue ('SigState','RED')


                if  Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).AttValue ('SigState') == 'GREEN':
                    Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][3]).SetAttValue ('SigState','RED') 
                    if Seconds >= Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).AttValue ('GreenEnd')-1:
                        if Seconds < Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).AttValue ('GreenEnd')+2:             
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][3]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).SetAttValue ('SigState','RED')


                if Seconds >= Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][3]).AttValue ('GreenStart')-1:
                    if Seconds <= Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][3]).AttValue ('GreenEnd')-1:
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][3]).SetAttValue ('SigState','GREEN')
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).SetAttValue ('SigState','RED')


                if  Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][3]).AttValue ('SigState') == 'GREEN':
                    Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).SetAttValue ('SigState','RED')
                    if Seconds >= Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][3]).AttValue ('GreenEnd')-1:             
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][2]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(4).SGs.ItemByKey(Aseq[3][3]).SetAttValue ('SigState','RED')



                if  Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).AttValue ('SigState') == 'GREEN':
                    Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][3]).SetAttValue ('SigState','RED')
                    if Seconds >= Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).AttValue ('GreenEnd')-1:
                        if Seconds < Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).AttValue ('GreenEnd')+2:
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][3]).SetAttValue ('SigState','RED')


                if Seconds >= Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).AttValue ('GreenStart')-1:
                    if Seconds <= Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).AttValue ('GreenEnd')-1:
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).SetAttValue ('SigState','GREEN')
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][3]).SetAttValue ('SigState','RED')


                if  Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).AttValue ('SigState') == 'GREEN':
                    Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][3]).SetAttValue ('SigState','RED')             
                    if Seconds >= Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).AttValue ('GreenEnd')-1:
                        if Seconds < Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).AttValue ('GreenEnd')+2:                 
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][3]).SetAttValue ('SigState','RED')


                if Seconds >= Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).AttValue ('GreenStart')-1:
                    if Seconds <= Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).AttValue ('GreenEnd')-1:
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).SetAttValue ('SigState','GREEN')
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][3]).SetAttValue ('SigState','RED')


                if  Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).AttValue ('SigState') == 'GREEN':
                    Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][3]).SetAttValue ('SigState','RED') 
                    if Seconds >= Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).AttValue ('GreenEnd')-1:
                        if Seconds < Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).AttValue ('GreenEnd')+2:             
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][3]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).SetAttValue ('SigState','RED')


                if Seconds >= Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][3]).AttValue ('GreenStart')-1:
                    if Seconds <= Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][3]).AttValue ('GreenEnd')-1:
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][3]).SetAttValue ('SigState','GREEN')
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).SetAttValue ('SigState','RED')


                if  Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][3]).AttValue ('SigState') == 'GREEN':
                    Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).SetAttValue ('SigState','RED')
                    if Seconds >= Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][3]).AttValue ('GreenEnd')-1:             
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][2]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(3).SGs.ItemByKey(Aseq[2][3]).SetAttValue ('SigState','RED')

                if  Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).AttValue ('SigState') == 'GREEN':
                    Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][3]).SetAttValue ('SigState','RED')
                    if Seconds >= Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).AttValue ('GreenEnd')-1:
                        if Seconds < Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).AttValue ('GreenEnd')+2:
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][3]).SetAttValue ('SigState','RED')


                if Seconds >= Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).AttValue ('GreenStart')-1:
                    if Seconds <= Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).AttValue ('GreenEnd')-1:
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).SetAttValue ('SigState','GREEN')
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][3]).SetAttValue ('SigState','RED')


                if  Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).AttValue ('SigState') == 'GREEN':
                    Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][3]).SetAttValue ('SigState','RED')             
                    if Seconds >= Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).AttValue ('GreenEnd')-1:
                        if Seconds < Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).AttValue ('GreenEnd')+2:                 
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][3]).SetAttValue ('SigState','RED')


                if Seconds >= Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).AttValue ('GreenStart')-1:
                    if Seconds <= Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).AttValue ('GreenEnd')-1:
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).SetAttValue ('SigState','GREEN')
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][3]).SetAttValue ('SigState','RED')


                if  Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).AttValue ('SigState') == 'GREEN':
                    Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][3]).SetAttValue ('SigState','RED') 
                    if Seconds >= Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).AttValue ('GreenEnd')-1:
                        if Seconds < Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).AttValue ('GreenEnd')+2:             
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][3]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).SetAttValue ('SigState','RED')


                if Seconds >= Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][3]).AttValue ('GreenStart')-1:
                    if Seconds <= Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][3]).AttValue ('GreenEnd')-1:
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][3]).SetAttValue ('SigState','GREEN')
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).SetAttValue ('SigState','RED')


                if  Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][3]).AttValue ('SigState') == 'GREEN':
                    Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).SetAttValue ('SigState','RED')
                    if Seconds >= Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][3]).AttValue ('GreenEnd')-1:             
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][0]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][1]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][2]).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(2).SGs.ItemByKey(Aseq[1][3]).SetAttValue ('SigState','RED')









                if  Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('SigState') == 'GREEN':
                    Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('SigState','RED')
                    if Seconds >= Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenEnd')-1:
                        if Seconds <= Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).AttValue ('GreenEnd')+2:
                            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('SigState','RED')


                if Seconds >= Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('GreenStart')-1:
                    if Seconds <= Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('GreenEnd')-1:
                            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('SigState','GREEN')
                            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('SigState','GREEN')
                            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('SigState','GREEN')



                if  Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('SigState') == 'GREEN':
                    Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('SigState','RED')
                    if Seconds >= Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).AttValue ('GreenEnd')-1:
                            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(1).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(2).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(3).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(1).SGs.ItemByKey(4).SetAttValue ('SigState','RED')




                if  Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('SigState') == 'GREEN':
                    Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('SigState','RED')
                    if Seconds >= Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenEnd')-1:
                        if Seconds <= Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).AttValue ('GreenEnd')+2:
                            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('SigState','RED')





                if Seconds >= Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('GreenStart')-1:
                    if Seconds <= Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('GreenEnd')-1:
                            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('SigState','GREEN')
                            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('SigState','GREEN')
                            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('SigState','GREEN')



                if  Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('SigState') == 'GREEN':
                    Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('SigState','RED')
                    if Seconds >= Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).AttValue ('GreenEnd')-1:
                            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(1).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(2).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(3).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(5).SGs.ItemByKey(4).SetAttValue ('SigState','RED')






                if  Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('SigState') == 'GREEN':
                    Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('SigState','RED')
                    if Seconds >= Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenEnd')-1:
                        if Seconds <= Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).AttValue ('GreenEnd')+2:
                            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('SigState','RED')



                if Seconds >= Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('GreenStart')-1:
                    if Seconds <= Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('GreenEnd')-1:
                            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('SigState','GREEN')
                            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('SigState','GREEN')
                            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('SigState','GREEN')



                if  Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('SigState') == 'GREEN':
                    Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('SigState','RED')
                    if Seconds >= Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).AttValue ('GreenEnd')-1:
                            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(1).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(2).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(3).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(12).SGs.ItemByKey(4).SetAttValue ('SigState','RED')





                if  Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('SigState') == 'GREEN':
                    Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('SigState','RED')
                    Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('SigState','RED')
                    if Seconds >= Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenEnd')-1:
                        if Seconds <= Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).AttValue ('GreenEnd')+2:
                            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('SigState','RED')




                if Seconds >= Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('GreenStart')-1:
                    if Seconds <= Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('GreenEnd')-1:
                            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('SigState','GREEN')
                            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('SigState','GREEN')
                            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('SigState','GREEN')



                if  Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('SigState') == 'GREEN':
                    Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('SigState','RED')
                    if Seconds >= Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).AttValue ('GreenEnd')-1:
                            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(1).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(2).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(3).SetAttValue ('SigState','RED')
                            Vissim.Net.SignalControllers.ItemByKey(13).SGs.ItemByKey(4).SetAttValue ('SigState','RED')

